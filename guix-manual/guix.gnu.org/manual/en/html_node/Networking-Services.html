<!DOCTYPE html PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN" "http://www.w3.org/TR/html4/loose.dtd">
<html>
<!--   Copyright (C) 2012-2022 Ludovic Courtès

Copyright (C) 2013, 2014, 2016 Andreas Enge

Copyright (C) 2013 Nikita Karetnikov

Copyright (C) 2014, 2015, 2016 Alex Kost

Copyright (C) 2015, 2016 Mathieu Lirzin

Copyright (C) 2014 Pierre-Antoine Rault

Copyright (C) 2015 Taylan Ulrich Bayırlı/Kammer

Copyright (C) 2015, 2016, 2017, 2019, 2020, 2021 Leo Famulari

Copyright (C) 2015, 2016, 2017, 2018, 2019, 2020, 2021, 2022 Ricardo Wurmus

Copyright (C) 2016 Ben Woodcroft

Copyright (C) 2016, 2017, 2018, 2021 Chris Marusich

Copyright (C) 2016, 2017, 2018, 2019, 2020, 2021, 2022 Efraim Flashner

Copyright (C) 2016 John Darrington

Copyright (C) 2016, 2017 Nikita Gillmann

Copyright (C) 2016, 2017, 2018, 2019, 2020 Jan Nieuwenhuizen

Copyright (C) 2016, 2017, 2018, 2019, 2020, 2021 Julien Lepiller

Copyright (C) 2016 Alex ter Weele

Copyright (C) 2016, 2017, 2018, 2019, 2020, 2021 Christopher Baines

Copyright (C) 2017, 2018, 2019 Clément Lassieur

Copyright (C) 2017, 2018, 2020, 2021, 2022 Mathieu Othacehe

Copyright (C) 2017 Federico Beffa

Copyright (C) 2017, 2018 Carlo Zancanaro

Copyright (C) 2017 Thomas Danckaert

Copyright (C) 2017 humanitiesNerd

Copyright (C) 2017, 2021 Christine Lemmer-Webber

Copyright (C) 2017, 2018, 2019, 2020, 2021, 2022 Marius Bakke

Copyright (C) 2017, 2019, 2020, 2022 Hartmut Goebel

Copyright (C) 2017, 2019, 2020, 2021, 2022 Maxim Cournoyer

Copyright (C) 2017–2022 Tobias Geerinckx-Rice

Copyright (C) 2017 George Clemmer

Copyright (C) 2017 Andy Wingo

Copyright (C) 2017, 2018, 2019, 2020 Arun Isaac

Copyright (C) 2017 nee

Copyright (C) 2018 Rutger Helling

Copyright (C) 2018, 2021 Oleg Pykhalov

Copyright (C) 2018 Mike Gerwitz

Copyright (C) 2018 Pierre-Antoine Rouby

Copyright (C) 2018, 2019 Gábor Boskovits

Copyright (C) 2018, 2019, 2020, 2022 Florian Pelz

Copyright (C) 2018 Laura Lazzati

Copyright (C) 2018 Alex Vong

Copyright (C) 2019 Josh Holland

Copyright (C) 2019, 2020 Diego Nicola Barbato

Copyright (C) 2019 Ivan Petkov

Copyright (C) 2019 Jakob L. Kreuze

Copyright (C) 2019 Kyle Andrews

Copyright (C) 2019 Alex Griffin

Copyright (C) 2019, 2020, 2021, 2022 Guillaume Le Vaillant

Copyright (C) 2020 Liliana Marie Prikler

Copyright (C) 2019, 2020, 2021, 2022 Simon Tournier

Copyright (C) 2020 Wiktor Żelazny

Copyright (C) 2020 Damien Cassou

Copyright (C) 2020 Jakub Kądziołka

Copyright (C) 2020 Jack Hill

Copyright (C) 2020 Naga Malleswari

Copyright (C) 2020, 2021 Brice Waegeneire

Copyright (C) 2020 R Veera Kumar

Copyright (C) 2020, 2021 Pierre Langlois

Copyright (C) 2020 pinoaffe

Copyright (C) 2020 André Batista

Copyright (C) 2020, 2021 Alexandru-Sergiu Marton

Copyright (C) 2020 raingloom

Copyright (C) 2020 Daniel Brooks

Copyright (C) 2020 John Soo

Copyright (C) 2020 Jonathan Brielmaier

Copyright (C) 2020 Edgar Vincent

Copyright (C) 2021, 2022 Maxime Devos

Copyright (C) 2021 B. Wilson

Copyright (C) 2021 Xinglu Chen

Copyright (C) 2021 Raghav Gururajan

Copyright (C) 2021 Domagoj Stolfa

Copyright (C) 2021 Hui Lu

Copyright (C) 2021 pukkamustard

Copyright (C) 2021 Alice Brenon

Copyright (C) 2021, 2022 Josselin Poiret

Copyright (C) 2021 muradm

Copyright (C) 2021, 2022 Andrew Tropin

Copyright (C) 2021 Sarah Morgensen

Copyright (C) 2022 Remco van 't Veer

Copyright (C) 2022 Aleksandr Vityazev

Copyright (C) 2022 Philip McGrath

Copyright (C) 2022 Karl Hallsby

Copyright (C) 2022 Justin Veilleux

Copyright (C) 2022 Reily Siegel

Copyright (C) 2022 Simon Streit

Copyright (C) 2022 (

Copyright (C) 2022 John Kehayias


Permission is granted to copy, distribute and/or modify this document
under the terms of the GNU Free Documentation License, Version 1.3 or
any later version published by the Free Software Foundation; with no
Invariant Sections, no Front-Cover Texts, and no Back-Cover Texts.  A
copy of the license is included in the section entitled "GNU Free
Documentation License".   -->
<!--   Created by GNU Texinfo 6.7, http://www.gnu.org/software/texinfo/   -->
<head>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<title>Networking Services (GNU Guix Reference Manual)</title>

<meta name="description" content="Networking Services (GNU Guix Reference Manual)" />
<meta name="keywords" content="Networking Services (GNU Guix Reference Manual)" />
<meta name="resource-type" content="document" />
<meta name="distribution" content="global" />
<meta name="Generator" content="makeinfo" />
<link href="index.html" rel="start" title="Top" />
<link href="Concept-Index.html" rel="index" title="Concept Index" />
<link href="index.html#SEC_Contents" rel="contents" title="Table of Contents" />
<link href="Services.html" rel="up" title="Services" />
<link href="Unattended-Upgrades.html" rel="next" title="Unattended Upgrades" />
<link href="Networking-Setup.html" rel="prev" title="Networking Setup" />
<style type="text/css">
&amp;lt;!--
a.summary-letter {text-decoration: none}
blockquote.indentedblock {margin-right: 0em}
div.display {margin-left: 3.2em}
div.example {margin-left: 3.2em}
div.lisp {margin-left: 3.2em}
kbd {font-style: oblique}
pre.display {font-family: inherit}
pre.format {font-family: inherit}
pre.menu-comment {font-family: serif}
pre.menu-preformatted {font-family: serif}
span.nolinebreak {white-space: nowrap}
span.roman {font-family: initial; font-weight: normal}
span.sansserif {font-family: sans-serif; font-weight: normal}
ul.no-bullet {list-style: none}
--&amp;gt;
</style>
<link rel="stylesheet" type="text/css" href="https://www.gnu.org/software/gnulib/manual.css" />

<meta name="viewport" content="width=device-width, initial-scale=1" />
<link rel="stylesheet" type="text/css" href="../../../static/base/css/manual.css" /><link rel="stylesheet" type="text/css" href="../../../static/base/css/code.css" /></head>

<body lang="en"><header class="navbar"><h1><a class="branding" href="https://guix.gnu.org/manual/en/"></a></h1><nav class="navbar-menu"><input class="navbar-menu-hidden-input" type="radio" name="dropdown" id="all-dropdowns-hidden" /><ul><li class="navbar-menu-item dropdown dropdown-btn"><input class="navbar-menu-hidden-input" type="radio" name="dropdown" id="visible-dropdown" /><label for="visible-dropdown"><img alt="Language" src="../../../static/base/img/language-picker.svg" /></label><label for="all-dropdowns-hidden"><img alt="Language" src="../../../static/base/img/language-picker.svg" /></label><div class="navbar-submenu" id="navbar-submenu"><div class="navbar-submenu-triangle"> </div><ul><li><a class="navbar-menu-item" href="https://guix.gnu.org/manual/de/html_node">Deutsch</a></li><li><a class="navbar-menu-item" href="https://guix.gnu.org/manual/en/html_node">English</a></li><li><a class="navbar-menu-item" href="https://guix.gnu.org/manual/es/html_node">Español</a></li><li><a class="navbar-menu-item" href="https://guix.gnu.org/manual/fr/html_node">français</a></li><li><a class="navbar-menu-item" href="https://guix.gnu.org/manual/pt-br/html_node">Português</a></li><li><a class="navbar-menu-item" href="https://guix.gnu.org/manual/ru/html_node">русский</a></li><li><a class="navbar-menu-item" href="https://guix.gnu.org/manual/zh-cn/html_node">中文</a></li><li><a class="navbar-menu-item" href="https://translate.fedoraproject.org/projects/guix/documentation-manual/">⊕</a></li></ul></div></li></ul></nav><a class="navbar-menu-btn" href="https://guix.gnu.org/manual/"></a></header>
<span id="Networking-Services"></span><div class="header">
<p>
Next: <a href="Unattended-Upgrades.html" accesskey="n" rel="next">Unattended Upgrades</a>, Previous: <a href="Networking-Setup.html" accesskey="p" rel="prev">Networking Setup</a>, Up: <a href="Services.html" accesskey="u" rel="up">Services</a> &nbsp; [<a href="index.html#SEC_Contents" title="Table of contents" rel="contents">Contents</a>][<a href="Concept-Index.html" title="Index" rel="index">Index</a>]</p>
</div>
<hr />
<span id="Networking-Services-1"></span><h4 class="subsection">12.9.5 Networking Services</h4>

<p>The <code>(gnu services networking)</code> module discussed in the previous
section provides services for more advanced setups: providing a DHCP
service for others to use, filtering packets with iptables or nftables,
running a WiFi access point with <code>hostapd</code>, running the
<code>inetd</code> &ldquo;superdaemon&rdquo;, and more.  This section describes
those.
</p>
<dl>
<dt id="index-dhcpd_002dservice_002dtype" class="symbol-definition"><span class="symbol-definition-category">Scheme Procedure: </span><span class="symbol-definition-prototype">dhcpd-service-type </span></dt>
<dd><p>This type defines a service that runs a DHCP daemon.  To create a
service of this type, you must supply a <code>&lt;dhcpd-configuration&gt;</code>.
For example:
</p>
<div class="lisp">
<pre class="lisp"><span class="syntax-paren0">(<span class="syntax-symbol"><a class="syntax-symbol" href="Service-Reference.html#index-service">service</a> <a class="syntax-symbol" href="Networking-Services.html#index-dhcpd_002dservice_002dtype">dhcpd-service-type</a>
         <span class="syntax-paren1">(<span class="syntax-symbol"><a class="syntax-symbol" href="Networking-Services.html#index-dhcpd_002dconfiguration">dhcpd-configuration</a>
          <span class="syntax-paren2">(<span class="syntax-symbol"><span class="syntax-symbol">config-file</span> <span class="syntax-paren3">(<span class="syntax-symbol"><a class="syntax-symbol" href="G_002dExpressions.html#index-local_002dfile">local-file</a> <span class="syntax-string">"my-dhcpd.conf"</span></span>)</span></span>)</span>
          <span class="syntax-paren2">(<span class="syntax-symbol"><span class="syntax-symbol">interfaces</span> <span class="syntax-symbol">'</span><span class="syntax-paren3">(<span class="syntax-symbol"><span class="syntax-string">"enp0s25"</span></span>)</span></span>)</span></span>)</span></span>)</span>
</pre></div>
</dd></dl>

<dl>
<dt id="index-dhcpd_002dconfiguration" class="symbol-definition"><span class="symbol-definition-category">Data Type: </span><span class="symbol-definition-prototype">dhcpd-configuration </span></dt>
<dd><dl compact="compact">
<dt><code>package</code> (default: <code>isc-dhcp</code>)</dt>
<dd><p>The package that provides the DHCP daemon.  This package is expected to
provide the daemon at <samp>sbin/dhcpd</samp> relative to its output
directory.  The default package is the
<a href="https://www.isc.org/dhcp/">ISC&rsquo;s DHCP server</a>.
</p></dd>
<dt><code>config-file</code> (default: <code>#f</code>)</dt>
<dd><p>The configuration file to use.  This is required.  It will be passed to
<code>dhcpd</code> via its <code>-cf</code> option.  This may be any &ldquo;file-like&rdquo;
object (see <a href="G_002dExpressions.html">file-like objects</a>).  See <code>man
dhcpd.conf</code> for details on the configuration file syntax.
</p></dd>
<dt><code>version</code> (default: <code>"4"</code>)</dt>
<dd><p>The DHCP version to use.  The ISC DHCP server supports the values &ldquo;4&rdquo;,
&ldquo;6&rdquo;, and &ldquo;4o6&rdquo;.  These correspond to the <code>dhcpd</code> program
options <code>-4</code>, <code>-6</code>, and <code>-4o6</code>.  See <code>man dhcpd</code> for
details.
</p></dd>
<dt><code>run-directory</code> (default: <code>"/run/dhcpd"</code>)</dt>
<dd><p>The run directory to use.  At service activation time, this directory
will be created if it does not exist.
</p></dd>
<dt><code>pid-file</code> (default: <code>"/run/dhcpd/dhcpd.pid"</code>)</dt>
<dd><p>The PID file to use.  This corresponds to the <code>-pf</code> option of
<code>dhcpd</code>.  See <code>man dhcpd</code> for details.
</p></dd>
<dt><code>interfaces</code> (default: <code>'()</code>)</dt>
<dd><p>The names of the network interfaces on which dhcpd should listen for
broadcasts.  If this list is not empty, then its elements (which must be
strings) will be appended to the <code>dhcpd</code> invocation when starting
the daemon.  It may not be necessary to explicitly specify any
interfaces here; see <code>man dhcpd</code> for details.
</p></dd>
</dl>
</dd></dl>

<span id="index-hostapd-service_002c-for-Wi_002dFi-access-points"></span>
<span id="index-Wi_002dFi-access-points_002c-hostapd-service"></span>
<dl>
<dt id="index-hostapd_002dservice_002dtype" class="symbol-definition"><span class="symbol-definition-category">Scheme Variable: </span><span class="symbol-definition-prototype">hostapd-service-type </span></dt>
<dd><p>This is the service type to run the <a href="https://w1.fi/hostapd/">hostapd</a> daemon to set up WiFi (IEEE 802.11) access points and
authentication servers.  Its associated value must be a
<code>hostapd-configuration</code> as shown below:
</p>
<div class="lisp">
<pre class="lisp"><span class="syntax-comment">;; Use wlan1 to run the access point for "My Network".
</span><span class="syntax-paren0">(<span class="syntax-symbol"><a class="syntax-symbol" href="Service-Reference.html#index-service">service</a> <a class="syntax-symbol" href="Networking-Services.html#index-hostapd_002dservice_002dtype">hostapd-service-type</a>
         <span class="syntax-paren1">(<span class="syntax-symbol"><a class="syntax-symbol" href="Networking-Services.html#index-hostapd_002dconfiguration">hostapd-configuration</a>
          <span class="syntax-paren2">(<span class="syntax-symbol"><span class="syntax-symbol">interface</span> <span class="syntax-string">"wlan1"</span></span>)</span>
          <span class="syntax-paren2">(<span class="syntax-symbol"><span class="syntax-symbol">ssid</span> <span class="syntax-string">"My Network"</span></span>)</span>
          <span class="syntax-paren2">(<span class="syntax-symbol"><span class="syntax-symbol">channel</span> <span class="syntax-symbol">12</span></span>)</span></span>)</span></span>)</span>
</pre></div>
</dd></dl>

<dl>
<dt id="index-hostapd_002dconfiguration" class="symbol-definition"><span class="symbol-definition-category">Data Type: </span><span class="symbol-definition-prototype">hostapd-configuration </span></dt>
<dd><p>This data type represents the configuration of the hostapd service, with
the following fields:
</p>
<dl compact="compact">
<dt><code>package</code> (default: <code>hostapd</code>)</dt>
<dd><p>The hostapd package to use.
</p>
</dd>
<dt><code>interface</code> (default: <code>"wlan0"</code>)</dt>
<dd><p>The network interface to run the WiFi access point.
</p>
</dd>
<dt><code>ssid</code></dt>
<dd><p>The SSID (<em>service set identifier</em>), a string that identifies this
network.
</p>
</dd>
<dt><code>broadcast-ssid?</code> (default: <code>#t</code>)</dt>
<dd><p>Whether to broadcast this SSID.
</p>
</dd>
<dt><code>channel</code> (default: <code>1</code>)</dt>
<dd><p>The WiFi channel to use.
</p>
</dd>
<dt><code>driver</code> (default: <code>"nl80211"</code>)</dt>
<dd><p>The driver interface type.  <code>"nl80211"</code> is used with all Linux
mac80211 drivers.  Use <code>"none"</code> if building hostapd as a standalone
RADIUS server that does # not control any wireless/wired driver.
</p>
</dd>
<dt><code>extra-settings</code> (default: <code>""</code>)</dt>
<dd><p>Extra settings to append as-is to the hostapd configuration file.  See
<a href="https://w1.fi/cgit/hostap/plain/hostapd/hostapd.conf">https://w1.fi/cgit/hostap/plain/hostapd/hostapd.conf</a> for the
configuration file reference.
</p></dd>
</dl>
</dd></dl>

<dl>
<dt id="index-simulated_002dwifi_002dservice_002dtype" class="symbol-definition"><span class="symbol-definition-category">Scheme Variable: </span><span class="symbol-definition-prototype">simulated-wifi-service-type </span></dt>
<dd><p>This is the type of a service to simulate WiFi networking, which can be
useful in virtual machines for testing purposes.  The service loads the
Linux kernel
<a href="https://www.kernel.org/doc/html/latest/networking/mac80211_hwsim/mac80211_hwsim.html"><code>mac80211_hwsim</code> module</a> and starts hostapd to create a pseudo WiFi
network that can be seen on <code>wlan0</code>, by default.
</p>
<p>The service&rsquo;s value is a <code>hostapd-configuration</code> record.
</p></dd></dl>


<span id="index-iptables"></span>
<dl>
<dt id="index-iptables_002dservice_002dtype" class="symbol-definition"><span class="symbol-definition-category">Scheme Variable: </span><span class="symbol-definition-prototype">iptables-service-type </span></dt>
<dd><p>This is the service type to set up an iptables configuration.  iptables is a
packet filtering framework supported by the Linux kernel.  This service
supports configuring iptables for both IPv4 and IPv6.  A simple example
configuration rejecting all incoming connections except those to the ssh port
22 is shown below.
</p>
<div class="lisp">
<pre class="lisp"><span class="syntax-paren0">(<span class="syntax-symbol"><a class="syntax-symbol" href="Service-Reference.html#index-service">service</a> <a class="syntax-symbol" href="Networking-Services.html#index-iptables_002dservice_002dtype">iptables-service-type</a>
         <span class="syntax-paren1">(<span class="syntax-symbol"><a class="syntax-symbol" href="Networking-Services.html#index-iptables_002dconfiguration">iptables-configuration</a>
          <span class="syntax-paren2">(<span class="syntax-symbol"><span class="syntax-symbol">ipv4-rules</span> <span class="syntax-paren3">(<span class="syntax-symbol"><a class="syntax-symbol" href="G_002dExpressions.html#index-plain_002dfile">plain-file</a> <span class="syntax-string">"iptables.rules"</span> <span class="syntax-string">"*filter
:INPUT ACCEPT
:FORWARD ACCEPT
:OUTPUT ACCEPT
-A INPUT -m conntrack --ctstate ESTABLISHED,RELATED -j ACCEPT
-A INPUT -p tcp --dport 22 -j ACCEPT
-A INPUT -j REJECT --reject-with icmp-port-unreachable
COMMIT
"</span></span>)</span></span>)</span>
          <span class="syntax-paren2">(<span class="syntax-symbol"><span class="syntax-symbol">ipv6-rules</span> <span class="syntax-paren3">(<span class="syntax-symbol"><a class="syntax-symbol" href="G_002dExpressions.html#index-plain_002dfile">plain-file</a> <span class="syntax-string">"ip6tables.rules"</span> <span class="syntax-string">"*filter
:INPUT ACCEPT
:FORWARD ACCEPT
:OUTPUT ACCEPT
-A INPUT -m conntrack --ctstate ESTABLISHED,RELATED -j ACCEPT
-A INPUT -p tcp --dport 22 -j ACCEPT
-A INPUT -j REJECT --reject-with icmp6-port-unreachable
COMMIT
"</span></span>)</span></span>)</span></span>)</span></span>)</span>
</pre></div>
</dd></dl>

<dl>
<dt id="index-iptables_002dconfiguration" class="symbol-definition"><span class="symbol-definition-category">Data Type: </span><span class="symbol-definition-prototype">iptables-configuration </span></dt>
<dd><p>The data type representing the configuration of iptables.
</p>
<dl compact="compact">
<dt><code>iptables</code> (default: <code>iptables</code>)</dt>
<dd><p>The iptables package that provides <code>iptables-restore</code> and
<code>ip6tables-restore</code>.
</p></dd>
<dt><code>ipv4-rules</code> (default: <code>%iptables-accept-all-rules</code>)</dt>
<dd><p>The iptables rules to use.  It will be passed to <code>iptables-restore</code>.
This may be any &ldquo;file-like&rdquo; object (see <a href="G_002dExpressions.html">file-like
objects</a>).
</p></dd>
<dt><code>ipv6-rules</code> (default: <code>%iptables-accept-all-rules</code>)</dt>
<dd><p>The ip6tables rules to use.  It will be passed to <code>ip6tables-restore</code>.
This may be any &ldquo;file-like&rdquo; object (see <a href="G_002dExpressions.html">file-like
objects</a>).
</p></dd>
</dl>
</dd></dl>

<span id="index-nftables"></span>
<dl>
<dt id="index-nftables_002dservice_002dtype" class="symbol-definition"><span class="symbol-definition-category">Scheme Variable: </span><span class="symbol-definition-prototype">nftables-service-type </span></dt>
<dd><p>This is the service type to set up a nftables configuration.  nftables is a
netfilter project that aims to replace the existing iptables, ip6tables,
arptables and ebtables framework.  It provides a new packet filtering
framework, a new user-space utility <code>nft</code>, and a compatibility layer
for iptables.  This service comes with a default ruleset
<code>%default-nftables-ruleset</code> that rejecting all incoming connections
except those to the ssh port 22.  To use it, simply write:
</p>
<div class="lisp">
<pre class="lisp"><span class="syntax-paren0">(<span class="syntax-symbol"><a class="syntax-symbol" href="Service-Reference.html#index-service">service</a> <a class="syntax-symbol" href="Networking-Services.html#index-nftables_002dservice_002dtype">nftables-service-type</a></span>)</span>
</pre></div>
</dd></dl>

<dl>
<dt id="index-nftables_002dconfiguration" class="symbol-definition"><span class="symbol-definition-category">Data Type: </span><span class="symbol-definition-prototype">nftables-configuration </span></dt>
<dd><p>The data type representing the configuration of nftables.
</p>
<dl compact="compact">
<dt><code>package</code> (default: <code>nftables</code>)</dt>
<dd><p>The nftables package that provides <code>nft</code>.
</p></dd>
<dt><code>ruleset</code> (default: <code>%default-nftables-ruleset</code>)</dt>
<dd><p>The nftables ruleset to use.  This may be any &ldquo;file-like&rdquo; object
(see <a href="G_002dExpressions.html">file-like objects</a>).
</p></dd>
</dl>
</dd></dl>

<span id="index-NTP-_0028Network-Time-Protocol_0029_002c-service"></span>
<span id="index-ntpd_002c-service-for-the-Network-Time-Protocol-daemon"></span>
<span id="index-real-time-clock"></span>
<dl>
<dt id="index-ntp_002dservice_002dtype" class="symbol-definition"><span class="symbol-definition-category">Scheme Variable: </span><span class="symbol-definition-prototype">ntp-service-type </span></dt>
<dd><p>This is the type of the service running the <a href="https://www.ntp.org">Network Time Protocol (NTP)</a> daemon, <code>ntpd</code>.  The daemon will keep the
system clock synchronized with that of the specified NTP servers.
</p>
<p>The value of this service is an <code>ntpd-configuration</code> object, as described
below.
</p></dd></dl>

<dl>
<dt id="index-ntp_002dconfiguration" class="symbol-definition"><span class="symbol-definition-category">Data Type: </span><span class="symbol-definition-prototype">ntp-configuration </span></dt>
<dd><p>This is the data type for the NTP service configuration.
</p>
<dl compact="compact">
<dt><code>servers</code> (default: <code>%ntp-servers</code>)</dt>
<dd><p>This is the list of servers (<code>&lt;ntp-server&gt;</code> records) with which
<code>ntpd</code> will be synchronized.  See the <code>ntp-server</code> data type
definition below.
</p>
</dd>
<dt><code>allow-large-adjustment?</code> (default: <code>#t</code>)</dt>
<dd><p>This determines whether <code>ntpd</code> is allowed to make an initial
adjustment of more than 1,000 seconds.
</p>
</dd>
<dt><code>ntp</code> (default: <code>ntp</code>)</dt>
<dd><p>The NTP package to use.
</p></dd>
</dl>
</dd></dl>

<dl>
<dt id="index-_0025ntp_002dservers" class="symbol-definition"><span class="symbol-definition-category">Scheme Variable: </span><span class="symbol-definition-prototype">%ntp-servers </span></dt>
<dd><p>List of host names used as the default NTP servers.  These are servers of the
<a href="https://www.ntppool.org/en/">NTP Pool Project</a>.
</p></dd></dl>

<dl>
<dt id="index-ntp_002dserver" class="symbol-definition"><span class="symbol-definition-category">Data Type: </span><span class="symbol-definition-prototype">ntp-server </span></dt>
<dd><p>The data type representing the configuration of a NTP server.
</p>
<dl compact="compact">
<dt><code>type</code> (default: <code>'server</code>)</dt>
<dd><p>The type of the NTP server, given as a symbol.  One of <code>'pool</code>,
<code>'server</code>, <code>'peer</code>, <code>'broadcast</code> or <code>'manycastclient</code>.
</p>
</dd>
<dt><code>address</code></dt>
<dd><p>The address of the server, as a string.
</p>
</dd>
<dt><code>options</code></dt>
<dd><p>NTPD options to use with that specific server, given as a list of option names
and/or of option names and values tuples.  The following example define a server
to use with the options <samp>iburst</samp> and <samp>prefer</samp>, as well as
<samp>version</samp> 3 and a <samp>maxpoll</samp> time of 16 seconds.
</p>
<div class="example">
<pre class="example">(ntp-server
 (type 'server)
 (address "some.ntp.server.org")
 (options `(iburst (version 3) (maxpoll 16) prefer))))
</pre></div>
</dd>
</dl>
</dd></dl>

<span id="index-OpenNTPD"></span>
<dl>
<dt id="index-openntpd_002dservice_002dtype" class="symbol-definition"><span class="symbol-definition-category">Scheme Procedure: </span><span class="symbol-definition-prototype">openntpd-service-type </span></dt>
<dd><p>Run the <code>ntpd</code>, the Network Time Protocol (NTP) daemon, as implemented
by <a href="http://www.openntpd.org">OpenNTPD</a>.  The daemon will keep the system
clock synchronized with that of the given servers.
</p>
<div class="lisp">
<pre class="lisp"><span class="syntax-paren0">(<span class="syntax-symbol"><a class="syntax-symbol" href="Service-Reference.html#index-service">service</a>
 <a class="syntax-symbol" href="Networking-Services.html#index-openntpd_002dservice_002dtype">openntpd-service-type</a>
 <span class="syntax-paren1">(<span class="syntax-symbol"><a class="syntax-symbol" href="Networking-Services.html#index-openntpd_002dconfiguration">openntpd-configuration</a>
  <span class="syntax-paren2">(<span class="syntax-symbol"><span class="syntax-symbol">listen-on</span> <span class="syntax-symbol">'</span><span class="syntax-paren3">(<span class="syntax-symbol"><span class="syntax-string">"127.0.0.1"</span> <span class="syntax-string">"::1"</span></span>)</span></span>)</span>
  <span class="syntax-paren2">(<span class="syntax-symbol"><span class="syntax-symbol">sensor</span> <span class="syntax-symbol">'</span><span class="syntax-paren3">(<span class="syntax-symbol"><span class="syntax-string">"udcf0 correction 70000"</span></span>)</span></span>)</span>
  <span class="syntax-paren2">(<span class="syntax-symbol"><span class="syntax-symbol">constraint-from</span> <span class="syntax-symbol">'</span><span class="syntax-paren3">(<span class="syntax-symbol"><span class="syntax-string">"www.gnu.org"</span></span>)</span></span>)</span>
  <span class="syntax-paren2">(<span class="syntax-symbol"><span class="syntax-symbol">constraints-from</span> <span class="syntax-symbol">'</span><span class="syntax-paren3">(<span class="syntax-symbol"><span class="syntax-string">"https://www.google.com/"</span></span>)</span></span>)</span></span>)</span></span>)</span>

</pre></div>
</dd></dl>

<dl>
<dt id="index-_0025openntpd_002dservers" class="symbol-definition"><span class="symbol-definition-category">Scheme Variable: </span><span class="symbol-definition-prototype">%openntpd-servers </span></dt>
<dd><p>This variable is a list of the server addresses defined in
<code>%ntp-servers</code>.
</p></dd></dl>

<dl>
<dt id="index-openntpd_002dconfiguration" class="symbol-definition"><span class="symbol-definition-category">Data Type: </span><span class="symbol-definition-prototype">openntpd-configuration </span></dt>
<dd><dl compact="compact">
<dt><code>openntpd</code> (default: <code>(file-append openntpd "/sbin/ntpd")</code>)</dt>
<dd><p>The openntpd executable to use.
</p></dd>
<dt><code>listen-on</code> (default: <code>'("127.0.0.1" "::1")</code>)</dt>
<dd><p>A list of local IP addresses or hostnames the ntpd daemon should listen on.
</p></dd>
<dt><code>query-from</code> (default: <code>'()</code>)</dt>
<dd><p>A list of local IP address the ntpd daemon should use for outgoing queries.
</p></dd>
<dt><code>sensor</code> (default: <code>'()</code>)</dt>
<dd><p>Specify a list of timedelta sensor devices ntpd should use.  <code>ntpd</code>
will listen to each sensor that actually exists and ignore non-existent ones.
See <a href="https://man.openbsd.org/ntpd.conf">upstream documentation</a> for more
information.
</p></dd>
<dt><code>server</code> (default: <code>'()</code>)</dt>
<dd><p>Specify a list of IP addresses or hostnames of NTP servers to synchronize to.
</p></dd>
<dt><code>servers</code> (default: <code>%openntp-servers</code>)</dt>
<dd><p>Specify a list of IP addresses or hostnames of NTP pools to synchronize to.
</p></dd>
<dt><code>constraint-from</code> (default: <code>'()</code>)</dt>
<dd><p><code>ntpd</code> can be configured to query the ‘Date’ from trusted HTTPS servers via TLS.
This time information is not used for precision but acts as an authenticated
constraint, thereby reducing the impact of unauthenticated NTP
man-in-the-middle attacks.
Specify a list of URLs, IP addresses or hostnames of HTTPS servers to provide
a constraint.
</p></dd>
<dt><code>constraints-from</code> (default: <code>'()</code>)</dt>
<dd><p>As with constraint from, specify a list of URLs, IP addresses or hostnames of
HTTPS servers to provide a constraint.  Should the hostname resolve to multiple
IP addresses, <code>ntpd</code> will calculate a median constraint from all of them.
</p></dd>
</dl>
</dd></dl>

<span id="index-inetd"></span>
<dl>
<dt id="index-inetd_002dservice_002dtype" class="symbol-definition"><span class="symbol-definition-category">Scheme variable: </span><span class="symbol-definition-prototype">inetd-service-type </span></dt>
<dd><p>This service runs the <code>inetd</code> (see <a href="https://www.gnu.org/software/inetutils/manual/html_node/inetd-invocation.html#inetd-invocation">inetd invocation</a> in <cite>GNU Inetutils</cite>) daemon.  <code>inetd</code> listens for
connections on internet sockets, and lazily starts the specified server
program when a connection is made on one of these sockets.
</p>
<p>The value of this service is an <code>inetd-configuration</code> object.  The
following example configures the <code>inetd</code> daemon to provide the
built-in <code>echo</code> service, as well as an smtp service which
forwards smtp traffic over ssh to a server <code>smtp-server</code> behind a
gateway <code>hostname</code>:
</p>
<div class="lisp">
<pre class="lisp"><span class="syntax-paren0">(<span class="syntax-symbol"><a class="syntax-symbol" href="Service-Reference.html#index-service">service</a>
 <a class="syntax-symbol" href="Networking-Services.html#index-inetd_002dservice_002dtype">inetd-service-type</a>
 <span class="syntax-paren1">(<span class="syntax-symbol"><a class="syntax-symbol" href="Networking-Services.html#index-inetd_002dconfiguration">inetd-configuration</a>
  <span class="syntax-paren2">(<span class="syntax-symbol"><span class="syntax-symbol">entries</span> <span class="syntax-paren3">(<span class="syntax-symbol"><a class="syntax-symbol" href="https://www.gnu.org/software/guile/manual/html_node/List-Constructors.html#index-list-1">list</a>
            <span class="syntax-paren4">(<span class="syntax-symbol"><a class="syntax-symbol" href="Networking-Services.html#index-inetd_002dentry">inetd-entry</a>
             <span class="syntax-paren5">(<span class="syntax-symbol"><span class="syntax-symbol">name</span> <span class="syntax-string">"echo"</span></span>)</span>
             <span class="syntax-paren5">(<span class="syntax-symbol"><span class="syntax-symbol">socket-type</span> <span class="syntax-symbol">'stream</span></span>)</span>
             <span class="syntax-paren5">(<span class="syntax-symbol"><span class="syntax-symbol">protocol</span> <span class="syntax-string">"tcp"</span></span>)</span>
             <span class="syntax-paren5">(<span class="syntax-symbol"><span class="syntax-symbol">wait?</span> <span class="syntax-symbol">#f</span></span>)</span>
             <span class="syntax-paren5">(<span class="syntax-symbol"><span class="syntax-symbol">user</span> <span class="syntax-string">"root"</span></span>)</span></span>)</span>
            <span class="syntax-paren4">(<span class="syntax-symbol"><a class="syntax-symbol" href="Networking-Services.html#index-inetd_002dentry">inetd-entry</a>
             <span class="syntax-paren5">(<span class="syntax-symbol"><span class="syntax-symbol">node</span> <span class="syntax-string">"127.0.0.1"</span></span>)</span>
             <span class="syntax-paren5">(<span class="syntax-symbol"><span class="syntax-symbol">name</span> <span class="syntax-string">"smtp"</span></span>)</span>
             <span class="syntax-paren5">(<span class="syntax-symbol"><span class="syntax-symbol">socket-type</span> <span class="syntax-symbol">'stream</span></span>)</span>
             <span class="syntax-paren5">(<span class="syntax-symbol"><span class="syntax-symbol">protocol</span> <span class="syntax-string">"tcp"</span></span>)</span>
             <span class="syntax-paren5">(<span class="syntax-symbol"><span class="syntax-symbol">wait?</span> <span class="syntax-symbol">#f</span></span>)</span>
             <span class="syntax-paren5">(<span class="syntax-symbol"><span class="syntax-symbol">user</span> <span class="syntax-string">"root"</span></span>)</span>
             <span class="syntax-paren5">(<span class="syntax-symbol"><span class="syntax-symbol">program</span> <span class="syntax-paren6">(<span class="syntax-symbol"><a class="syntax-symbol" href="G_002dExpressions.html#index-file_002dappend">file-append</a> <span class="syntax-symbol">openssh</span> <span class="syntax-string">"/bin/ssh"</span></span>)</span></span>)</span>
             <span class="syntax-paren5">(<span class="syntax-symbol"><span class="syntax-symbol">arguments</span>
              <span class="syntax-symbol">'</span><span class="syntax-paren6">(<span class="syntax-symbol"><span class="syntax-string">"ssh"</span> <span class="syntax-string">"-qT"</span> <span class="syntax-string">"-i"</span> <span class="syntax-string">"/path/to/ssh_key"</span>
                <span class="syntax-string">"-W"</span> <span class="syntax-string">"smtp-server:25"</span> <span class="syntax-string">"user@hostname"</span></span>)</span></span>)</span></span>)</span></span>)</span></span>)</span></span>)</span></span>)</span>
</pre></div>

<p>See below for more details about <code>inetd-configuration</code>.
</p></dd></dl>

<dl>
<dt id="index-inetd_002dconfiguration" class="symbol-definition"><span class="symbol-definition-category">Data Type: </span><span class="symbol-definition-prototype">inetd-configuration </span></dt>
<dd><p>Data type representing the configuration of <code>inetd</code>.
</p>
<dl compact="compact">
<dt><code>program</code> (default: <code>(file-append inetutils "/libexec/inetd")</code>)</dt>
<dd><p>The <code>inetd</code> executable to use.
</p>
</dd>
<dt><code>entries</code> (default: <code>'()</code>)</dt>
<dd><p>A list of <code>inetd</code> service entries.  Each entry should be created
by the <code>inetd-entry</code> constructor.
</p></dd>
</dl>
</dd></dl>

<dl>
<dt id="index-inetd_002dentry" class="symbol-definition"><span class="symbol-definition-category">Data Type: </span><span class="symbol-definition-prototype">inetd-entry </span></dt>
<dd><p>Data type representing an entry in the <code>inetd</code> configuration.
Each entry corresponds to a socket where <code>inetd</code> will listen for
requests.
</p>
<dl compact="compact">
<dt><code>node</code> (default: <code>#f</code>)</dt>
<dd><p>Optional string, a comma-separated list of local addresses
<code>inetd</code> should use when listening for this service.
See <a href="https://www.gnu.org/software/inetutils/manual/html_node/Configuration-file.html#Configuration-file">Configuration file</a> in <cite>GNU Inetutils</cite> for a complete
description of all options.
</p></dd>
<dt><code>name</code></dt>
<dd><p>A string, the name must correspond to an entry in <code>/etc/services</code>.
</p></dd>
<dt><code>socket-type</code></dt>
<dd><p>One of <code>'stream</code>, <code>'dgram</code>, <code>'raw</code>, <code>'rdm</code> or
<code>'seqpacket</code>.
</p></dd>
<dt><code>protocol</code></dt>
<dd><p>A string, must correspond to an entry in <code>/etc/protocols</code>.
</p></dd>
<dt><code>wait?</code> (default: <code>#t</code>)</dt>
<dd><p>Whether <code>inetd</code> should wait for the server to exit before
listening to new service requests.
</p></dd>
<dt><code>user</code></dt>
<dd><p>A string containing the user (and, optionally, group) name of the user
as whom the server should run.  The group name can be specified in a
suffix, separated by a colon or period, i.e. <code>"user"</code>,
<code>"user:group"</code> or <code>"user.group"</code>.
</p></dd>
<dt><code>program</code> (default: <code>"internal"</code>)</dt>
<dd><p>The server program which will serve the requests, or <code>"internal"</code>
if <code>inetd</code> should use a built-in service.
</p></dd>
<dt><code>arguments</code> (default: <code>'()</code>)</dt>
<dd><p>A list strings or file-like objects, which are the server program&rsquo;s
arguments, starting with the zeroth argument, i.e. the name of the
program itself.  For <code>inetd</code>&rsquo;s internal services, this entry
must be <code>'()</code> or <code>'("internal")</code>.
</p></dd>
</dl>

<p>See <a href="https://www.gnu.org/software/inetutils/manual/html_node/Configuration-file.html#Configuration-file">Configuration file</a> in <cite>GNU Inetutils</cite> for a more
detailed discussion of each configuration field.
</p></dd></dl>

<span id="index-opendht_002c-distributed-hash-table-network-service"></span>
<span id="index-dhtproxy_002c-for-use-with-jami"></span>
<dl>
<dt id="index-opendht_002dservice_002dtype" class="symbol-definition"><span class="symbol-definition-category">Scheme Variable: </span><span class="symbol-definition-prototype">opendht-service-type </span></dt>
<dd><p>This is the type of the service running a <a href="https://opendht.net">OpenDHT</a> node, <code>dhtnode</code>.  The daemon can be used to host your
own proxy service to the distributed hash table (DHT), for example to
connect to with Jami, among other applications.
</p>
<blockquote>
<p><b>Important:</b> When using the OpenDHT proxy server, the IP addresses it &ldquo;sees&rdquo; from
the clients should be addresses reachable from other peers.  In practice
this means that a publicly reachable address is best suited for a proxy
server, outside of your private network.  For example, hosting the proxy
server on a IPv4 private local network and exposing it via port
forwarding could work for external peers, but peers local to the proxy
would have their private addresses shared with the external peers,
leading to connectivity problems.
</p></blockquote>

<p>The value of this service is a <code>opendht-configuration</code> object, as
described below.
</p></dd></dl>

<dl>
<dt id="index-opendht_002dconfiguration" class="symbol-definition"><span class="symbol-definition-category">Data Type: </span><span class="symbol-definition-prototype">opendht-configuration </span></dt>
<dd><p>Available <code>opendht-configuration</code> fields are:
</p>
<dl compact="compact">
<dt><code>opendht</code> (default: <code>opendht</code>) (type: file-like)</dt>
<dd><p>The <code>opendht</code> package to use.
</p>
</dd>
<dt><code>peer-discovery?</code> (default: <code>#f</code>) (type: boolean)</dt>
<dd><p>Whether to enable the multicast local peer discovery mechanism.
</p>
</dd>
<dt><code>enable-logging?</code> (default: <code>#f</code>) (type: boolean)</dt>
<dd><p>Whether to enable logging messages to syslog.  It is disabled by default
as it is rather verbose.
</p>
</dd>
<dt><code>debug?</code> (default: <code>#f</code>) (type: boolean)</dt>
<dd><p>Whether to enable debug-level logging messages.  This has no effect if
logging is disabled.
</p>
</dd>
<dt><code>bootstrap-host</code> (default: <code>"bootstrap.jami.net:4222"</code>) (type: maybe-string)</dt>
<dd><p>The node host name that is used to make the first connection to the
network.  A specific port value can be provided by appending the
<code>:PORT</code> suffix.  By default, it uses the Jami bootstrap nodes, but
any host can be specified here.  It&rsquo;s also possible to disable
bootstrapping by explicitly setting this field to the
<code>%unset-value</code> value.
</p>
</dd>
<dt><code>port</code> (default: <code>4222</code>) (type: maybe-number)</dt>
<dd><p>The UDP port to bind to.  When left unspecified, an available port is
automatically selected.
</p>
</dd>
<dt><code>proxy-server-port</code> (type: maybe-number)</dt>
<dd><p>Spawn a proxy server listening on the specified port.
</p>
</dd>
<dt><code>proxy-server-port-tls</code> (type: maybe-number)</dt>
<dd><p>Spawn a proxy server listening to TLS connections on the specified port.
</p>
</dd>
</dl>
</dd></dl>

<span id="index-Tor"></span>
<dl>
<dt id="index-tor_002dservice_002dtype" class="symbol-definition"><span class="symbol-definition-category">Scheme Variable: </span><span class="symbol-definition-prototype">tor-service-type </span></dt>
<dd><p>This is the type for a service that runs the <a href="https://torproject.org">Tor</a> anonymous networking daemon.  The service is configured using a
<code>&lt;tor-configuration&gt;</code> record.  By default, the Tor daemon runs as the
<code>tor</code> unprivileged user, which is a member of the <code>tor</code> group.
</p>
</dd></dl>

<dl>
<dt id="index-tor_002dconfiguration" class="symbol-definition"><span class="symbol-definition-category">Data Type: </span><span class="symbol-definition-prototype">tor-configuration </span></dt>
<dd><dl compact="compact">
<dt><code>tor</code> (default: <code>tor</code>)</dt>
<dd><p>The package that provides the Tor daemon.  This package is expected to provide
the daemon at <samp>bin/tor</samp> relative to its output directory.  The default
package is the <a href="https://www.torproject.org">Tor Project&rsquo;s</a>
implementation.
</p>
</dd>
<dt><code>config-file</code> (default: <code>(plain-file "empty" "")</code>)</dt>
<dd><p>The configuration file to use.  It will be appended to a default configuration
file, and the final configuration file will be passed to <code>tor</code> via its
<code>-f</code> option.  This may be any &ldquo;file-like&rdquo; object (see <a href="G_002dExpressions.html">file-like objects</a>).  See <code>man tor</code> for details on the configuration file
syntax.
</p>
</dd>
<dt><code>hidden-services</code> (default: <code>'()</code>)</dt>
<dd><p>The list of <code>&lt;hidden-service&gt;</code> records to use.  For any hidden service
you include in this list, appropriate configuration to enable the hidden
service will be automatically added to the default configuration file.  You
may conveniently create <code>&lt;hidden-service&gt;</code> records using the
<code>tor-hidden-service</code> procedure described below.
</p>
</dd>
<dt><code>socks-socket-type</code> (default: <code>'tcp</code>)</dt>
<dd><p>The default socket type that Tor should use for its SOCKS socket.  This must
be either <code>'tcp</code> or <code>'unix</code>.  If it is <code>'tcp</code>, then by default
Tor will listen on TCP port 9050 on the loopback interface (i.e., localhost).
If it is <code>'unix</code>, then Tor will listen on the UNIX domain socket
<samp>/var/run/tor/socks-sock</samp>, which will be made writable by members of the
<code>tor</code> group.
</p>
<p>If you want to customize the SOCKS socket in more detail, leave
<code>socks-socket-type</code> at its default value of <code>'tcp</code> and use
<code>config-file</code> to override the default by providing your own
<code>SocksPort</code> option.
</p>
</dd>
<dt><code>control-socket?</code> (default: <code>#f</code>)</dt>
<dd><p>Whether or not to provide a &ldquo;control socket&rdquo; by which Tor can be
controlled to, for instance, dynamically instantiate tor onion services.
If <code>#t</code>, Tor will listen for control commands on the UNIX domain socket
<samp>/var/run/tor/control-sock</samp>, which will be made writable by members of the
<code>tor</code> group.
</p>
</dd>
</dl>
</dd></dl>

<span id="index-hidden-service"></span>
<dl>
<dt id="index-tor_002dhidden_002dservice" class="symbol-definition"><span class="symbol-definition-category">Scheme Procedure: </span><span class="symbol-definition-prototype">tor-hidden-service <var>name</var> <var>mapping</var></span></dt>
<dd><p>Define a new Tor <em>hidden service</em> called <var>name</var> and implementing
<var>mapping</var>.  <var>mapping</var> is a list of port/host tuples, such as:
</p>
<div class="example">
<pre class="example"> '((22 "127.0.0.1:22")
   (80 "127.0.0.1:8080"))
</pre></div>

<p>In this example, port 22 of the hidden service is mapped to local port 22, and
port 80 is mapped to local port 8080.
</p>
<p>This creates a <samp>/var/lib/tor/hidden-services/<var>name</var></samp> directory, where
the <samp>hostname</samp> file contains the <code>.onion</code> host name for the hidden
service.
</p>
<p>See <a href="https://www.torproject.org/docs/tor-hidden-service.html.en">the Tor
project&rsquo;s documentation</a> for more information.
</p></dd></dl>

<p>The <code>(gnu services rsync)</code> module provides the following services:
</p>
<p>You might want an rsync daemon if you have files that you want available
so anyone (or just yourself) can download existing files or upload new
files.
</p>
<dl>
<dt id="index-rsync_002dservice_002dtype" class="symbol-definition"><span class="symbol-definition-category">Scheme Variable: </span><span class="symbol-definition-prototype">rsync-service-type </span></dt>
<dd><p>This is the service type for the <a href="https://rsync.samba.org">rsync</a> daemon,
The value for this service type is a
<code>rsync-configuration</code> record as in this example:
</p>
<div class="lisp">
<pre class="lisp"><span class="syntax-comment">;; Export two directories over rsync.  By default rsync listens on
</span><span class="syntax-comment">;; all the network interfaces.
</span><span class="syntax-paren0">(<span class="syntax-symbol"><a class="syntax-symbol" href="Service-Reference.html#index-service">service</a> <a class="syntax-symbol" href="Networking-Services.html#index-rsync_002dservice_002dtype">rsync-service-type</a>
         <span class="syntax-paren1">(<span class="syntax-symbol"><a class="syntax-symbol" href="Networking-Services.html#index-rsync_002dconfiguration">rsync-configuration</a>
           <span class="syntax-paren2">(<span class="syntax-symbol"><span class="syntax-symbol">modules</span> <span class="syntax-paren3">(<span class="syntax-symbol"><a class="syntax-symbol" href="https://www.gnu.org/software/guile/manual/html_node/List-Constructors.html#index-list-1">list</a> <span class="syntax-paren4">(<span class="syntax-symbol"><a class="syntax-symbol" href="Networking-Services.html#index-rsync_002dmodule">rsync-module</a>
                            <span class="syntax-paren5">(<span class="syntax-symbol"><span class="syntax-symbol">name</span> <span class="syntax-string">"music"</span></span>)</span>
                            <span class="syntax-paren5">(<span class="syntax-symbol"><span class="syntax-symbol">file-name</span> <span class="syntax-string">"/srv/zik"</span></span>)</span>
                            <span class="syntax-paren5">(<span class="syntax-symbol"><span class="syntax-symbol">read-only?</span> <span class="syntax-symbol">#f</span></span>)</span></span>)</span>
                          <span class="syntax-paren4">(<span class="syntax-symbol"><a class="syntax-symbol" href="Networking-Services.html#index-rsync_002dmodule">rsync-module</a>
                            <span class="syntax-paren5">(<span class="syntax-symbol"><span class="syntax-symbol">name</span> <span class="syntax-string">"movies"</span></span>)</span>
                            <span class="syntax-paren5">(<span class="syntax-symbol"><span class="syntax-symbol">file-name</span> <span class="syntax-string">"/home/charlie/movies"</span></span>)</span></span>)</span></span>)</span></span>)</span></span>)</span></span>)</span>
</pre></div>

<p>See below for details about <code>rsync-configuration</code>.
</p></dd></dl>

<dl>
<dt id="index-rsync_002dconfiguration" class="symbol-definition"><span class="symbol-definition-category">Data Type: </span><span class="symbol-definition-prototype">rsync-configuration </span></dt>
<dd><p>Data type representing the configuration for <code>rsync-service</code>.
</p>
<dl compact="compact">
<dt><code>package</code> (default: <var>rsync</var>)</dt>
<dd><p><code>rsync</code> package to use.
</p>
</dd>
<dt><code>address</code> (default: <code>#f</code>)</dt>
<dd><p>IP address on which <code>rsync</code> listens for incoming connections.
If unspecified, it defaults to listening on all available addresses.
</p>
</dd>
<dt><code>port-number</code> (default: <code>873</code>)</dt>
<dd><p>TCP port on which <code>rsync</code> listens for incoming connections.  If port
is less than <code>1024</code> <code>rsync</code> needs to be started as the
<code>root</code> user and group.
</p>
</dd>
<dt><code>pid-file</code> (default: <code>"/var/run/rsyncd/rsyncd.pid"</code>)</dt>
<dd><p>Name of the file where <code>rsync</code> writes its PID.
</p>
</dd>
<dt><code>lock-file</code> (default: <code>"/var/run/rsyncd/rsyncd.lock"</code>)</dt>
<dd><p>Name of the file where <code>rsync</code> writes its lock file.
</p>
</dd>
<dt><code>log-file</code> (default: <code>"/var/log/rsyncd.log"</code>)</dt>
<dd><p>Name of the file where <code>rsync</code> writes its log file.
</p>
</dd>
<dt><code>user</code> (default: <code>"root"</code>)</dt>
<dd><p>Owner of the <code>rsync</code> process.
</p>
</dd>
<dt><code>group</code> (default: <code>"root"</code>)</dt>
<dd><p>Group of the <code>rsync</code> process.
</p>
</dd>
<dt><code>uid</code> (default: <code>"rsyncd"</code>)</dt>
<dd><p>User name or user ID that file transfers to and from that module should take
place as when the daemon was run as <code>root</code>.
</p>
</dd>
<dt><code>gid</code> (default: <code>"rsyncd"</code>)</dt>
<dd><p>Group name or group ID that will be used when accessing the module.
</p>
</dd>
<dt><code>modules</code> (default: <code>%default-modules</code>)</dt>
<dd><p>List of &ldquo;modules&rdquo;&mdash;i.e., directories exported over rsync.  Each
element must be a <code>rsync-module</code> record, as described below.
</p></dd>
</dl>
</dd></dl>

<dl>
<dt id="index-rsync_002dmodule" class="symbol-definition"><span class="symbol-definition-category">Data Type: </span><span class="symbol-definition-prototype">rsync-module </span></dt>
<dd><p>This is the data type for rsync &ldquo;modules&rdquo;.  A module is a directory
exported over the rsync protocol.  The available fields are as follows:
</p>
<dl compact="compact">
<dt><code>name</code></dt>
<dd><p>The module name.  This is the name that shows up in URLs.  For example,
if the module is called <code>music</code>, the corresponding URL will be
<code>rsync://host.example.org/music</code>.
</p>
</dd>
<dt><code>file-name</code></dt>
<dd><p>Name of the directory being exported.
</p>
</dd>
<dt><code>comment</code> (default: <code>""</code>)</dt>
<dd><p>Comment associated with the module.  Client user interfaces may display
it when they obtain the list of available modules.
</p>
</dd>
<dt><code>read-only?</code> (default: <code>#t</code>)</dt>
<dd><p>Whether or not client will be able to upload files.  If this is false,
the uploads will be authorized if permissions on the daemon side permit
it.
</p>
</dd>
<dt><code>chroot?</code> (default: <code>#t</code>)</dt>
<dd><p>When this is true, the rsync daemon changes root to the module&rsquo;s
directory before starting file transfers with the client.  This improves
security, but requires rsync to run as root.
</p>
</dd>
<dt><code>timeout</code> (default: <code>300</code>)</dt>
<dd><p>Idle time in seconds after which the daemon closes a connection with the
client.
</p></dd>
</dl>
</dd></dl>

<p>The <code>(gnu services syncthing)</code> module provides the following services:
<span id="index-syncthing"></span>
</p>
<p>You might want a syncthing daemon if you have files between two or more
computers and want to sync them in real time, safely protected from
prying eyes.
</p>
<dl>
<dt id="index-syncthing_002dservice_002dtype" class="symbol-definition"><span class="symbol-definition-category">Scheme Variable: </span><span class="symbol-definition-prototype">syncthing-service-type </span></dt>
<dd><p>This is the service type for the <a href="https://syncthing.net/">syncthing</a> daemon, The value for this service type is a
<code>syncthing-configuration</code> record as in this example:
</p>
<div class="lisp">
<pre class="lisp"><span class="syntax-paren0">(<span class="syntax-symbol"><a class="syntax-symbol" href="Service-Reference.html#index-service">service</a> <a class="syntax-symbol" href="Networking-Services.html#index-syncthing_002dservice_002dtype">syncthing-service-type</a>
         <span class="syntax-paren1">(<span class="syntax-symbol"><a class="syntax-symbol" href="Networking-Services.html#index-syncthing_002dconfiguration">syncthing-configuration</a> <span class="syntax-paren2">(<span class="syntax-symbol"><span class="syntax-symbol">user</span> <span class="syntax-string">"alice"</span></span>)</span></span>)</span></span>)</span>
</pre></div>

<p>See below for details about <code>syncthing-configuration</code>.
</p>
<dl>
<dt id="index-syncthing_002dconfiguration" class="symbol-definition"><span class="symbol-definition-category">Data Type: </span><span class="symbol-definition-prototype">syncthing-configuration </span></dt>
<dd><p>Data type representing the configuration for <code>syncthing-service-type</code>.
</p>
<dl compact="compact">
<dt><code>syncthing</code> (default: <var>syncthing</var>)</dt>
<dd><p><code>syncthing</code> package to use.
</p>
</dd>
<dt><code>arguments</code> (default: <var>&rsquo;()</var>)</dt>
<dd><p>List of command-line arguments passing to <code>syncthing</code> binary.
</p>
</dd>
<dt><code>logflags</code> (default: <var>0</var>)</dt>
<dd><p>Sum of logging flags, see
<a href="https://docs.syncthing.net/users/syncthing.html#cmdoption-logflags">Syncthing documentation logflags</a>.
</p>
</dd>
<dt><code>user</code> (default: <var>#f</var>)</dt>
<dd><p>The user as which the Syncthing service is to be run.
This assumes that the specified user exists.
</p>
</dd>
<dt><code>group</code> (default: <var>"users"</var>)</dt>
<dd><p>The group as which the Syncthing service is to be run.
This assumes that the specified group exists.
</p>
</dd>
<dt><code>home</code> (default: <var>#f</var>)</dt>
<dd><p>Common configuration and data directory.  The default configuration
directory is <samp>$HOME</samp> of the specified Syncthing <code>user</code>.
</p>
</dd>
</dl>
</dd></dl>
</dd></dl>

<p>Furthermore, <code>(gnu services ssh)</code> provides the following services.
<span id="index-SSH"></span>
<span id="index-SSH-server"></span>
</p>
<dl>
<dt id="index-lsh_002dservice" class="symbol-definition"><span class="symbol-definition-category">Scheme Procedure: </span><span class="symbol-definition-prototype">lsh-service [#:host-key "/etc/lsh/host-key"]        [#:daemonic? #t] [#:interfaces '()] [#:port-number 22]        [#:allow-empty-passwords? #f] [#:root-login? #f]        [#:syslog-output? #t] [#:x11-forwarding? #t]        [#:tcp/ip-forwarding? #t] [#:password-authentication? #t]        [#:public-key-authentication? #t] [#:initialize? #t]</span></dt>
<dd><p>Run the <code>lshd</code> program from <var>lsh</var> to listen on port <var>port-number</var>.
<var>host-key</var> must designate a file containing the host key, and readable
only by root.
</p>
<p>When <var>daemonic?</var> is true, <code>lshd</code> will detach from the
controlling terminal and log its output to syslogd, unless one sets
<var>syslog-output?</var> to false.  Obviously, it also makes lsh-service
depend on existence of syslogd service.  When <var>pid-file?</var> is true,
<code>lshd</code> writes its PID to the file called <var>pid-file</var>.
</p>
<p>When <var>initialize?</var> is true, automatically create the seed and host key
upon service activation if they do not exist yet.  This may take long and
require interaction.
</p>
<p>When <var>initialize?</var> is false, it is up to the user to initialize the
randomness generator (see <a href="http://www.lysator.liu.se/~nisse/lsh/lsh.html#lsh_002dmake_002dseed">lsh-make-seed</a> in <cite>LSH Manual</cite>), and to create
a key pair with the private key stored in file <var>host-key</var> (see <a href="http://www.lysator.liu.se/~nisse/lsh/lsh.html#lshd-basics">lshd
basics</a> in <cite>LSH Manual</cite>).
</p>
<p>When <var>interfaces</var> is empty, lshd listens for connections on all the
network interfaces; otherwise, <var>interfaces</var> must be a list of host names
or addresses.
</p>
<p><var>allow-empty-passwords?</var> specifies whether to accept log-ins with empty
passwords, and <var>root-login?</var> specifies whether to accept log-ins as
root.
</p>
<p>The other options should be self-descriptive.
</p></dd></dl>

<span id="index-SSH-1"></span>
<span id="index-SSH-server-1"></span>
<dl>
<dt id="index-openssh_002dservice_002dtype" class="symbol-definition"><span class="symbol-definition-category">Scheme Variable: </span><span class="symbol-definition-prototype">openssh-service-type </span></dt>
<dd><p>This is the type for the <a href="http://www.openssh.org">OpenSSH</a> secure
shell daemon, <code>sshd</code>.  Its value must be an
<code>openssh-configuration</code> record as in this example:
</p>
<div class="lisp">
<pre class="lisp"><span class="syntax-paren0">(<span class="syntax-symbol"><a class="syntax-symbol" href="Service-Reference.html#index-service">service</a> <a class="syntax-symbol" href="Networking-Services.html#index-openssh_002dservice_002dtype">openssh-service-type</a>
         <span class="syntax-paren1">(<span class="syntax-symbol"><a class="syntax-symbol" href="Networking-Services.html#index-openssh_002dconfiguration">openssh-configuration</a>
           <span class="syntax-paren2">(<span class="syntax-symbol"><span class="syntax-symbol">x11-forwarding?</span> <span class="syntax-symbol">#t</span></span>)</span>
           <span class="syntax-paren2">(<span class="syntax-symbol"><span class="syntax-symbol">permit-root-login</span> <span class="syntax-symbol">'prohibit-password</span></span>)</span>
           <span class="syntax-paren2">(<span class="syntax-symbol"><span class="syntax-symbol">authorized-keys</span>
             <span class="syntax-symbol">`</span><span class="syntax-paren3">(<span class="syntax-symbol"><span class="syntax-paren4">(<span class="syntax-symbol"><span class="syntax-string">"alice"</span> <span class="syntax-symbol">,</span><span class="syntax-paren5">(<span class="syntax-symbol"><a class="syntax-symbol" href="G_002dExpressions.html#index-local_002dfile">local-file</a> <span class="syntax-string">"alice.pub"</span></span>)</span></span>)</span>
               <span class="syntax-paren4">(<span class="syntax-symbol"><span class="syntax-string">"bob"</span> <span class="syntax-symbol">,</span><span class="syntax-paren5">(<span class="syntax-symbol"><a class="syntax-symbol" href="G_002dExpressions.html#index-local_002dfile">local-file</a> <span class="syntax-string">"bob.pub"</span></span>)</span></span>)</span></span>)</span></span>)</span></span>)</span></span>)</span>
</pre></div>

<p>See below for details about <code>openssh-configuration</code>.
</p>
<p>This service can be extended with extra authorized keys, as in this
example:
</p>
<div class="lisp">
<pre class="lisp"><span class="syntax-paren0">(<span class="syntax-symbol"><a class="syntax-symbol" href="Service-Reference.html#index-service_002dextension">service-extension</a> <a class="syntax-symbol" href="Networking-Services.html#index-openssh_002dservice_002dtype">openssh-service-type</a>
                   <span class="syntax-paren1">(<span class="syntax-symbol"><a class="syntax-symbol" href="https://www.gnu.org/software/guile/manual/html_node/Higher_002dOrder-Functions.html#index-const">const</a> <span class="syntax-symbol">`</span><span class="syntax-paren2">(<span class="syntax-symbol"><span class="syntax-paren3">(<span class="syntax-symbol"><span class="syntax-string">"charlie"</span>
                             <span class="syntax-symbol">,</span><span class="syntax-paren4">(<span class="syntax-symbol"><a class="syntax-symbol" href="G_002dExpressions.html#index-local_002dfile">local-file</a> <span class="syntax-string">"charlie.pub"</span></span>)</span></span>)</span></span>)</span></span>)</span></span>)</span>
</pre></div>
</dd></dl>

<dl>
<dt id="index-openssh_002dconfiguration" class="symbol-definition"><span class="symbol-definition-category">Data Type: </span><span class="symbol-definition-prototype">openssh-configuration </span></dt>
<dd><p>This is the configuration record for OpenSSH&rsquo;s <code>sshd</code>.
</p>
<dl compact="compact">
<dt><code>openssh</code> (default <var>openssh</var>)</dt>
<dd><p>The OpenSSH package to use.
</p>
</dd>
<dt><code>pid-file</code> (default: <code>"/var/run/sshd.pid"</code>)</dt>
<dd><p>Name of the file where <code>sshd</code> writes its PID.
</p>
</dd>
<dt><code>port-number</code> (default: <code>22</code>)</dt>
<dd><p>TCP port on which <code>sshd</code> listens for incoming connections.
</p>
</dd>
<dt><code>max-connections</code> (default: <code>200</code>)</dt>
<dd><p>Hard limit on the maximum number of simultaneous client connections,
enforced by the inetd-style Shepherd service (see <a href="https://www.gnu.org/software/shepherd/manual/html_node/Service-De_002d-and-Constructors.html#Service-De_002d-and-Constructors"><code>make-inetd-constructor</code></a> in <cite>The GNU Shepherd
Manual</cite>).
</p>
</dd>
<dt><code>permit-root-login</code> (default: <code>#f</code>)</dt>
<dd><p>This field determines whether and when to allow logins as root.  If
<code>#f</code>, root logins are disallowed; if <code>#t</code>, they are allowed.
If it&rsquo;s the symbol <code>'prohibit-password</code>, then root logins are
permitted but not with password-based authentication.
</p>
</dd>
<dt><code>allow-empty-passwords?</code> (default: <code>#f</code>)</dt>
<dd><p>When true, users with empty passwords may log in.  When false, they may
not.
</p>
</dd>
<dt><code>password-authentication?</code> (default: <code>#t</code>)</dt>
<dd><p>When true, users may log in with their password.  When false, they have
other authentication methods.
</p>
</dd>
<dt><code>public-key-authentication?</code> (default: <code>#t</code>)</dt>
<dd><p>When true, users may log in using public key authentication.  When
false, users have to use other authentication method.
</p>
<p>Authorized public keys are stored in <samp>~/.ssh/authorized_keys</samp>.
This is used only by protocol version 2.
</p>
</dd>
<dt><code>x11-forwarding?</code> (default: <code>#f</code>)</dt>
<dd><p>When true, forwarding of X11 graphical client connections is
enabled&mdash;in other words, <code>ssh</code> options <samp>-X</samp> and
<samp>-Y</samp> will work.
</p>
</dd>
<dt><code>allow-agent-forwarding?</code> (default: <code>#t</code>)</dt>
<dd><p>Whether to allow agent forwarding.
</p>
</dd>
<dt><code>allow-tcp-forwarding?</code> (default: <code>#t</code>)</dt>
<dd><p>Whether to allow TCP forwarding.
</p>
</dd>
<dt><code>gateway-ports?</code> (default: <code>#f</code>)</dt>
<dd><p>Whether to allow gateway ports.
</p>
</dd>
<dt><code>challenge-response-authentication?</code> (default: <code>#f</code>)</dt>
<dd><p>Specifies whether challenge response authentication is allowed (e.g. via
PAM).
</p>
</dd>
<dt><code>use-pam?</code> (default: <code>#t</code>)</dt>
<dd><p>Enables the Pluggable Authentication Module interface.  If set to
<code>#t</code>, this will enable PAM authentication using
<code>challenge-response-authentication?</code> and
<code>password-authentication?</code>, in addition to PAM account and session
module processing for all authentication types.
</p>
<p>Because PAM challenge response authentication usually serves an
equivalent role to password authentication, you should disable either
<code>challenge-response-authentication?</code> or
<code>password-authentication?</code>.
</p>
</dd>
<dt><code>print-last-log?</code> (default: <code>#t</code>)</dt>
<dd><p>Specifies whether <code>sshd</code> should print the date and time of the
last user login when a user logs in interactively.
</p>
</dd>
<dt><code>subsystems</code> (default: <code>'(("sftp" "internal-sftp"))</code>)</dt>
<dd><p>Configures external subsystems (e.g. file transfer daemon).
</p>
<p>This is a list of two-element lists, each of which containing the
subsystem name and a command (with optional arguments) to execute upon
subsystem request.
</p>
<p>The command <code>internal-sftp</code> implements an in-process SFTP
server.  Alternatively, one can specify the <code>sftp-server</code> command:
</p><div class="lisp">
<pre class="lisp"><span class="syntax-paren0">(<span class="syntax-symbol"><a class="syntax-symbol" href="Service-Reference.html#index-service">service</a> <a class="syntax-symbol" href="Networking-Services.html#index-openssh_002dservice_002dtype">openssh-service-type</a>
         <span class="syntax-paren1">(<span class="syntax-symbol"><a class="syntax-symbol" href="Networking-Services.html#index-openssh_002dconfiguration">openssh-configuration</a>
          <span class="syntax-paren2">(<span class="syntax-symbol"><span class="syntax-symbol">subsystems</span>
           <span class="syntax-symbol">`</span><span class="syntax-paren3">(<span class="syntax-symbol"><span class="syntax-paren4">(<span class="syntax-symbol"><span class="syntax-string">"sftp"</span> <span class="syntax-symbol">,</span><span class="syntax-paren5">(<span class="syntax-symbol"><a class="syntax-symbol" href="G_002dExpressions.html#index-file_002dappend">file-append</a> <span class="syntax-symbol">openssh</span> <span class="syntax-string">"/libexec/sftp-server"</span></span>)</span></span>)</span></span>)</span></span>)</span></span>)</span></span>)</span>
</pre></div>

</dd>
<dt><code>accepted-environment</code> (default: <code>'()</code>)</dt>
<dd><p>List of strings describing which environment variables may be exported.
</p>
<p>Each string gets on its own line.  See the <code>AcceptEnv</code> option in
<code>man sshd_config</code>.
</p>
<p>This example allows ssh-clients to export the <code>COLORTERM</code> variable.
It is set by terminal emulators, which support colors.  You can use it in
your shell&rsquo;s resource file to enable colors for the prompt and commands
if this variable is set.
</p>
<div class="lisp">
<pre class="lisp"><span class="syntax-paren0">(<span class="syntax-symbol"><a class="syntax-symbol" href="Service-Reference.html#index-service">service</a> <a class="syntax-symbol" href="Networking-Services.html#index-openssh_002dservice_002dtype">openssh-service-type</a>
         <span class="syntax-paren1">(<span class="syntax-symbol"><a class="syntax-symbol" href="Networking-Services.html#index-openssh_002dconfiguration">openssh-configuration</a>
           <span class="syntax-paren2">(<span class="syntax-symbol"><span class="syntax-symbol">accepted-environment</span> <span class="syntax-symbol">'</span><span class="syntax-paren3">(<span class="syntax-symbol"><span class="syntax-string">"COLORTERM"</span></span>)</span></span>)</span></span>)</span></span>)</span>
</pre></div>

</dd>
<dt><code>authorized-keys</code> (default: <code>'()</code>)</dt>
<dd><span id="index-authorized-keys_002c-SSH"></span>
<span id="index-SSH-authorized-keys"></span>
<p>This is the list of authorized keys.  Each element of the list is a user
name followed by one or more file-like objects that represent SSH public
keys.  For example:
</p>
<div class="lisp">
<pre class="lisp"><span class="syntax-paren0">(<span class="syntax-symbol"><a class="syntax-symbol" href="Networking-Services.html#index-openssh_002dconfiguration">openssh-configuration</a>
  <span class="syntax-paren1">(<span class="syntax-symbol"><span class="syntax-symbol">authorized-keys</span>
    <span class="syntax-symbol">`</span><span class="syntax-paren2">(<span class="syntax-symbol"><span class="syntax-paren3">(<span class="syntax-symbol"><span class="syntax-string">"rekado"</span> <span class="syntax-symbol">,</span><span class="syntax-paren4">(<span class="syntax-symbol"><a class="syntax-symbol" href="G_002dExpressions.html#index-local_002dfile">local-file</a> <span class="syntax-string">"rekado.pub"</span></span>)</span></span>)</span>
      <span class="syntax-paren3">(<span class="syntax-symbol"><span class="syntax-string">"chris"</span> <span class="syntax-symbol">,</span><span class="syntax-paren4">(<span class="syntax-symbol"><a class="syntax-symbol" href="G_002dExpressions.html#index-local_002dfile">local-file</a> <span class="syntax-string">"chris.pub"</span></span>)</span></span>)</span>
      <span class="syntax-paren3">(<span class="syntax-symbol"><span class="syntax-string">"root"</span> <span class="syntax-symbol">,</span><span class="syntax-paren4">(<span class="syntax-symbol"><a class="syntax-symbol" href="G_002dExpressions.html#index-local_002dfile">local-file</a> <span class="syntax-string">"rekado.pub"</span></span>)</span> <span class="syntax-symbol">,</span><span class="syntax-paren4">(<span class="syntax-symbol"><a class="syntax-symbol" href="G_002dExpressions.html#index-local_002dfile">local-file</a> <span class="syntax-string">"chris.pub"</span></span>)</span></span>)</span></span>)</span></span>)</span></span>)</span>
</pre></div>

<p>registers the specified public keys for user accounts <code>rekado</code>,
<code>chris</code>, and <code>root</code>.
</p>
<p>Additional authorized keys can be specified <i>via</i>
<code>service-extension</code>.
</p>
<p>Note that this does <em>not</em> interfere with the use of
<samp>~/.ssh/authorized_keys</samp>.
</p>
</dd>
<dt><code>generate-host-keys?</code> (default: <code>#t</code>)</dt>
<dd><p>Whether to generate host key pairs with <code>ssh-keygen -A</code> under
<samp>/etc/ssh</samp> if there are none.
</p>
<p>Generating key pairs takes a few seconds when enough entropy is
available and is only done once.  You might want to turn it off for
instance in a virtual machine that does not need it because host keys
are provided in some other way, and where the extra boot time is a
problem.
</p>
</dd>
<dt><code>log-level</code> (default: <code>'info</code>)</dt>
<dd><p>This is a symbol specifying the logging level: <code>quiet</code>, <code>fatal</code>,
<code>error</code>, <code>info</code>, <code>verbose</code>, <code>debug</code>, etc.  See the man
page for <samp>sshd_config</samp> for the full list of level names.
</p>
</dd>
<dt><code>extra-content</code> (default: <code>""</code>)</dt>
<dd><p>This field can be used to append arbitrary text to the configuration file.  It
is especially useful for elaborate configurations that cannot be expressed
otherwise.  This configuration, for example, would generally disable root
logins, but permit them from one specific IP address:
</p>
<div class="lisp">
<pre class="lisp"><span class="syntax-paren0">(<span class="syntax-symbol"><a class="syntax-symbol" href="Networking-Services.html#index-openssh_002dconfiguration">openssh-configuration</a>
  <span class="syntax-paren1">(<span class="syntax-symbol"><span class="syntax-symbol">extra-content</span> <span class="syntax-string">"\
Match Address 192.168.0.1
  PermitRootLogin yes"</span></span>)</span></span>)</span>
</pre></div>

</dd>
</dl>
</dd></dl>

<dl>
<dt id="index-dropbear_002dservice" class="symbol-definition"><span class="symbol-definition-category">Scheme Procedure: </span><span class="symbol-definition-prototype">dropbear-service [<var>config</var>]</span></dt>
<dd><p>Run the <a href="https://matt.ucc.asn.au/dropbear/dropbear.html">Dropbear SSH
daemon</a> with the given <var>config</var>, a <code>&lt;dropbear-configuration&gt;</code>
object.
</p>
<p>For example, to specify a Dropbear service listening on port 1234, add
this call to the operating system&rsquo;s <code>services</code> field:
</p>
<div class="lisp">
<pre class="lisp"><span class="syntax-paren0">(<span class="syntax-symbol"><a class="syntax-symbol" href="Networking-Services.html#index-dropbear_002dservice">dropbear-service</a> <span class="syntax-paren1">(<span class="syntax-symbol"><a class="syntax-symbol" href="Networking-Services.html#index-dropbear_002dconfiguration">dropbear-configuration</a>
                    <span class="syntax-paren2">(<span class="syntax-symbol"><span class="syntax-symbol">port-number</span> <span class="syntax-symbol">1234</span></span>)</span></span>)</span></span>)</span>
</pre></div>
</dd></dl>

<dl>
<dt id="index-dropbear_002dconfiguration" class="symbol-definition"><span class="symbol-definition-category">Data Type: </span><span class="symbol-definition-prototype">dropbear-configuration </span></dt>
<dd><p>This data type represents the configuration of a Dropbear SSH daemon.
</p>
<dl compact="compact">
<dt><code>dropbear</code> (default: <var>dropbear</var>)</dt>
<dd><p>The Dropbear package to use.
</p>
</dd>
<dt><code>port-number</code> (default: 22)</dt>
<dd><p>The TCP port where the daemon waits for incoming connections.
</p>
</dd>
<dt><code>syslog-output?</code> (default: <code>#t</code>)</dt>
<dd><p>Whether to enable syslog output.
</p>
</dd>
<dt><code>pid-file</code> (default: <code>"/var/run/dropbear.pid"</code>)</dt>
<dd><p>File name of the daemon&rsquo;s PID file.
</p>
</dd>
<dt><code>root-login?</code> (default: <code>#f</code>)</dt>
<dd><p>Whether to allow <code>root</code> logins.
</p>
</dd>
<dt><code>allow-empty-passwords?</code> (default: <code>#f</code>)</dt>
<dd><p>Whether to allow empty passwords.
</p>
</dd>
<dt><code>password-authentication?</code> (default: <code>#t</code>)</dt>
<dd><p>Whether to enable password-based authentication.
</p></dd>
</dl>
</dd></dl>

<span id="index-AutoSSH"></span>
<dl>
<dt id="index-autossh_002dservice_002dtype" class="symbol-definition"><span class="symbol-definition-category">Scheme Variable: </span><span class="symbol-definition-prototype">autossh-service-type </span></dt>
<dd><p>This is the type for the <a href="https://www.harding.motd.ca/autossh">AutoSSH</a> program that runs a copy of <code>ssh</code> and monitors it,
restarting it as necessary should it die or stop passing traffic.
AutoSSH can be run manually from the command-line by passing arguments
to the binary <code>autossh</code> from the package <code>autossh</code>, but it
can also be run as a Guix service.  This latter use case is documented
here.
</p>
<p>AutoSSH can be used to forward local traffic to a remote machine using
an SSH tunnel, and it respects the <samp>~/.ssh/config</samp> of the user it
is run as.
</p>
<p>For example, to specify a service running autossh as the user
<code>pino</code> and forwarding all local connections to port <code>8081</code> to
<code>remote:8081</code> using an SSH tunnel, add this call to the operating
system&rsquo;s <code>services</code> field:
</p>
<div class="lisp">
<pre class="lisp"><span class="syntax-paren0">(<span class="syntax-symbol"><a class="syntax-symbol" href="Service-Reference.html#index-service">service</a> <a class="syntax-symbol" href="Networking-Services.html#index-autossh_002dservice_002dtype">autossh-service-type</a>
         <span class="syntax-paren1">(<span class="syntax-symbol"><a class="syntax-symbol" href="Networking-Services.html#index-autossh_002dconfiguration">autossh-configuration</a>
          <span class="syntax-paren2">(<span class="syntax-symbol"><span class="syntax-symbol">user</span> <span class="syntax-string">"pino"</span></span>)</span>
          <span class="syntax-paren2">(<span class="syntax-symbol"><span class="syntax-symbol">ssh-options</span> <span class="syntax-paren3">(<span class="syntax-symbol"><a class="syntax-symbol" href="https://www.gnu.org/software/guile/manual/html_node/List-Constructors.html#index-list-1">list</a> <span class="syntax-string">"-T"</span> <span class="syntax-string">"-N"</span> <span class="syntax-string">"-L"</span> <span class="syntax-string">"8081:localhost:8081"</span> <span class="syntax-string">"remote.net"</span></span>)</span></span>)</span></span>)</span></span>)</span>
</pre></div>
</dd></dl>

<dl>
<dt id="index-autossh_002dconfiguration" class="symbol-definition"><span class="symbol-definition-category">Data Type: </span><span class="symbol-definition-prototype">autossh-configuration </span></dt>
<dd><p>This data type represents the configuration of an AutoSSH service.
</p>
<dl compact="compact">
<dt><code>user</code> (default <code>"autossh"</code>)</dt>
<dd><p>The user as which the AutoSSH service is to be run.
This assumes that the specified user exists.
</p>
</dd>
<dt><code>poll</code> (default <code>600</code>)</dt>
<dd><p>Specifies the connection poll time in seconds.
</p>
</dd>
<dt><code>first-poll</code> (default <code>#f</code>)</dt>
<dd><p>Specifies how many seconds AutoSSH waits before the first connection
test.  After this first test, polling is resumed at the pace defined in
<code>poll</code>.  When set to <code>#f</code>, the first poll is not treated
specially and will also use the connection poll specified in
<code>poll</code>.
</p>
</dd>
<dt><code>gate-time</code> (default <code>30</code>)</dt>
<dd><p>Specifies how many seconds an SSH connection must be active before it is
considered successful.
</p>
</dd>
<dt><code>log-level</code> (default <code>1</code>)</dt>
<dd><p>The log level, corresponding to the levels used by syslog&mdash;so <code>0</code>
is the most silent while <code>7</code> is the chattiest.
</p>
</dd>
<dt><code>max-start</code> (default <code>#f</code>)</dt>
<dd><p>The maximum number of times SSH may be (re)started before AutoSSH exits.
When set to <code>#f</code>, no maximum is configured and AutoSSH may restart indefinitely.
</p>
</dd>
<dt><code>message</code> (default <code>""</code>)</dt>
<dd><p>The message to append to the echo message sent when testing connections.
</p>
</dd>
<dt><code>port</code> (default <code>"0"</code>)</dt>
<dd><p>The ports used for monitoring the connection.  When set to <code>"0"</code>,
monitoring is disabled.  When set to <code>"<var>n</var>"</code> where <var>n</var> is
a positive integer, ports <var>n</var> and <var>n</var>+1 are used for
monitoring the connection, such that port <var>n</var> is the base
monitoring port and <code>n+1</code> is the echo port.  When set to
<code>"<var>n</var>:<var>m</var>"</code> where <var>n</var> and <var>m</var> are positive
integers, the ports <var>n</var> and <var>m</var> are used for monitoring the
connection, such that port <var>n</var> is the base monitoring port and
<var>m</var> is the echo port.
</p>
</dd>
<dt><code>ssh-options</code> (default <code>'()</code>)</dt>
<dd><p>The list of command-line arguments to pass to <code>ssh</code> when it is
run.  Options <samp>-f</samp> and <samp>-M</samp> are reserved for AutoSSH and
may cause undefined behaviour.
</p>
</dd>
</dl>
</dd></dl>

<span id="index-WebSSH"></span>
<dl>
<dt id="index-webssh_002dservice_002dtype" class="symbol-definition"><span class="symbol-definition-category">Scheme Variable: </span><span class="symbol-definition-prototype">webssh-service-type </span></dt>
<dd><p>This is the type for the <a href="https://webssh.huashengdun.org/">WebSSH</a>
program that runs a web SSH client.  WebSSH can be run manually from the
command-line by passing arguments to the binary <code>wssh</code> from the
package <code>webssh</code>, but it can also be run as a Guix service.  This
latter use case is documented here.
</p>
<p>For example, to specify a service running WebSSH on loopback interface
on port <code>8888</code> with reject policy with a list of allowed to
connection hosts, and NGINX as a reverse-proxy to this service listening
for HTTPS connection, add this call to the operating system&rsquo;s
<code>services</code> field:
</p>
<div class="lisp">
<pre class="lisp"><span class="syntax-paren0">(<span class="syntax-symbol"><a class="syntax-symbol" href="Service-Reference.html#index-service">service</a> <a class="syntax-symbol" href="Networking-Services.html#index-webssh_002dservice_002dtype">webssh-service-type</a>
  <span class="syntax-paren1">(<span class="syntax-symbol"><a class="syntax-symbol" href="Networking-Services.html#index-webssh_002dconfiguration">webssh-configuration</a> <span class="syntax-paren2">(<span class="syntax-symbol"><span class="syntax-symbol">address</span> <span class="syntax-string">"127.0.0.1"</span></span>)</span>
                        <span class="syntax-paren2">(<span class="syntax-symbol"><span class="syntax-symbol">port</span> <span class="syntax-symbol">8888</span></span>)</span>
                        <span class="syntax-paren2">(<span class="syntax-symbol"><span class="syntax-symbol">policy</span> <span class="syntax-symbol">'reject</span></span>)</span>
                        <span class="syntax-paren2">(<span class="syntax-symbol"><span class="syntax-symbol">known-hosts</span> <span class="syntax-symbol">'</span><span class="syntax-paren3">(<span class="syntax-symbol"><span class="syntax-string">"localhost ecdsa-sha2-nistp256 AAAA…"</span>
                                       <span class="syntax-string">"127.0.0.1 ecdsa-sha2-nistp256 AAAA…"</span></span>)</span></span>)</span></span>)</span></span>)</span>

<span class="syntax-paren0">(<span class="syntax-symbol"><a class="syntax-symbol" href="Service-Reference.html#index-service">service</a> <a class="syntax-symbol" href="Web-Services.html#index-nginx_002dservice_002dtype">nginx-service-type</a>
         <span class="syntax-paren1">(<span class="syntax-symbol"><a class="syntax-symbol" href="Web-Services.html#index-nginx_002dconfiguration">nginx-configuration</a>
          <span class="syntax-paren2">(<span class="syntax-symbol"><span class="syntax-symbol">server-blocks</span>
           <span class="syntax-paren3">(<span class="syntax-symbol"><a class="syntax-symbol" href="https://www.gnu.org/software/guile/manual/html_node/List-Constructors.html#index-list-1">list</a>
            <span class="syntax-paren4">(<span class="syntax-symbol"><a class="syntax-symbol" href="Web-Services.html#index-nginx_002dserver_002dconfiguration">nginx-server-configuration</a>
             <span class="syntax-paren5">(<span class="syntax-symbol"><span class="syntax-symbol">inherit</span> <span class="syntax-symbol">%webssh-configuration-nginx</span></span>)</span>
             <span class="syntax-paren5">(<span class="syntax-symbol"><span class="syntax-symbol">server-name</span> <span class="syntax-symbol">'</span><span class="syntax-paren6">(<span class="syntax-symbol"><span class="syntax-string">"webssh.example.com"</span></span>)</span></span>)</span>
             <span class="syntax-paren5">(<span class="syntax-symbol"><a class="syntax-symbol" href="https://www.gnu.org/software/guile/manual/html_node/Network-Sockets-and-Communication.html#index-listen">listen</a> <span class="syntax-symbol">'</span><span class="syntax-paren6">(<span class="syntax-symbol"><span class="syntax-string">"443 ssl"</span></span>)</span></span>)</span>
             <span class="syntax-paren5">(<span class="syntax-symbol"><span class="syntax-symbol">ssl-certificate</span> <span class="syntax-paren6">(<span class="syntax-symbol"><span class="syntax-symbol">letsencrypt-certificate</span> <span class="syntax-string">"webssh.example.com"</span></span>)</span></span>)</span>
             <span class="syntax-paren5">(<span class="syntax-symbol"><span class="syntax-symbol">ssl-certificate-key</span> <span class="syntax-paren6">(<span class="syntax-symbol"><span class="syntax-symbol">letsencrypt-key</span> <span class="syntax-string">"webssh.example.com"</span></span>)</span></span>)</span>
             <span class="syntax-paren5">(<span class="syntax-symbol"><span class="syntax-symbol">locations</span>
              <span class="syntax-paren6">(<span class="syntax-symbol"><a class="syntax-symbol" href="https://www.gnu.org/software/guile/manual/html_node/Pairs.html#index-cons">cons</a> <span class="syntax-paren7">(<span class="syntax-symbol"><a class="syntax-symbol" href="Web-Services.html#index-nginx_002dlocation_002dconfiguration">nginx-location-configuration</a>
                     <span class="syntax-paren8">(<span class="syntax-symbol"><span class="syntax-symbol">uri</span> <span class="syntax-string">"/.well-known"</span></span>)</span>
                     <span class="syntax-paren8">(<span class="syntax-symbol"><span class="syntax-symbol">body</span> <span class="syntax-symbol">'</span><span class="syntax-paren9">(<span class="syntax-symbol"><span class="syntax-string">"root /var/www;"</span></span>)</span></span>)</span></span>)</span>
                    <span class="syntax-paren7">(<span class="syntax-symbol"><span class="syntax-symbol">nginx-server-configuration-locations</span> <span class="syntax-symbol">%webssh-configuration-nginx</span></span>)</span></span>)</span></span>)</span></span>)</span></span>)</span></span>)</span></span>)</span></span>)</span>
</pre></div>
</dd></dl>

<dl>
<dt id="index-webssh_002dconfiguration" class="symbol-definition"><span class="symbol-definition-category">Data Type: </span><span class="symbol-definition-prototype">webssh-configuration </span></dt>
<dd><p>Data type representing the configuration for <code>webssh-service</code>.
</p>
<dl compact="compact">
<dt><code>package</code> (default: <var>webssh</var>)</dt>
<dd><p><code>webssh</code> package to use.
</p>
</dd>
<dt><code>user-name</code> (default: <var>"webssh"</var>)</dt>
<dd><p>User name or user ID that file transfers to and from that module should take
place.
</p>
</dd>
<dt><code>group-name</code> (default: <var>"webssh"</var>)</dt>
<dd><p>Group name or group ID that will be used when accessing the module.
</p>
</dd>
<dt><code>address</code> (default: <var>#f</var>)</dt>
<dd><p>IP address on which <code>webssh</code> listens for incoming connections.
</p>
</dd>
<dt><code>port</code> (default: <var>8888</var>)</dt>
<dd><p>TCP port on which <code>webssh</code> listens for incoming connections.
</p>
</dd>
<dt><code>policy</code> (default: <var>#f</var>)</dt>
<dd><p>Connection policy.  <var>reject</var> policy requires to specify <var>known-hosts</var>.
</p>
</dd>
<dt><code>known-hosts</code> (default: <var>&rsquo;()</var>)</dt>
<dd><p>List of hosts which allowed for SSH connection from <code>webssh</code>.
</p>
</dd>
<dt><code>log-file</code> (default: <samp>"/var/log/webssh.log"</samp>)</dt>
<dd><p>Name of the file where <code>webssh</code> writes its log file.
</p>
</dd>
<dt><code>log-level</code> (default: <var>#f</var>)</dt>
<dd><p>Logging level.
</p>
</dd>
</dl>
</dd></dl>

<dl>
<dt id="index-_0025facebook_002dhost_002daliases" class="symbol-definition"><span class="symbol-definition-category">Scheme Variable: </span><span class="symbol-definition-prototype">%facebook-host-aliases </span></dt>
<dd><p>This variable contains a string for use in <samp>/etc/hosts</samp>
(see <a href="https://www.gnu.org/software/libc/manual/html_node/Host-Names.html#Host-Names">Host Names</a> in <cite>The GNU C Library Reference Manual</cite>).  Each
line contains a entry that maps a known server name of the Facebook
on-line service&mdash;e.g., <code>www.facebook.com</code>&mdash;to the local
host&mdash;<code>127.0.0.1</code> or its IPv6 equivalent, <code>::1</code>.
</p>
<p>This variable is typically used in the <code>hosts-file</code> field of an
<code>operating-system</code> declaration (see <a href="operating_002dsystem-Reference.html"><samp>/etc/hosts</samp></a>):
</p>
<div class="lisp">
<pre class="lisp"><span class="syntax-paren0">(<span class="syntax-symbol"><a class="syntax-symbol" href="https://www.gnu.org/software/guile/manual/html_node/Using-Guile-Modules.html#index-use_002dmodules">use-modules</a> <span class="syntax-paren1">(<span class="syntax-symbol"><span class="syntax-symbol">gnu</span></span>)</span> <span class="syntax-paren1">(<span class="syntax-symbol"><span class="syntax-symbol">guix</span></span>)</span></span>)</span>

<span class="syntax-paren0">(<span class="syntax-symbol"><a class="syntax-symbol" href="operating_002dsystem-Reference.html#index-operating_002dsystem-1">operating-system</a>
  <span class="syntax-paren1">(<span class="syntax-symbol"><span class="syntax-symbol">host-name</span> <span class="syntax-string">"mymachine"</span></span>)</span>
  <span class="syntax-comment">;; ...
</span>  <span class="syntax-paren1">(<span class="syntax-symbol"><span class="syntax-symbol">hosts-file</span>
    <span class="syntax-comment">;; Create a /etc/hosts file with aliases for "localhost"
</span>    <span class="syntax-comment">;; and "mymachine", as well as for Facebook servers.
</span>    <span class="syntax-paren2">(<span class="syntax-symbol"><a class="syntax-symbol" href="G_002dExpressions.html#index-plain_002dfile">plain-file</a> <span class="syntax-string">"hosts"</span>
                <span class="syntax-paren3">(<span class="syntax-symbol"><a class="syntax-symbol" href="https://www.gnu.org/software/guile/manual/html_node/Reversing-and-Appending-Strings.html#index-string_002dappend">string-append</a> <span class="syntax-paren4">(<span class="syntax-symbol"><span class="syntax-symbol">local-host-aliases</span> <span class="syntax-symbol">host-name</span></span>)</span>
                               <a class="syntax-symbol" href="Networking-Services.html#index-_0025facebook_002dhost_002daliases">%facebook-host-aliases</a></span>)</span></span>)</span></span>)</span></span>)</span>
</pre></div>

<p>This mechanism can prevent programs running locally, such as Web
browsers, from accessing Facebook.
</p></dd></dl>

<p>The <code>(gnu services avahi)</code> provides the following definition.
</p>
<dl>
<dt id="index-avahi_002dservice_002dtype" class="symbol-definition"><span class="symbol-definition-category">Scheme Variable: </span><span class="symbol-definition-prototype">avahi-service-type </span></dt>
<dd><p>This is the service that runs <code>avahi-daemon</code>, a system-wide
mDNS/DNS-SD responder that allows for service discovery and
&ldquo;zero-configuration&rdquo; host name lookups (see <a href="https://avahi.org/">https://avahi.org/</a>).
Its value must be an <code>avahi-configuration</code> record&mdash;see below.
</p>
<p>This service extends the name service cache daemon (nscd) so that it can
resolve <code>.local</code> host names using
<a href="https://0pointer.de/lennart/projects/nss-mdns/">nss-mdns</a>.  See <a href="Name-Service-Switch.html">Name Service Switch</a>, for information on host name resolution.
</p>
<p>Additionally, add the <var>avahi</var> package to the system profile so that
commands such as <code>avahi-browse</code> are directly usable.
</p></dd></dl>

<dl>
<dt id="index-avahi_002dconfiguration" class="symbol-definition"><span class="symbol-definition-category">Data Type: </span><span class="symbol-definition-prototype">avahi-configuration </span></dt>
<dd><p>Data type representation the configuration for Avahi.
</p>
<dl compact="compact">
<dt><code>host-name</code> (default: <code>#f</code>)</dt>
<dd><p>If different from <code>#f</code>, use that as the host name to
publish for this machine; otherwise, use the machine&rsquo;s actual host name.
</p>
</dd>
<dt><code>publish?</code> (default: <code>#t</code>)</dt>
<dd><p>When true, allow host names and services to be published (broadcast) over the
network.
</p>
</dd>
<dt><code>publish-workstation?</code> (default: <code>#t</code>)</dt>
<dd><p>When true, <code>avahi-daemon</code> publishes the machine&rsquo;s host name and IP
address via mDNS on the local network.  To view the host names published on
your local network, you can run:
</p>
<div class="example">
<pre class="example">avahi-browse _workstation._tcp
</pre></div>

</dd>
<dt><code>wide-area?</code> (default: <code>#f</code>)</dt>
<dd><p>When true, DNS-SD over unicast DNS is enabled.
</p>
</dd>
<dt><code>ipv4?</code> (default: <code>#t</code>)</dt>
<dt><code>ipv6?</code> (default: <code>#t</code>)</dt>
<dd><p>These fields determine whether to use IPv4/IPv6 sockets.
</p>
</dd>
<dt><code>domains-to-browse</code> (default: <code>'()</code>)</dt>
<dd><p>This is a list of domains to browse.
</p></dd>
</dl>
</dd></dl>

<dl>
<dt id="index-openvswitch_002dservice_002dtype" class="symbol-definition"><span class="symbol-definition-category">Scheme Variable: </span><span class="symbol-definition-prototype">openvswitch-service-type </span></dt>
<dd><p>This is the type of the <a href="https://www.openvswitch.org">Open vSwitch</a>
service, whose value should be an <code>openvswitch-configuration</code>
object.
</p></dd></dl>

<dl>
<dt id="index-openvswitch_002dconfiguration" class="symbol-definition"><span class="symbol-definition-category">Data Type: </span><span class="symbol-definition-prototype">openvswitch-configuration </span></dt>
<dd><p>Data type representing the configuration of Open vSwitch, a multilayer
virtual switch which is designed to enable massive network automation
through programmatic extension.
</p>
<dl compact="compact">
<dt><code>package</code> (default: <var>openvswitch</var>)</dt>
<dd><p>Package object of the Open vSwitch.
</p>
</dd>
</dl>
</dd></dl>

<dl>
<dt id="index-pagekite_002dservice_002dtype" class="symbol-definition"><span class="symbol-definition-category">Scheme Variable: </span><span class="symbol-definition-prototype">pagekite-service-type </span></dt>
<dd><p>This is the service type for the <a href="https://pagekite.net">PageKite</a> service,
a tunneling solution for making localhost servers publicly visible, even from
behind restrictive firewalls or NAT without forwarded ports.  The value for
this service type is a <code>pagekite-configuration</code> record.
</p>
<p>Here&rsquo;s an example exposing the local HTTP and SSH daemons:
</p>
<div class="lisp">
<pre class="lisp"><span class="syntax-paren0">(<span class="syntax-symbol"><a class="syntax-symbol" href="Service-Reference.html#index-service">service</a> <a class="syntax-symbol" href="Networking-Services.html#index-pagekite_002dservice_002dtype">pagekite-service-type</a>
         <span class="syntax-paren1">(<span class="syntax-symbol"><a class="syntax-symbol" href="Networking-Services.html#index-pagekite_002dconfiguration">pagekite-configuration</a>
           <span class="syntax-paren2">(<span class="syntax-symbol"><span class="syntax-symbol">kites</span> <span class="syntax-symbol">'</span><span class="syntax-paren3">(<span class="syntax-symbol"><span class="syntax-string">"http:@kitename:localhost:80:@kitesecret"</span>
                    <span class="syntax-string">"raw/22:@kitename:localhost:22:@kitesecret"</span></span>)</span></span>)</span>
           <span class="syntax-paren2">(<span class="syntax-symbol"><span class="syntax-symbol">extra-file</span> <span class="syntax-string">"/etc/pagekite.rc"</span></span>)</span></span>)</span></span>)</span>
</pre></div>
</dd></dl>

<dl>
<dt id="index-pagekite_002dconfiguration" class="symbol-definition"><span class="symbol-definition-category">Data Type: </span><span class="symbol-definition-prototype">pagekite-configuration </span></dt>
<dd><p>Data type representing the configuration of PageKite.
</p>
<dl compact="compact">
<dt><code>package</code> (default: <var>pagekite</var>)</dt>
<dd><p>Package object of PageKite.
</p>
</dd>
<dt><code>kitename</code> (default: <code>#f</code>)</dt>
<dd><p>PageKite name for authenticating to the frontend server.
</p>
</dd>
<dt><code>kitesecret</code> (default: <code>#f</code>)</dt>
<dd><p>Shared secret for authenticating to the frontend server.  You should probably
put this inside <code>extra-file</code> instead.
</p>
</dd>
<dt><code>frontend</code> (default: <code>#f</code>)</dt>
<dd><p>Connect to the named PageKite frontend server instead of the
<a href="https://pagekite.net">pagekite.net</a> service.
</p>
</dd>
<dt><code>kites</code> (default: <code>'("http:@kitename:localhost:80:@kitesecret")</code>)</dt>
<dd><p>List of service kites to use.  Exposes HTTP on port 80 by default.  The format
is <code>proto:kitename:host:port:secret</code>.
</p>
</dd>
<dt><code>extra-file</code> (default: <code>#f</code>)</dt>
<dd><p>Extra configuration file to read, which you are expected to create manually.
Use this to add additional options and manage shared secrets out-of-band.
</p>
</dd>
</dl>
</dd></dl>

<dl>
<dt id="index-yggdrasil_002dservice_002dtype" class="symbol-definition"><span class="symbol-definition-category">Scheme Variable: </span><span class="symbol-definition-prototype">yggdrasil-service-type </span></dt>
<dd><p>The service type for connecting to the <a href="https://yggdrasil-network.github.io/">Yggdrasil network</a>, an early-stage implementation of a fully end-to-end
encrypted IPv6 network.
</p>
<blockquote>
<p>Yggdrasil provides name-independent routing with cryptographically generated
addresses.  Static addressing means you can keep the same address as long as
you want, even if you move to a new location, or generate a new address (by
generating new keys) whenever you want.
<a href="https://yggdrasil-network.github.io/2018/07/28/addressing.html">https://yggdrasil-network.github.io/2018/07/28/addressing.html</a>
</p></blockquote>

<p>Pass it a value of <code>yggdrasil-configuration</code> to connect it to public
peers and/or local peers.
</p>
<p>Here is an example using public peers and a static address.  The static
signing and encryption keys are defined in <samp>/etc/yggdrasil-private.conf</samp>
(the default value for <code>config-file</code>).
</p>
<div class="lisp">
<pre class="lisp"><span class="syntax-comment">;; part of the operating-system declaration
</span><span class="syntax-paren0">(<span class="syntax-symbol"><a class="syntax-symbol" href="Service-Reference.html#index-service">service</a> <a class="syntax-symbol" href="Networking-Services.html#index-yggdrasil_002dservice_002dtype">yggdrasil-service-type</a>
              <span class="syntax-paren1">(<span class="syntax-symbol"><a class="syntax-symbol" href="Networking-Services.html#index-yggdrasil_002dconfiguration">yggdrasil-configuration</a>
               <span class="syntax-paren2">(<span class="syntax-symbol"><span class="syntax-symbol">autoconf?</span> <span class="syntax-symbol">#f</span></span>)</span> <span class="syntax-comment">;; use only the public peers
</span>               <span class="syntax-paren2">(<span class="syntax-symbol"><span class="syntax-symbol">json-config</span>
               <span class="syntax-comment">;; choose one from
</span>               <span class="syntax-comment">;; https://github.com/yggdrasil-network/public-peers
</span>                <span class="syntax-symbol">'</span><span class="syntax-paren3">(<span class="syntax-symbol"><span class="syntax-paren4">(<span class="syntax-symbol"><span class="syntax-symbol">peers</span> <span class="syntax-symbol">.</span> <span class="syntax-symbol">#</span><span class="syntax-paren5">(<span class="syntax-symbol"><span class="syntax-string">"tcp://1.2.3.4:1337"</span></span>)</span></span>)</span></span>)</span></span>)</span>
               <span class="syntax-comment">;; /etc/yggdrasil-private.conf is the default value for config-file
</span>               </span>)</span></span>)</span>
</pre></div>
<div class="example">
<pre class="example"># sample content for /etc/yggdrasil-private.conf
{
  # Your public key. Your peers may ask you for this to put
  # into their AllowedPublicKeys configuration.
  PublicKey: 64277...

  # Your private key. DO NOT share this with anyone!
  PrivateKey: 5c750...
}
</pre></div>
</dd></dl>

<dl>
<dt id="index-yggdrasil_002dconfiguration" class="symbol-definition"><span class="symbol-definition-category">Data Type: </span><span class="symbol-definition-prototype">yggdrasil-configuration </span></dt>
<dd><p>Data type representing the configuration of Yggdrasil.
</p>
<dl compact="compact">
<dt><code>package</code> (default: <code>yggdrasil</code>)</dt>
<dd><p>Package object of Yggdrasil.
</p>
</dd>
<dt><code>json-config</code> (default: <code>'()</code>)</dt>
<dd><p>Contents of <samp>/etc/yggdrasil.conf</samp>.  Will be merged with
<samp>/etc/yggdrasil-private.conf</samp>.  Note that these settings are stored in
the Guix store, which is readable to all users. <strong>Do not store your
private keys in it</strong>.  See the output of <code>yggdrasil -genconf</code> for a
quick overview of valid keys and their default values.
</p>
</dd>
<dt><code>autoconf?</code> (default: <code>#f</code>)</dt>
<dd><p>Whether to use automatic mode.  Enabling it makes Yggdrasil use adynamic IP
and peer with IPv6 neighbors.
</p>
</dd>
<dt><code>log-level</code> (default: <code>'info</code>)</dt>
<dd><p>How much detail to include in logs.  Use <code>'debug</code> for more detail.
</p>
</dd>
<dt><code>log-to</code> (default: <code>'stdout</code>)</dt>
<dd><p>Where to send logs.  By default, the service logs standard output to
<samp>/var/log/yggdrasil.log</samp>.  The alternative is <code>'syslog</code>, which
sends output to the running syslog service.
</p>
</dd>
<dt><code>config-file</code> (default: <code>"/etc/yggdrasil-private.conf"</code>)</dt>
<dd><p>What HJSON file to load sensitive data from.  This is where private keys
should be stored, which are necessary to specify if you don&rsquo;t want a
randomized address after each restart.  Use <code>#f</code> to disable.  Options
defined in this file take precedence over <code>json-config</code>.  Use the output
of <code>yggdrasil -genconf</code> as a starting point.  To configure a static
address, delete everything except these options:
</p>
<ul>
<li> <code>EncryptionPublicKey</code>
</li><li> <code>EncryptionPrivateKey</code>
</li><li> <code>SigningPublicKey</code>
</li><li> <code>SigningPrivateKey</code>
</li></ul>
</dd>
</dl>
</dd></dl>

<span id="index-IPFS"></span>
<dl>
<dt id="index-ipfs_002dservice_002dtype" class="symbol-definition"><span class="symbol-definition-category">Scheme Variable: </span><span class="symbol-definition-prototype">ipfs-service-type </span></dt>
<dd><p>The service type for connecting to the <a href="https://ipfs.io">IPFS network</a>,
a global, versioned, peer-to-peer file system. Pass it a
<code>ipfs-configuration</code> to change the ports used for the gateway and API.
</p>
<p>Here&rsquo;s an example configuration, using some non-standard ports:
</p>
<div class="lisp">
<pre class="lisp"><span class="syntax-paren0">(<span class="syntax-symbol"><a class="syntax-symbol" href="Service-Reference.html#index-service">service</a> <a class="syntax-symbol" href="Networking-Services.html#index-ipfs_002dservice_002dtype">ipfs-service-type</a>
         <span class="syntax-paren1">(<span class="syntax-symbol"><a class="syntax-symbol" href="Networking-Services.html#index-ipfs_002dconfiguration">ipfs-configuration</a>
          <span class="syntax-paren2">(<span class="syntax-symbol"><span class="syntax-symbol">gateway</span> <span class="syntax-string">"/ip4/127.0.0.1/tcp/8880"</span></span>)</span>
          <span class="syntax-paren2">(<span class="syntax-symbol"><span class="syntax-symbol">api</span> <span class="syntax-string">"/ip4/127.0.0.1/tcp/8881"</span></span>)</span></span>)</span></span>)</span>
</pre></div>
</dd></dl>

<dl>
<dt id="index-ipfs_002dconfiguration" class="symbol-definition"><span class="symbol-definition-category">Data Type: </span><span class="symbol-definition-prototype">ipfs-configuration </span></dt>
<dd><p>Data type representing the configuration of IPFS.
</p>
<dl compact="compact">
<dt><code>package</code> (default: <code>go-ipfs</code>)</dt>
<dd><p>Package object of IPFS.
</p>
</dd>
<dt><code>gateway</code> (default: <code>"/ip4/127.0.0.1/tcp/8082"</code>)</dt>
<dd><p>Address of the gateway, in ‘multiaddress’ format.
</p>
</dd>
<dt><code>api</code> (default: <code>"/ip4/127.0.0.1/tcp/5001"</code>)</dt>
<dd><p>Address of the API endpoint, in ‘multiaddress’ format.
</p></dd>
</dl>
</dd></dl>

<span id="index-keepalived"></span>
<dl>
<dt id="index-keepalived_002dservice_002dtype" class="symbol-definition"><span class="symbol-definition-category">Scheme Variable: </span><span class="symbol-definition-prototype">keepalived-service-type </span></dt>
<dd><p>This is the type for the <a href="https://www.keepalived.org/">Keepalived</a>
routing software, <code>keepalived</code>.  Its value must be an
<code>keepalived-configuration</code> record as in this example for master
machine:
</p>
<div class="lisp">
<pre class="lisp"><span class="syntax-paren0">(<span class="syntax-symbol"><a class="syntax-symbol" href="Service-Reference.html#index-service">service</a> <a class="syntax-symbol" href="Networking-Services.html#index-keepalived_002dservice_002dtype">keepalived-service-type</a>
         <span class="syntax-paren1">(<span class="syntax-symbol"><span class="syntax-symbol">keepalived-configuration</span>
           <span class="syntax-paren2">(<span class="syntax-symbol"><span class="syntax-symbol">config-file</span> <span class="syntax-paren3">(<span class="syntax-symbol"><a class="syntax-symbol" href="G_002dExpressions.html#index-local_002dfile">local-file</a> <span class="syntax-string">"keepalived-master.conf"</span></span>)</span></span>)</span></span>)</span></span>)</span>
</pre></div>

<p>where <samp>keepalived-master.conf</samp>:
</p>
<div class="example">
<pre class="example">vrrp_instance my-group {
  state MASTER
  interface enp9s0
  virtual_router_id 100
  priority 100
  unicast_peer { 10.0.0.2 }
  virtual_ipaddress {
    10.0.0.4/24
  }
}
</pre></div>

<p>and for backup machine:
</p>
<div class="lisp">
<pre class="lisp"><span class="syntax-paren0">(<span class="syntax-symbol"><a class="syntax-symbol" href="Service-Reference.html#index-service">service</a> <a class="syntax-symbol" href="Networking-Services.html#index-keepalived_002dservice_002dtype">keepalived-service-type</a>
         <span class="syntax-paren1">(<span class="syntax-symbol"><span class="syntax-symbol">keepalived-configuration</span>
          <span class="syntax-paren2">(<span class="syntax-symbol"><span class="syntax-symbol">config-file</span> <span class="syntax-paren3">(<span class="syntax-symbol"><a class="syntax-symbol" href="G_002dExpressions.html#index-local_002dfile">local-file</a> <span class="syntax-string">"keepalived-backup.conf"</span></span>)</span></span>)</span></span>)</span></span>)</span>
</pre></div>

<p>where <samp>keepalived-backup.conf</samp>:
</p>
<div class="example">
<pre class="example">vrrp_instance my-group {
  state BACKUP
  interface enp9s0
  virtual_router_id 100
  priority 99
  unicast_peer { 10.0.0.3 }
  virtual_ipaddress {
    10.0.0.4/24
  }
}
</pre></div>
</dd></dl>

<hr />
<div class="header">
<p>
Next: <a href="Unattended-Upgrades.html" accesskey="n" rel="next">Unattended Upgrades</a>, Previous: <a href="Networking-Setup.html" accesskey="p" rel="prev">Networking Setup</a>, Up: <a href="Services.html" accesskey="u" rel="up">Services</a> &nbsp; [<a href="index.html#SEC_Contents" title="Table of contents" rel="contents">Contents</a>][<a href="Concept-Index.html" title="Index" rel="index">Index</a>]</p>
</div>



</body>
</html>
