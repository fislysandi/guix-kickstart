<!DOCTYPE html PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN" "http://www.w3.org/TR/html4/loose.dtd">
<html>
<!--   Copyright (C) 2012-2022 Ludovic Courtès

Copyright (C) 2013, 2014, 2016 Andreas Enge

Copyright (C) 2013 Nikita Karetnikov

Copyright (C) 2014, 2015, 2016 Alex Kost

Copyright (C) 2015, 2016 Mathieu Lirzin

Copyright (C) 2014 Pierre-Antoine Rault

Copyright (C) 2015 Taylan Ulrich Bayırlı/Kammer

Copyright (C) 2015, 2016, 2017, 2019, 2020, 2021 Leo Famulari

Copyright (C) 2015, 2016, 2017, 2018, 2019, 2020, 2021, 2022 Ricardo Wurmus

Copyright (C) 2016 Ben Woodcroft

Copyright (C) 2016, 2017, 2018, 2021 Chris Marusich

Copyright (C) 2016, 2017, 2018, 2019, 2020, 2021, 2022 Efraim Flashner

Copyright (C) 2016 John Darrington

Copyright (C) 2016, 2017 Nikita Gillmann

Copyright (C) 2016, 2017, 2018, 2019, 2020 Jan Nieuwenhuizen

Copyright (C) 2016, 2017, 2018, 2019, 2020, 2021 Julien Lepiller

Copyright (C) 2016 Alex ter Weele

Copyright (C) 2016, 2017, 2018, 2019, 2020, 2021 Christopher Baines

Copyright (C) 2017, 2018, 2019 Clément Lassieur

Copyright (C) 2017, 2018, 2020, 2021, 2022 Mathieu Othacehe

Copyright (C) 2017 Federico Beffa

Copyright (C) 2017, 2018 Carlo Zancanaro

Copyright (C) 2017 Thomas Danckaert

Copyright (C) 2017 humanitiesNerd

Copyright (C) 2017, 2021 Christine Lemmer-Webber

Copyright (C) 2017, 2018, 2019, 2020, 2021, 2022 Marius Bakke

Copyright (C) 2017, 2019, 2020, 2022 Hartmut Goebel

Copyright (C) 2017, 2019, 2020, 2021, 2022 Maxim Cournoyer

Copyright (C) 2017–2022 Tobias Geerinckx-Rice

Copyright (C) 2017 George Clemmer

Copyright (C) 2017 Andy Wingo

Copyright (C) 2017, 2018, 2019, 2020 Arun Isaac

Copyright (C) 2017 nee

Copyright (C) 2018 Rutger Helling

Copyright (C) 2018, 2021 Oleg Pykhalov

Copyright (C) 2018 Mike Gerwitz

Copyright (C) 2018 Pierre-Antoine Rouby

Copyright (C) 2018, 2019 Gábor Boskovits

Copyright (C) 2018, 2019, 2020, 2022 Florian Pelz

Copyright (C) 2018 Laura Lazzati

Copyright (C) 2018 Alex Vong

Copyright (C) 2019 Josh Holland

Copyright (C) 2019, 2020 Diego Nicola Barbato

Copyright (C) 2019 Ivan Petkov

Copyright (C) 2019 Jakob L. Kreuze

Copyright (C) 2019 Kyle Andrews

Copyright (C) 2019 Alex Griffin

Copyright (C) 2019, 2020, 2021, 2022 Guillaume Le Vaillant

Copyright (C) 2020 Liliana Marie Prikler

Copyright (C) 2019, 2020, 2021, 2022 Simon Tournier

Copyright (C) 2020 Wiktor Żelazny

Copyright (C) 2020 Damien Cassou

Copyright (C) 2020 Jakub Kądziołka

Copyright (C) 2020 Jack Hill

Copyright (C) 2020 Naga Malleswari

Copyright (C) 2020, 2021 Brice Waegeneire

Copyright (C) 2020 R Veera Kumar

Copyright (C) 2020, 2021 Pierre Langlois

Copyright (C) 2020 pinoaffe

Copyright (C) 2020 André Batista

Copyright (C) 2020, 2021 Alexandru-Sergiu Marton

Copyright (C) 2020 raingloom

Copyright (C) 2020 Daniel Brooks

Copyright (C) 2020 John Soo

Copyright (C) 2020 Jonathan Brielmaier

Copyright (C) 2020 Edgar Vincent

Copyright (C) 2021, 2022 Maxime Devos

Copyright (C) 2021 B. Wilson

Copyright (C) 2021 Xinglu Chen

Copyright (C) 2021 Raghav Gururajan

Copyright (C) 2021 Domagoj Stolfa

Copyright (C) 2021 Hui Lu

Copyright (C) 2021 pukkamustard

Copyright (C) 2021 Alice Brenon

Copyright (C) 2021, 2022 Josselin Poiret

Copyright (C) 2021 muradm

Copyright (C) 2021, 2022 Andrew Tropin

Copyright (C) 2021 Sarah Morgensen

Copyright (C) 2022 Remco van 't Veer

Copyright (C) 2022 Aleksandr Vityazev

Copyright (C) 2022 Philip McGrath

Copyright (C) 2022 Karl Hallsby

Copyright (C) 2022 Justin Veilleux

Copyright (C) 2022 Reily Siegel

Copyright (C) 2022 Simon Streit

Copyright (C) 2022 (

Copyright (C) 2022 John Kehayias


Permission is granted to copy, distribute and/or modify this document
under the terms of the GNU Free Documentation License, Version 1.3 or
any later version published by the Free Software Foundation; with no
Invariant Sections, no Front-Cover Texts, and no Back-Cover Texts.  A
copy of the license is included in the section entitled "GNU Free
Documentation License".   -->
<!--   Created by GNU Texinfo 6.7, http://www.gnu.org/software/texinfo/   -->
<head>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<title>Invoking guix shell (GNU Guix Reference Manual)</title>

<meta name="description" content="Invoking guix shell (GNU Guix Reference Manual)" />
<meta name="keywords" content="Invoking guix shell (GNU Guix Reference Manual)" />
<meta name="resource-type" content="document" />
<meta name="distribution" content="global" />
<meta name="Generator" content="makeinfo" />
<link href="index.html" rel="start" title="Top" />
<link href="Concept-Index.html" rel="index" title="Concept Index" />
<link href="index.html#SEC_Contents" rel="contents" title="Table of Contents" />
<link href="Development.html" rel="up" title="Development" />
<link href="Invoking-guix-environment.html" rel="next" title="Invoking guix environment" />
<link href="Development.html" rel="prev" title="Development" />
<style type="text/css">
&amp;lt;!--
a.summary-letter {text-decoration: none}
blockquote.indentedblock {margin-right: 0em}
div.display {margin-left: 3.2em}
div.example {margin-left: 3.2em}
div.lisp {margin-left: 3.2em}
kbd {font-style: oblique}
pre.display {font-family: inherit}
pre.format {font-family: inherit}
pre.menu-comment {font-family: serif}
pre.menu-preformatted {font-family: serif}
span.nolinebreak {white-space: nowrap}
span.roman {font-family: initial; font-weight: normal}
span.sansserif {font-family: sans-serif; font-weight: normal}
ul.no-bullet {list-style: none}
--&amp;gt;
</style>
<link rel="stylesheet" type="text/css" href="https://www.gnu.org/software/gnulib/manual.css" />

<meta name="viewport" content="width=device-width, initial-scale=1" />
<link rel="stylesheet" type="text/css" href="../../../static/base/css/manual.css" /><link rel="stylesheet" type="text/css" href="../../../static/base/css/code.css" /></head>

<body lang="en"><header class="navbar"><h1><a class="branding" href="https://guix.gnu.org/manual/en/"></a></h1><nav class="navbar-menu"><input class="navbar-menu-hidden-input" type="radio" name="dropdown" id="all-dropdowns-hidden" /><ul><li class="navbar-menu-item dropdown dropdown-btn"><input class="navbar-menu-hidden-input" type="radio" name="dropdown" id="visible-dropdown" /><label for="visible-dropdown"><img alt="Language" src="../../../static/base/img/language-picker.svg" /></label><label for="all-dropdowns-hidden"><img alt="Language" src="../../../static/base/img/language-picker.svg" /></label><div class="navbar-submenu" id="navbar-submenu"><div class="navbar-submenu-triangle"> </div><ul><li><a class="navbar-menu-item" href="https://guix.gnu.org/manual/de/html_node">Deutsch</a></li><li><a class="navbar-menu-item" href="https://guix.gnu.org/manual/en/html_node">English</a></li><li><a class="navbar-menu-item" href="https://guix.gnu.org/manual/es/html_node">Español</a></li><li><a class="navbar-menu-item" href="https://guix.gnu.org/manual/fr/html_node">français</a></li><li><a class="navbar-menu-item" href="https://guix.gnu.org/manual/pt-br/html_node">Português</a></li><li><a class="navbar-menu-item" href="https://guix.gnu.org/manual/ru/html_node">русский</a></li><li><a class="navbar-menu-item" href="https://guix.gnu.org/manual/zh-cn/html_node">中文</a></li><li><a class="navbar-menu-item" href="https://translate.fedoraproject.org/projects/guix/documentation-manual/">⊕</a></li></ul></div></li></ul></nav><a class="navbar-menu-btn" href="https://guix.gnu.org/manual/"></a></header>
<span id="Invoking-guix-shell"></span><div class="header">
<p>
Next: <a href="Invoking-guix-environment.html" accesskey="n" rel="next">Invoking guix environment</a>, Up: <a href="Development.html" accesskey="u" rel="up">Development</a> &nbsp; [<a href="index.html#SEC_Contents" title="Table of contents" rel="contents">Contents</a>][<a href="Concept-Index.html" title="Index" rel="index">Index</a>]</p>
</div>
<hr />
<span id="Invoking-guix-shell-1"></span><h3 class="section">8.1 Invoking <code>guix shell</code></h3>

<span id="index-reproducible-build-environments"></span>
<span id="index-development-environments"></span>
<span id="index-guix-environment"></span>
<span id="index-guix-shell"></span>
<span id="index-environment_002c-package-build-environment"></span>
<p>The purpose of <code>guix shell</code> is to make it easy to create one-off
software environments, without changing one&rsquo;s profile.  It is typically
used to create development environments; it is also a convenient way to
run applications without &ldquo;polluting&rdquo; your profile.
</p>
<blockquote>
<p><b>Note:</b> The <code>guix shell</code> command was recently introduced to supersede
<code>guix environment</code> (see <a href="Invoking-guix-environment.html">Invoking guix environment</a>).  If you
are familiar with <code>guix environment</code>, you will notice that it is
similar but also&mdash;we hope!&mdash;more convenient.
</p></blockquote>

<p>The general syntax is:
</p>
<div class="example">
<pre class="example">guix shell [<var>options</var>] [<var>package</var>&hellip;]
</pre></div>

<p>The following example creates an environment containing Python and NumPy,
building or downloading any missing package, and runs the
<code>python3</code> command in that environment:
</p>
<div class="example">
<pre class="example">guix shell python python-numpy -- python3
</pre></div>

<p>Development environments can be created as in the example below, which
spawns an interactive shell containing all the dependencies and
environment variables needed to work on Inkscape:
</p>
<div class="example">
<pre class="example">guix shell --development inkscape
</pre></div>

<p>Exiting the shell places the user back in the original environment
before <code>guix shell</code> was invoked.  The next garbage collection
(see <a href="Invoking-guix-gc.html">Invoking guix gc</a>) may clean up packages that were installed in
the environment and that are no longer used outside of it.
</p>
<p>As an added convenience, <code>guix shell</code> will try to do what you
mean when it is invoked interactively without any other arguments
as in:
</p>
<div class="example">
<pre class="example">guix shell
</pre></div>

<p>If it finds a <samp>manifest.scm</samp> in the current working directory or
any of its parents, it uses this manifest as though it was given via <code>--manifest</code>.
Likewise, if it finds a <samp>guix.scm</samp> in the same directories, it uses
it to build a development profile as though both <code>--development</code>
and <code>--file</code> were present.
In either case, the file will only be loaded if the directory it
resides in is listed in
<samp>~/.config/guix/shell-authorized-directories</samp>.
This provides an easy way to define, share, and enter development
environments.
</p>
<p>By default, the shell session or command runs in an <em>augmented</em>
environment, where the new packages are added to search path environment
variables such as <code>PATH</code>.  You can, instead, choose to create an
<em>isolated</em> environment containing nothing but the packages you
asked for.  Passing the <samp>--pure</samp> option clears environment
variable definitions found in the parent environment<a id="DOCF14" href="Invoking-guix-shell.html#FOOT14"><sup>14</sup></a>; passing <samp>--container</samp> goes one step further by
spawning a <em>container</em> isolated from the rest of the system:
</p>
<div class="example">
<pre class="example">guix shell --container emacs gcc-toolchain
</pre></div>

<p>The command above spawns an interactive shell in a container where
nothing but <code>emacs</code>, <code>gcc-toolchain</code>, and their dependencies
is available.  The container lacks network access and shares no files
other than the current working directory with the surrounding
environment.  This is useful to prevent access to system-wide resources
such as <samp>/usr/bin</samp> on foreign distros.
</p>
<p>This <samp>--container</samp> option can also prove useful if you wish to
run a security-sensitive application, such as a web browser, in an
isolated environment.  For example, the command below launches
Ungoogled-Chromium in an isolated environment, this time sharing network
access with the host and preserving its <code>DISPLAY</code> environment
variable, but without even sharing the current directory:
</p>
<div class="example">
<pre class="example">guix shell --container --network --no-cwd ungoogled-chromium \
  --preserve='^DISPLAY$' -- chromium
</pre></div>

<span id="index-GUIX_005fENVIRONMENT"></span>
<p><code>guix shell</code> defines the <code>GUIX_ENVIRONMENT</code>
variable in the shell it spawns; its value is the file name of the
profile of this environment.  This allows users to, say, define a
specific prompt for development environments in their <samp>.bashrc</samp>
(see <a href="https://www.gnu.org/software/bash/manual/html_node/Bash-Startup-Files.html#Bash-Startup-Files">Bash Startup Files</a> in <cite>The GNU Bash Reference Manual</cite>):
</p>
<div class="example">
<pre class="example">if [ -n "$GUIX_ENVIRONMENT" ]
then
    export PS1="\u@\h \w [dev]\$ "
fi
</pre></div>

<p>... or to browse the profile:
</p>
<div class="example">
<pre class="example">$ ls "$GUIX_ENVIRONMENT/bin"
</pre></div>

<p>The available options are summarized below.
</p>
<dl compact="compact">
<dt><code>--check</code></dt>
<dd><p>Set up the environment and check whether the shell would clobber
environment variables.  It&rsquo;s a good idea to use this option the first
time you run <code>guix shell</code> for an interactive session to make
sure your setup is correct.
</p>
<p>For example, if the shell modifies the <code>PATH</code> environment variable,
report it since you would get a different environment than what you
asked for.
</p>
<p>Such problems usually indicate that the shell startup files are
unexpectedly modifying those environment variables.  For example, if you
are using Bash, make sure that environment variables are set or modified
in <samp>~/.bash_profile</samp> and <em>not</em> in <samp>~/.bashrc</samp>&mdash;the
former is sourced only by log-in shells.  See <a href="https://www.gnu.org/software/bash/manual/html_node/Bash-Startup-Files.html#Bash-Startup-Files">Bash Startup Files</a> in <cite>The GNU Bash Reference Manual</cite>, for details on Bash start-up
files.
</p>
<span id="shell_002ddevelopment_002doption"></span></dd>
<dt><code>--development</code></dt>
<dt><code>-D</code></dt>
<dd><p>Cause <code>guix shell</code> to include in the environment the
dependencies of the following package rather than the package itself.
This can be combined with other packages.  For instance, the command
below starts an interactive shell containing the build-time dependencies
of GNU&nbsp;Guile, plus Autoconf, Automake, and Libtool:
</p>
<div class="example">
<pre class="example">guix shell -D guile autoconf automake libtool
</pre></div>

</dd>
<dt><code>--expression=<var>expr</var></code></dt>
<dt><code>-e <var>expr</var></code></dt>
<dd><p>Create an environment for the package or list of packages that
<var>expr</var> evaluates to.
</p>
<p>For example, running:
</p>
<div class="example">
<pre class="example">guix shell -D -e '(@ (gnu packages maths) petsc-openmpi)'
</pre></div>

<p>starts a shell with the environment for this specific variant of the
PETSc package.
</p>
<p>Running:
</p>
<div class="example">
<pre class="example">guix shell -e '(@ (gnu) %base-packages)'
</pre></div>

<p>starts a shell with all the base system packages available.
</p>
<p>The above commands only use the default output of the given packages.
To select other outputs, two element tuples can be specified:
</p>
<div class="example">
<pre class="example">guix shell -e '(list (@ (gnu packages bash) bash) "include")'
</pre></div>

<p>See <a href="Writing-Manifests.html#package_002ddevelopment_002dmanifest"><code>package-&gt;development-manifest</code></a>, for information on how to write a
manifest for the development environment of a package.
</p>
</dd>
<dt><code>--file=<var>file</var></code></dt>
<dt><code>-f <var>file</var></code></dt>
<dd><p>Create an environment containing the package or list of packages that
the code within <var>file</var> evaluates to.
</p>
<p>As an example, <var>file</var> might contain a definition like this
(see <a href="Defining-Packages.html">Defining Packages</a>):
</p>
<div class="lisp">
<pre class="verbatim">(use-modules (guix)
             (gnu packages gdb)
             (gnu packages autotools)
             (gnu packages texinfo))

;; Augment the package definition of GDB with the build tools
;; needed when developing GDB (and which are not needed when
;; simply installing it.)
(package
  (inherit gdb)
  (native-inputs (modify-inputs (package-native-inputs gdb)
                   (prepend autoconf-2.64 automake texinfo))))
</pre></div>

<p>With the file above, you can enter a development environment for GDB by
running:
</p>
<div class="example">
<pre class="example">guix shell -D -f gdb-devel.scm
</pre></div>

<span id="shell_002dmanifest"></span></dd>
<dt><code>--manifest=<var>file</var></code></dt>
<dt><code>-m <var>file</var></code></dt>
<dd><p>Create an environment for the packages contained in the manifest object
returned by the Scheme code in <var>file</var>.  This option can be repeated
several times, in which case the manifests are concatenated.
</p>
<p>This is similar to the same-named option in <code>guix package</code>
(see <a href="Invoking-guix-package.html#profile_002dmanifest"><samp>--manifest</samp></a>) and uses the same
manifest files.
</p>
<p>See <a href="Writing-Manifests.html">Writing Manifests</a>, for information on how to write a manifest.
See <samp>--export-manifest</samp> below on how to obtain a first manifest.
</p>
<span id="index-manifest_002c-exporting-1"></span>
<span id="shell_002dexport_002dmanifest"></span></dd>
<dt><code>--export-manifest</code></dt>
<dd><p>Write to standard output a manifest suitable for <samp>--manifest</samp>
corresponding to given command-line options.
</p>
<p>This is a way to &ldquo;convert&rdquo; command-line arguments into a manifest.
For example, imagine you are tired of typing long lines and would like
to get a manifest equivalent to this command line:
</p>
<div class="example">
<pre class="example">guix shell -D guile git emacs emacs-geiser emacs-geiser-guile
</pre></div>

<p>Just add <samp>--export-manifest</samp> to the command line above:
</p>
<div class="example">
<pre class="example">guix shell --export-manifest \
  -D guile git emacs emacs-geiser emacs-geiser-guile
</pre></div>

<p>... and you get a manifest along these lines:
</p>
<div class="lisp">
<pre class="lisp"><span class="syntax-paren0">(<span class="syntax-symbol"><a class="syntax-symbol" href="Writing-Manifests.html#index-concatenate_002dmanifests">concatenate-manifests</a>
  <span class="syntax-paren1">(<span class="syntax-symbol"><a class="syntax-symbol" href="https://www.gnu.org/software/guile/manual/html_node/List-Constructors.html#index-list-1">list</a> <span class="syntax-paren2">(<span class="syntax-symbol"><a class="syntax-symbol" href="Writing-Manifests.html#index-specifications_002d_003emanifest">specifications-&gt;manifest</a>
          <span class="syntax-paren3">(<span class="syntax-symbol"><a class="syntax-symbol" href="https://www.gnu.org/software/guile/manual/html_node/List-Constructors.html#index-list-1">list</a> <span class="syntax-string">"git"</span>
                <span class="syntax-string">"emacs"</span>
                <span class="syntax-string">"emacs-geiser"</span>
                <span class="syntax-string">"emacs-geiser-guile"</span></span>)</span></span>)</span>
        <span class="syntax-paren2">(<span class="syntax-symbol"><a class="syntax-symbol" href="Writing-Manifests.html#index-package_002d_003edevelopment_002dmanifest">package-&gt;development-manifest</a>
          <span class="syntax-paren3">(<span class="syntax-symbol"><span class="syntax-symbol">specification-&gt;package</span> <span class="syntax-string">"guile"</span></span>)</span></span>)</span></span>)</span></span>)</span>
</pre></div>

<p>You can store it into a file, say <samp>manifest.scm</samp>, and from there
pass it to <code>guix shell</code> or indeed pretty much any <code>guix</code>
command:
</p>
<div class="example">
<pre class="example">guix shell -m manifest.scm
</pre></div>

<p>Voilà, you&rsquo;ve converted a long command line into a manifest!  That
conversion process honors package transformation options (see <a href="Package-Transformation-Options.html">Package Transformation Options</a>) so it should be lossless.
</p>
</dd>
<dt><code>--profile=<var>profile</var></code></dt>
<dt><code>-p <var>profile</var></code></dt>
<dd><p>Create an environment containing the packages installed in <var>profile</var>. 
Use <code>guix package</code> (see <a href="Invoking-guix-package.html">Invoking guix package</a>) to create
and manage profiles.
</p>
</dd>
<dt><code>--pure</code></dt>
<dd><p>Unset existing environment variables when building the new environment, except
those specified with <samp>--preserve</samp> (see below).  This has the effect of
creating an environment in which search paths only contain package inputs.
</p>
</dd>
<dt><code>--preserve=<var>regexp</var></code></dt>
<dt><code>-E <var>regexp</var></code></dt>
<dd><p>When used alongside <samp>--pure</samp>, preserve the environment variables
matching <var>regexp</var>&mdash;in other words, put them on a &ldquo;white list&rdquo; of
environment variables that must be preserved.  This option can be repeated
several times.
</p>
<div class="example">
<pre class="example">guix shell --pure --preserve=^SLURM openmpi &hellip; \
  -- mpirun &hellip;
</pre></div>

<p>This example runs <code>mpirun</code> in a context where the only environment
variables defined are <code>PATH</code>, environment variables whose name starts
with &lsquo;<samp>SLURM</samp>&rsquo;, as well as the usual &ldquo;precious&rdquo; variables (<code>HOME</code>,
<code>USER</code>, etc.).
</p>
</dd>
<dt><code>--search-paths</code></dt>
<dd><p>Display the environment variable definitions that make up the
environment.
</p>
</dd>
<dt><code>--system=<var>system</var></code></dt>
<dt><code>-s <var>system</var></code></dt>
<dd><p>Attempt to build for <var>system</var>&mdash;e.g., <code>i686-linux</code>.
</p>
</dd>
<dt><code>--container</code></dt>
<dt><code>-C</code></dt>
<dd><span id="index-container"></span>
<p>Run <var>command</var> within an isolated container.  The current working
directory outside the container is mapped inside the container.
Additionally, unless overridden with <samp>--user</samp>, a dummy home
directory is created that matches the current user&rsquo;s home directory, and
<samp>/etc/passwd</samp> is configured accordingly.
</p>
<p>The spawned process runs as the current user outside the container.  Inside
the container, it has the same UID and GID as the current user, unless
<samp>--user</samp> is passed (see below).
</p>
</dd>
<dt><code>--network</code></dt>
<dt><code>-N</code></dt>
<dd><p>For containers, share the network namespace with the host system.
Containers created without this flag only have access to the loopback
device.
</p>
</dd>
<dt><code>--link-profile</code></dt>
<dt><code>-P</code></dt>
<dd><p>For containers, link the environment profile to <samp>~/.guix-profile</samp>
within the container and set <code>GUIX_ENVIRONMENT</code> to that.
This is equivalent to making <samp>~/.guix-profile</samp> a symlink to the
actual profile within the container.
Linking will fail and abort the environment if the directory already
exists, which will certainly be the case if <code>guix shell</code>
was invoked in the user&rsquo;s home directory.
</p>
<p>Certain packages are configured to look in <samp>~/.guix-profile</samp> for
configuration files and data;<a id="DOCF15" href="Invoking-guix-shell.html#FOOT15"><sup>15</sup></a>  <samp>--link-profile</samp> allows these programs to
behave as expected within the environment.
</p>
</dd>
<dt><code>--user=<var>user</var></code></dt>
<dt><code>-u <var>user</var></code></dt>
<dd><p>For containers, use the username <var>user</var> in place of the current
user.  The generated <samp>/etc/passwd</samp> entry within the container will
contain the name <var>user</var>, the home directory will be
<samp>/home/<var>user</var></samp>, and no user GECOS data will be copied.  Furthermore,
the UID and GID inside the container are 1000.  <var>user</var>
need not exist on the system.
</p>
<p>Additionally, any shared or exposed path (see <samp>--share</samp> and
<samp>--expose</samp> respectively) whose target is within the current user&rsquo;s
home directory will be remapped relative to <samp>/home/USER</samp>; this
includes the automatic mapping of the current working directory.
</p>
<div class="example">
<pre class="example"># will expose paths as /home/foo/wd, /home/foo/test, and /home/foo/target
cd $HOME/wd
guix shell --container --user=foo \
     --expose=$HOME/test \
     --expose=/tmp/target=$HOME/target
</pre></div>

<p>While this will limit the leaking of user identity through home paths
and each of the user fields, this is only one useful component of a
broader privacy/anonymity solution&mdash;not one in and of itself.
</p>
</dd>
<dt><code>--no-cwd</code></dt>
<dd><p>For containers, the default behavior is to share the current working
directory with the isolated container and immediately change to that
directory within the container.  If this is undesirable,
<samp>--no-cwd</samp> will cause the current working directory to <em>not</em>
be automatically shared and will change to the user&rsquo;s home directory
within the container instead.  See also <samp>--user</samp>.
</p>
</dd>
<dt><code>--expose=<var>source</var>[=<var>target</var>]</code></dt>
<dt><code>--share=<var>source</var>[=<var>target</var>]</code></dt>
<dd><p>For containers, <samp>--expose</samp> (resp. <samp>--share</samp>) exposes the
file system <var>source</var> from the host system as the read-only
(resp. writable) file system <var>target</var> within the container.  If
<var>target</var> is not specified, <var>source</var> is used as the target mount
point in the container.
</p>
<p>The example below spawns a Guile REPL in a container in which the user&rsquo;s
home directory is accessible read-only via the <samp>/exchange</samp>
directory:
</p>
<div class="example">
<pre class="example">guix shell --container --expose=$HOME=/exchange guile -- guile
</pre></div>

<span id="index-symbolic-links_002c-guix-shell"></span>
</dd>
<dt><code>--symlink=<var>spec</var></code></dt>
<dt><code>-S <var>spec</var></code></dt>
<dd><p>For containers, create the symbolic links specified by <var>spec</var>, as
documented in <a href="Invoking-guix-pack.html#pack_002dsymlink_002doption">pack-symlink-option</a>.
</p>
<span id="index-file-system-hierarchy-standard-_0028FHS_0029"></span>
<span id="index-FHS-_0028file-system-hierarchy-standard_0029"></span>
</dd>
<dt><code>--emulate-fhs</code></dt>
<dt><code>-F</code></dt>
<dd><p>When used with <samp>--container</samp>, emulate a
<a href="https://refspecs.linuxfoundation.org/fhs.shtml">Filesystem
Hierarchy Standard (FHS)</a> configuration within the container, providing
<samp>/bin</samp>, <samp>/lib</samp>, and other directories and files specified by
the FHS.
</p>
<p>As Guix deviates from the FHS specification, this
option sets up the container to more closely mimic that of other
GNU/Linux distributions.  This is useful for reproducing other
development environments, testing, and using programs which expect the
FHS specification to be followed.  With this option, the container will
include a version of glibc that will read
<samp>/etc/ld.so.cache</samp> within the container for the shared library
cache (contrary to glibc in regular Guix usage) and set up the
expected FHS directories: <samp>/bin</samp>, <samp>/etc</samp>, <samp>/lib</samp>, and
<samp>/usr</samp> from the container&rsquo;s profile.
</p>
</dd>
<dt><code>--rebuild-cache</code></dt>
<dd><span id="index-caching_002c-of-profiles"></span>
<span id="index-caching_002c-in-guix-shell"></span>
<p>In most cases, <code>guix shell</code> caches the environment so that
subsequent uses are instantaneous.  Least-recently used cache entries
are periodically removed.  The cache is also invalidated, when using
<samp>--file</samp> or <samp>--manifest</samp>, anytime the corresponding file
is modified.
</p>
<p>The <samp>--rebuild-cache</samp> forces the cached environment to be
refreshed.  This is useful when using <samp>--file</samp> or
<samp>--manifest</samp> and the <code>guix.scm</code> or <code>manifest.scm</code>
file has external dependencies, or if its behavior depends, say, on
environment variables.
</p>
</dd>
<dt><code>--root=<var>file</var></code></dt>
<dt><code>-r <var>file</var></code></dt>
<dd><span id="index-persistent-environment"></span>
<span id="index-garbage-collector-root_002c-for-environments"></span>
<p>Make <var>file</var> a symlink to the profile for this environment, and
register it as a garbage collector root.
</p>
<p>This is useful if you want to protect your environment from garbage
collection, to make it &ldquo;persistent&rdquo;.
</p>
<p>When this option is omitted, <code>guix shell</code> caches profiles so
that subsequent uses of the same environment are instantaneous&mdash;this is
comparable to using <samp>--root</samp> except that <code>guix shell</code>
takes care of periodically removing the least-recently used garbage
collector roots.
</p>
<p>In some cases, <code>guix shell</code> does not cache profiles&mdash;e.g., if
transformation options such as <samp>--with-latest</samp> are used.  In
those cases, the environment is protected from garbage collection only
for the duration of the <code>guix shell</code> session.  This means that
next time you recreate the same environment, you could have to rebuild
or re-download packages.
</p>
<p>See <a href="Invoking-guix-gc.html">Invoking guix gc</a>, for more on GC roots.
</p></dd>
</dl>

<p><code>guix shell</code> also supports all of the common build options that
<code>guix build</code> supports (see <a href="Common-Build-Options.html">Common Build Options</a>) as well as
package transformation options (see <a href="Package-Transformation-Options.html">Package Transformation Options</a>).
</p>
<div class="footnote">
<hr />
<h4 class="footnotes-heading">Footnotes</h4>

<h5><a id="FOOT14" href="Invoking-guix-shell.html#DOCF14">(14)</a>
<p>Be sure to
use the <samp>--check</samp> option the first time you use <code>guix
shell</code> interactively to make sure the shell does not undo the effect of
<samp>--pure</samp>.</p>
<h5><a id="FOOT15" href="Invoking-guix-shell.html#DOCF15">(15)</a>
<p>For example, the
<code>fontconfig</code> package inspects <samp>~/.guix-profile/share/fonts</samp>
for additional fonts.</p>
</h5></h5></div>
<hr />
<div class="header">
<p>
Next: <a href="Invoking-guix-environment.html" accesskey="n" rel="next">Invoking guix environment</a>, Up: <a href="Development.html" accesskey="u" rel="up">Development</a> &nbsp; [<a href="index.html#SEC_Contents" title="Table of contents" rel="contents">Contents</a>][<a href="Concept-Index.html" title="Index" rel="index">Index</a>]</p>
</div>



</body>
</html>
