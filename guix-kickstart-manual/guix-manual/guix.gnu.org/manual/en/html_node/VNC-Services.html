<!DOCTYPE html PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN" "http://www.w3.org/TR/html4/loose.dtd">
<html>
<!--   Copyright (C) 2012-2022 Ludovic Courtès

Copyright (C) 2013, 2014, 2016 Andreas Enge

Copyright (C) 2013 Nikita Karetnikov

Copyright (C) 2014, 2015, 2016 Alex Kost

Copyright (C) 2015, 2016 Mathieu Lirzin

Copyright (C) 2014 Pierre-Antoine Rault

Copyright (C) 2015 Taylan Ulrich Bayırlı/Kammer

Copyright (C) 2015, 2016, 2017, 2019, 2020, 2021 Leo Famulari

Copyright (C) 2015, 2016, 2017, 2018, 2019, 2020, 2021, 2022 Ricardo Wurmus

Copyright (C) 2016 Ben Woodcroft

Copyright (C) 2016, 2017, 2018, 2021 Chris Marusich

Copyright (C) 2016, 2017, 2018, 2019, 2020, 2021, 2022 Efraim Flashner

Copyright (C) 2016 John Darrington

Copyright (C) 2016, 2017 Nikita Gillmann

Copyright (C) 2016, 2017, 2018, 2019, 2020 Jan Nieuwenhuizen

Copyright (C) 2016, 2017, 2018, 2019, 2020, 2021 Julien Lepiller

Copyright (C) 2016 Alex ter Weele

Copyright (C) 2016, 2017, 2018, 2019, 2020, 2021 Christopher Baines

Copyright (C) 2017, 2018, 2019 Clément Lassieur

Copyright (C) 2017, 2018, 2020, 2021, 2022 Mathieu Othacehe

Copyright (C) 2017 Federico Beffa

Copyright (C) 2017, 2018 Carlo Zancanaro

Copyright (C) 2017 Thomas Danckaert

Copyright (C) 2017 humanitiesNerd

Copyright (C) 2017, 2021 Christine Lemmer-Webber

Copyright (C) 2017, 2018, 2019, 2020, 2021, 2022 Marius Bakke

Copyright (C) 2017, 2019, 2020, 2022 Hartmut Goebel

Copyright (C) 2017, 2019, 2020, 2021, 2022 Maxim Cournoyer

Copyright (C) 2017–2022 Tobias Geerinckx-Rice

Copyright (C) 2017 George Clemmer

Copyright (C) 2017 Andy Wingo

Copyright (C) 2017, 2018, 2019, 2020 Arun Isaac

Copyright (C) 2017 nee

Copyright (C) 2018 Rutger Helling

Copyright (C) 2018, 2021 Oleg Pykhalov

Copyright (C) 2018 Mike Gerwitz

Copyright (C) 2018 Pierre-Antoine Rouby

Copyright (C) 2018, 2019 Gábor Boskovits

Copyright (C) 2018, 2019, 2020, 2022 Florian Pelz

Copyright (C) 2018 Laura Lazzati

Copyright (C) 2018 Alex Vong

Copyright (C) 2019 Josh Holland

Copyright (C) 2019, 2020 Diego Nicola Barbato

Copyright (C) 2019 Ivan Petkov

Copyright (C) 2019 Jakob L. Kreuze

Copyright (C) 2019 Kyle Andrews

Copyright (C) 2019 Alex Griffin

Copyright (C) 2019, 2020, 2021, 2022 Guillaume Le Vaillant

Copyright (C) 2020 Liliana Marie Prikler

Copyright (C) 2019, 2020, 2021, 2022 Simon Tournier

Copyright (C) 2020 Wiktor Żelazny

Copyright (C) 2020 Damien Cassou

Copyright (C) 2020 Jakub Kądziołka

Copyright (C) 2020 Jack Hill

Copyright (C) 2020 Naga Malleswari

Copyright (C) 2020, 2021 Brice Waegeneire

Copyright (C) 2020 R Veera Kumar

Copyright (C) 2020, 2021 Pierre Langlois

Copyright (C) 2020 pinoaffe

Copyright (C) 2020 André Batista

Copyright (C) 2020, 2021 Alexandru-Sergiu Marton

Copyright (C) 2020 raingloom

Copyright (C) 2020 Daniel Brooks

Copyright (C) 2020 John Soo

Copyright (C) 2020 Jonathan Brielmaier

Copyright (C) 2020 Edgar Vincent

Copyright (C) 2021, 2022 Maxime Devos

Copyright (C) 2021 B. Wilson

Copyright (C) 2021 Xinglu Chen

Copyright (C) 2021 Raghav Gururajan

Copyright (C) 2021 Domagoj Stolfa

Copyright (C) 2021 Hui Lu

Copyright (C) 2021 pukkamustard

Copyright (C) 2021 Alice Brenon

Copyright (C) 2021, 2022 Josselin Poiret

Copyright (C) 2021 muradm

Copyright (C) 2021, 2022 Andrew Tropin

Copyright (C) 2021 Sarah Morgensen

Copyright (C) 2022 Remco van 't Veer

Copyright (C) 2022 Aleksandr Vityazev

Copyright (C) 2022 Philip McGrath

Copyright (C) 2022 Karl Hallsby

Copyright (C) 2022 Justin Veilleux

Copyright (C) 2022 Reily Siegel

Copyright (C) 2022 Simon Streit

Copyright (C) 2022 (

Copyright (C) 2022 John Kehayias


Permission is granted to copy, distribute and/or modify this document
under the terms of the GNU Free Documentation License, Version 1.3 or
any later version published by the Free Software Foundation; with no
Invariant Sections, no Front-Cover Texts, and no Back-Cover Texts.  A
copy of the license is included in the section entitled "GNU Free
Documentation License".   -->
<!--   Created by GNU Texinfo 6.7, http://www.gnu.org/software/texinfo/   -->
<head>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<title>VNC Services (GNU Guix Reference Manual)</title>

<meta name="description" content="VNC Services (GNU Guix Reference Manual)" />
<meta name="keywords" content="VNC Services (GNU Guix Reference Manual)" />
<meta name="resource-type" content="document" />
<meta name="distribution" content="global" />
<meta name="Generator" content="makeinfo" />
<link href="index.html" rel="start" title="Top" />
<link href="Concept-Index.html" rel="index" title="Concept Index" />
<link href="index.html#SEC_Contents" rel="contents" title="Table of Contents" />
<link href="Services.html" rel="up" title="Services" />
<link href="VPN-Services.html" rel="next" title="VPN Services" />
<link href="DNS-Services.html" rel="prev" title="DNS Services" />
<style type="text/css">
&amp;lt;!--
a.summary-letter {text-decoration: none}
blockquote.indentedblock {margin-right: 0em}
div.display {margin-left: 3.2em}
div.example {margin-left: 3.2em}
div.lisp {margin-left: 3.2em}
kbd {font-style: oblique}
pre.display {font-family: inherit}
pre.format {font-family: inherit}
pre.menu-comment {font-family: serif}
pre.menu-preformatted {font-family: serif}
span.nolinebreak {white-space: nowrap}
span.roman {font-family: initial; font-weight: normal}
span.sansserif {font-family: sans-serif; font-weight: normal}
ul.no-bullet {list-style: none}
--&amp;gt;
</style>
<link rel="stylesheet" type="text/css" href="https://www.gnu.org/software/gnulib/manual.css" />

<meta name="viewport" content="width=device-width, initial-scale=1" />
<link rel="stylesheet" type="text/css" href="../../../static/base/css/manual.css" /><link rel="stylesheet" type="text/css" href="../../../static/base/css/code.css" /></head>

<body lang="en"><header class="navbar"><h1><a class="branding" href="https://guix.gnu.org/manual/en/"></a></h1><nav class="navbar-menu"><input class="navbar-menu-hidden-input" type="radio" name="dropdown" id="all-dropdowns-hidden" /><ul><li class="navbar-menu-item dropdown dropdown-btn"><input class="navbar-menu-hidden-input" type="radio" name="dropdown" id="visible-dropdown" /><label for="visible-dropdown"><img alt="Language" src="../../../static/base/img/language-picker.svg" /></label><label for="all-dropdowns-hidden"><img alt="Language" src="../../../static/base/img/language-picker.svg" /></label><div class="navbar-submenu" id="navbar-submenu"><div class="navbar-submenu-triangle"> </div><ul><li><a class="navbar-menu-item" href="https://guix.gnu.org/manual/de/html_node">Deutsch</a></li><li><a class="navbar-menu-item" href="https://guix.gnu.org/manual/en/html_node">English</a></li><li><a class="navbar-menu-item" href="https://guix.gnu.org/manual/es/html_node">Español</a></li><li><a class="navbar-menu-item" href="https://guix.gnu.org/manual/fr/html_node">français</a></li><li><a class="navbar-menu-item" href="https://guix.gnu.org/manual/pt-br/html_node">Português</a></li><li><a class="navbar-menu-item" href="https://guix.gnu.org/manual/ru/html_node">русский</a></li><li><a class="navbar-menu-item" href="https://guix.gnu.org/manual/zh-cn/html_node">中文</a></li><li><a class="navbar-menu-item" href="https://translate.fedoraproject.org/projects/guix/documentation-manual/">⊕</a></li></ul></div></li></ul></nav><a class="navbar-menu-btn" href="https://guix.gnu.org/manual/"></a></header>
<span id="VNC-Services"></span><div class="header">
<p>
Next: <a href="VPN-Services.html" accesskey="n" rel="next">VPN Services</a>, Previous: <a href="DNS-Services.html" accesskey="p" rel="prev">DNS Services</a>, Up: <a href="Services.html" accesskey="u" rel="up">Services</a> &nbsp; [<a href="index.html#SEC_Contents" title="Table of contents" rel="contents">Contents</a>][<a href="Concept-Index.html" title="Index" rel="index">Index</a>]</p>
</div>
<hr />
<span id="VNC-Services-1"></span><h4 class="subsection">12.9.22 VNC Services</h4>
<span id="index-VNC-_0028virtual-network-computing_0029"></span>
<span id="index-XDMCP-_0028x-display-manager-control-protocol_0029"></span>

<p>The <code>(gnu services vnc)</code> module provides services related to
<em>Virtual Network Computing</em> (VNC), which makes it possible to
locally use graphical Xorg applications running on a remote machine.
Combined with a graphical manager that supports the <em>X Display
Manager Control Protocol</em>, such as GDM (see <a href="X-Window.html#gdm">gdm</a>) or LightDM
(see <a href="X-Window.html#lightdm">lightdm</a>), it is possible to remote an entire desktop for a
multi-user environment.
</p>
<span id="Xvnc"></span><h4 class="subsubheading">Xvnc</h4>

<p>Xvnc is a VNC server that spawns its own X window server; which means it
can run on headless servers.  The Xvnc implementations provided by the
<code>tigervnc-server</code> and <code>turbovnc</code> aim to be fast and efficient.
</p>
<dl>
<dt id="index-Scheme-Variable-1" class="symbol-definition"><span class="symbol-definition-category">Variable: </span><span class="symbol-definition-prototype">Scheme Variable xvnc-service-type</span></dt>
<dd>
<p>The <code>xvnc-server-type</code> service can be configured via the
<code>xvnc-configuration</code> record, documented below.  A second virtual
display could be made available on a remote machine via the
following configuration:
</p></dd></dl>

<div class="lisp">
<pre class="lisp"><span class="syntax-paren0">(<span class="syntax-symbol"><a class="syntax-symbol" href="Service-Reference.html#index-service">service</a> <span class="syntax-symbol">xvnc-service-type</span>
         <span class="syntax-paren1">(<span class="syntax-symbol"><a class="syntax-symbol" href="VNC-Services.html#index-xvnc_002dconfiguration">xvnc-configuration</a> <span class="syntax-paren2">(<span class="syntax-symbol"><span class="syntax-symbol">display-number</span> <span class="syntax-symbol">10</span></span>)</span></span>)</span></span>)</span>
</pre></div>

<p>As a demonstration, the <code>xclock</code> command could then be started
on the remote machine on display number 10, and it could be displayed
locally via the <code>vncviewer</code> command:
</p><div class="example">
<pre class="example"># Start xclock on the remote machine.
ssh -L5910:localhost:5910 -- guix shell xclock -- env DISPLAY=:10 xclock
# Access it via VNC.
guix shell tigervnc-client -- vncviewer localhost:5910
</pre></div>

<p>The following configuration combines XDMCP and Inetd to allow multiple
users to concurrently use the remote system, login in graphically via
the GDM display manager:
</p>
<div class="lisp">
<pre class="lisp"><span class="syntax-paren0">(<span class="syntax-symbol"><a class="syntax-symbol" href="operating_002dsystem-Reference.html#index-operating_002dsystem-1">operating-system</a>
  <span class="syntax-paren1">[<span class="syntax-symbol"><a class="syntax-symbol" href="https://www.gnu.org/software/guile/manual/html_node/Syntax-Rules.html#index-_002e_002e_002e">...</a></span>]</span>
  <span class="syntax-paren1">(<span class="syntax-symbol"><span class="syntax-symbol">services</span> <span class="syntax-paren2">(<span class="syntax-symbol"><a class="syntax-symbol" href="https://www.gnu.org/software/guile/manual/html_node/List-Constructors.html#index-cons_002a">cons*</a>
             <span class="syntax-paren3">[<span class="syntax-symbol"><a class="syntax-symbol" href="https://www.gnu.org/software/guile/manual/html_node/Syntax-Rules.html#index-_002e_002e_002e">...</a></span>]</span>
             <span class="syntax-paren3">(<span class="syntax-symbol"><a class="syntax-symbol" href="Service-Reference.html#index-service">service</a> <span class="syntax-symbol">xvnc-service-type</span> <span class="syntax-paren4">(<span class="syntax-symbol"><a class="syntax-symbol" href="VNC-Services.html#index-xvnc_002dconfiguration">xvnc-configuration</a>
                                         <span class="syntax-paren5">(<span class="syntax-symbol"><span class="syntax-symbol">display-number</span> <span class="syntax-symbol">5</span></span>)</span>
                                         <span class="syntax-paren5">(<span class="syntax-symbol"><span class="syntax-symbol">localhost?</span> <span class="syntax-symbol">#f</span></span>)</span>
                                         <span class="syntax-paren5">(<span class="syntax-symbol"><span class="syntax-symbol">xdmcp?</span> <span class="syntax-symbol">#t</span></span>)</span>
                                         <span class="syntax-paren5">(<span class="syntax-symbol"><span class="syntax-symbol">inetd?</span> <span class="syntax-symbol">#t</span></span>)</span></span>)</span></span>)</span>
             <span class="syntax-paren3">(<span class="syntax-symbol"><a class="syntax-symbol" href="Service-Reference.html#index-modify_002dservices-1">modify-services</a> <a class="syntax-symbol" href="Desktop-Services.html#index-_0025desktop_002dservices">%desktop-services</a>
               <span class="syntax-paren4">(<span class="syntax-symbol"><a class="syntax-symbol" href="X-Window.html#index-gdm_002dservice_002dtype">gdm-service-type</a> <span class="syntax-symbol">config</span> <a class="syntax-symbol" href="https://www.gnu.org/software/guile/manual/html_node/Syntax-Rules.html#index-_003d_003e">=&gt;</a> <span class="syntax-paren5">(<span class="syntax-symbol"><a class="syntax-symbol" href="X-Window.html#index-gdm_002dconfiguration">gdm-configuration</a>
                                            <span class="syntax-paren6">(<span class="syntax-symbol"><span class="syntax-symbol">inherit</span> <span class="syntax-symbol">config</span></span>)</span>
                                            <span class="syntax-paren6">(<span class="syntax-symbol"><span class="syntax-symbol">auto-suspend?</span> <span class="syntax-symbol">#f</span></span>)</span>
                                            <span class="syntax-paren6">(<span class="syntax-symbol"><span class="syntax-symbol">xdmcp?</span> <span class="syntax-symbol">#t</span></span>)</span></span>)</span></span>)</span></span>)</span></span>)</span></span>)</span></span>)</span>
</pre></div>

<p>A remote user could then connect to it by using the <code>vncviewer</code>
command or a compatible VNC client and start a desktop session of their
choosing:
</p><div class="example">
<pre class="example">vncviewer remote-host:5905
</pre></div>

<blockquote>
<p><b>Warning:</b> Unless your machine is in a controlled environment, for security
reasons, the <code>localhost?</code> configuration of the
<code>xvnc-configuration</code> record should be left to its default <code>#t</code>
value and exposed via a secure means such as an SSH port forward.  The
XDMCP port, UDP 177 should also be blocked from the outside by a
firewall, as it is not a secure protocol and can expose login
credentials in clear.
</p></blockquote>

<dl>
<dt id="index-xvnc_002dconfiguration" class="symbol-definition"><span class="symbol-definition-category">Data Type: </span><span class="symbol-definition-prototype">xvnc-configuration </span></dt>
<dd><p>Available <code>xvnc-configuration</code> fields are:
</p>
<dl compact="compact">
<dt><code>xvnc</code> (default: <code>tigervnc-server</code>) (type: file-like)</dt>
<dd><p>The package that provides the Xvnc binary.
</p>
</dd>
<dt><code>display-number</code> (default: <code>0</code>) (type: number)</dt>
<dd><p>The display number used by Xvnc.  You should set this to a number not
already used a Xorg server.
</p>
</dd>
<dt><code>geometry</code> (default: <code>"1024x768"</code>) (type: string)</dt>
<dd><p>The size of the desktop to be created.
</p>
</dd>
<dt><code>depth</code> (default: <code>24</code>) (type: color-depth)</dt>
<dd><p>The pixel depth in bits of the desktop to be created.  Accepted values
are 16, 24 or 32.
</p>
</dd>
<dt><code>port</code> (type: maybe-port)</dt>
<dd><p>The port on which to listen for connections from viewers.  When left
unspecified, it defaults to 5900 plus the display number.
</p>
</dd>
<dt><code>ipv4?</code> (default: <code>#t</code>) (type: boolean)</dt>
<dd><p>Use IPv4 for incoming and outgoing connections.
</p>
</dd>
<dt><code>ipv6?</code> (default: <code>#t</code>) (type: boolean)</dt>
<dd><p>Use IPv6 for incoming and outgoing connections.
</p>
</dd>
<dt><code>password-file</code> (type: maybe-string)</dt>
<dd><p>The password file to use, if any.  Refer to vncpasswd(1) to learn how to
generate such a file.
</p>
</dd>
<dt><code>xdmcp?</code> (default: <code>#f</code>) (type: boolean)</dt>
<dd><p>Query the XDMCP server for a session.  This enables users to log in a
desktop session from the login manager screen.  For a multiple users
scenario, you&rsquo;ll want to enable the <code>inetd?</code> option as well, so
that each connection to the VNC server is handled separately rather than
shared.
</p>
</dd>
<dt><code>inetd?</code> (default: <code>#f</code>) (type: boolean)</dt>
<dd><p>Use an Inetd-style service, which runs the Xvnc server on demand.
</p>
</dd>
<dt><code>frame-rate</code> (default: <code>60</code>) (type: number)</dt>
<dd><p>The maximum number of updates per second sent to each client.
</p>
</dd>
<dt><code>security-types</code> (default: <code>("None")</code>) (type: security-types)</dt>
<dd><p>The allowed security schemes to use for incoming connections.  The
default is "None", which is safe given that Xvnc is configured to
authenticate the user via the display manager, and only for local
connections.  Accepted values are any of the following: ("None"
"VncAuth" "Plain" "TLSNone" "TLSVnc" "TLSPlain" "X509None" "X509Vnc")
</p>
</dd>
<dt><code>localhost?</code> (default: <code>#t</code>) (type: boolean)</dt>
<dd><p>Only allow connections from the same machine.  It is set to #true by
default for security, which means SSH or another secure means should be
used to expose the remote port.
</p>
</dd>
<dt><code>log-level</code> (default: <code>30</code>) (type: log-level)</dt>
<dd><p>The log level, a number between 0 and 100, 100 meaning most verbose
output.  The log messages are output to syslog.
</p>
</dd>
<dt><code>extra-options</code> (default: <code>()</code>) (type: strings)</dt>
<dd><p>This can be used to provide extra Xvnc options not exposed via this
&lt;xvnc-configuration&gt; record.
</p>
</dd>
</dl>

</dd></dl>

<hr />
<div class="header">
<p>
Next: <a href="VPN-Services.html" accesskey="n" rel="next">VPN Services</a>, Previous: <a href="DNS-Services.html" accesskey="p" rel="prev">DNS Services</a>, Up: <a href="Services.html" accesskey="u" rel="up">Services</a> &nbsp; [<a href="index.html#SEC_Contents" title="Table of contents" rel="contents">Contents</a>][<a href="Concept-Index.html" title="Index" rel="index">Index</a>]</p>
</div>



</body>
</html>
