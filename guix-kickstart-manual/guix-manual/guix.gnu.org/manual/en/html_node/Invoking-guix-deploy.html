<!DOCTYPE html PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN" "http://www.w3.org/TR/html4/loose.dtd">
<html>
<!--   Copyright (C) 2012-2022 Ludovic Courtès

Copyright (C) 2013, 2014, 2016 Andreas Enge

Copyright (C) 2013 Nikita Karetnikov

Copyright (C) 2014, 2015, 2016 Alex Kost

Copyright (C) 2015, 2016 Mathieu Lirzin

Copyright (C) 2014 Pierre-Antoine Rault

Copyright (C) 2015 Taylan Ulrich Bayırlı/Kammer

Copyright (C) 2015, 2016, 2017, 2019, 2020, 2021 Leo Famulari

Copyright (C) 2015, 2016, 2017, 2018, 2019, 2020, 2021, 2022 Ricardo Wurmus

Copyright (C) 2016 Ben Woodcroft

Copyright (C) 2016, 2017, 2018, 2021 Chris Marusich

Copyright (C) 2016, 2017, 2018, 2019, 2020, 2021, 2022 Efraim Flashner

Copyright (C) 2016 John Darrington

Copyright (C) 2016, 2017 Nikita Gillmann

Copyright (C) 2016, 2017, 2018, 2019, 2020 Jan Nieuwenhuizen

Copyright (C) 2016, 2017, 2018, 2019, 2020, 2021 Julien Lepiller

Copyright (C) 2016 Alex ter Weele

Copyright (C) 2016, 2017, 2018, 2019, 2020, 2021 Christopher Baines

Copyright (C) 2017, 2018, 2019 Clément Lassieur

Copyright (C) 2017, 2018, 2020, 2021, 2022 Mathieu Othacehe

Copyright (C) 2017 Federico Beffa

Copyright (C) 2017, 2018 Carlo Zancanaro

Copyright (C) 2017 Thomas Danckaert

Copyright (C) 2017 humanitiesNerd

Copyright (C) 2017, 2021 Christine Lemmer-Webber

Copyright (C) 2017, 2018, 2019, 2020, 2021, 2022 Marius Bakke

Copyright (C) 2017, 2019, 2020, 2022 Hartmut Goebel

Copyright (C) 2017, 2019, 2020, 2021, 2022 Maxim Cournoyer

Copyright (C) 2017–2022 Tobias Geerinckx-Rice

Copyright (C) 2017 George Clemmer

Copyright (C) 2017 Andy Wingo

Copyright (C) 2017, 2018, 2019, 2020 Arun Isaac

Copyright (C) 2017 nee

Copyright (C) 2018 Rutger Helling

Copyright (C) 2018, 2021 Oleg Pykhalov

Copyright (C) 2018 Mike Gerwitz

Copyright (C) 2018 Pierre-Antoine Rouby

Copyright (C) 2018, 2019 Gábor Boskovits

Copyright (C) 2018, 2019, 2020, 2022 Florian Pelz

Copyright (C) 2018 Laura Lazzati

Copyright (C) 2018 Alex Vong

Copyright (C) 2019 Josh Holland

Copyright (C) 2019, 2020 Diego Nicola Barbato

Copyright (C) 2019 Ivan Petkov

Copyright (C) 2019 Jakob L. Kreuze

Copyright (C) 2019 Kyle Andrews

Copyright (C) 2019 Alex Griffin

Copyright (C) 2019, 2020, 2021, 2022 Guillaume Le Vaillant

Copyright (C) 2020 Liliana Marie Prikler

Copyright (C) 2019, 2020, 2021, 2022 Simon Tournier

Copyright (C) 2020 Wiktor Żelazny

Copyright (C) 2020 Damien Cassou

Copyright (C) 2020 Jakub Kądziołka

Copyright (C) 2020 Jack Hill

Copyright (C) 2020 Naga Malleswari

Copyright (C) 2020, 2021 Brice Waegeneire

Copyright (C) 2020 R Veera Kumar

Copyright (C) 2020, 2021 Pierre Langlois

Copyright (C) 2020 pinoaffe

Copyright (C) 2020 André Batista

Copyright (C) 2020, 2021 Alexandru-Sergiu Marton

Copyright (C) 2020 raingloom

Copyright (C) 2020 Daniel Brooks

Copyright (C) 2020 John Soo

Copyright (C) 2020 Jonathan Brielmaier

Copyright (C) 2020 Edgar Vincent

Copyright (C) 2021, 2022 Maxime Devos

Copyright (C) 2021 B. Wilson

Copyright (C) 2021 Xinglu Chen

Copyright (C) 2021 Raghav Gururajan

Copyright (C) 2021 Domagoj Stolfa

Copyright (C) 2021 Hui Lu

Copyright (C) 2021 pukkamustard

Copyright (C) 2021 Alice Brenon

Copyright (C) 2021, 2022 Josselin Poiret

Copyright (C) 2021 muradm

Copyright (C) 2021, 2022 Andrew Tropin

Copyright (C) 2021 Sarah Morgensen

Copyright (C) 2022 Remco van 't Veer

Copyright (C) 2022 Aleksandr Vityazev

Copyright (C) 2022 Philip McGrath

Copyright (C) 2022 Karl Hallsby

Copyright (C) 2022 Justin Veilleux

Copyright (C) 2022 Reily Siegel

Copyright (C) 2022 Simon Streit

Copyright (C) 2022 (

Copyright (C) 2022 John Kehayias


Permission is granted to copy, distribute and/or modify this document
under the terms of the GNU Free Documentation License, Version 1.3 or
any later version published by the Free Software Foundation; with no
Invariant Sections, no Front-Cover Texts, and no Back-Cover Texts.  A
copy of the license is included in the section entitled "GNU Free
Documentation License".   -->
<!--   Created by GNU Texinfo 6.7, http://www.gnu.org/software/texinfo/   -->
<head>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<title>Invoking guix deploy (GNU Guix Reference Manual)</title>

<meta name="description" content="Invoking guix deploy (GNU Guix Reference Manual)" />
<meta name="keywords" content="Invoking guix deploy (GNU Guix Reference Manual)" />
<meta name="resource-type" content="document" />
<meta name="distribution" content="global" />
<meta name="Generator" content="makeinfo" />
<link href="index.html" rel="start" title="Top" />
<link href="Concept-Index.html" rel="index" title="Concept Index" />
<link href="index.html#SEC_Contents" rel="contents" title="Table of Contents" />
<link href="System-Configuration.html" rel="up" title="System Configuration" />
<link href="Running-Guix-in-a-VM.html" rel="next" title="Running Guix in a VM" />
<link href="Invoking-guix-system.html" rel="prev" title="Invoking guix system" />
<style type="text/css">
&amp;lt;!--
a.summary-letter {text-decoration: none}
blockquote.indentedblock {margin-right: 0em}
div.display {margin-left: 3.2em}
div.example {margin-left: 3.2em}
div.lisp {margin-left: 3.2em}
kbd {font-style: oblique}
pre.display {font-family: inherit}
pre.format {font-family: inherit}
pre.menu-comment {font-family: serif}
pre.menu-preformatted {font-family: serif}
span.nolinebreak {white-space: nowrap}
span.roman {font-family: initial; font-weight: normal}
span.sansserif {font-family: sans-serif; font-weight: normal}
ul.no-bullet {list-style: none}
--&amp;gt;
</style>
<link rel="stylesheet" type="text/css" href="https://www.gnu.org/software/gnulib/manual.css" />

<meta name="viewport" content="width=device-width, initial-scale=1" />
<link rel="stylesheet" type="text/css" href="../../../static/base/css/manual.css" /><link rel="stylesheet" type="text/css" href="../../../static/base/css/code.css" /></head>

<body lang="en"><header class="navbar"><h1><a class="branding" href="https://guix.gnu.org/manual/en/"></a></h1><nav class="navbar-menu"><input class="navbar-menu-hidden-input" type="radio" name="dropdown" id="all-dropdowns-hidden" /><ul><li class="navbar-menu-item dropdown dropdown-btn"><input class="navbar-menu-hidden-input" type="radio" name="dropdown" id="visible-dropdown" /><label for="visible-dropdown"><img alt="Language" src="../../../static/base/img/language-picker.svg" /></label><label for="all-dropdowns-hidden"><img alt="Language" src="../../../static/base/img/language-picker.svg" /></label><div class="navbar-submenu" id="navbar-submenu"><div class="navbar-submenu-triangle"> </div><ul><li><a class="navbar-menu-item" href="https://guix.gnu.org/manual/de/html_node">Deutsch</a></li><li><a class="navbar-menu-item" href="https://guix.gnu.org/manual/en/html_node">English</a></li><li><a class="navbar-menu-item" href="https://guix.gnu.org/manual/es/html_node">Español</a></li><li><a class="navbar-menu-item" href="https://guix.gnu.org/manual/fr/html_node">français</a></li><li><a class="navbar-menu-item" href="https://guix.gnu.org/manual/pt-br/html_node">Português</a></li><li><a class="navbar-menu-item" href="https://guix.gnu.org/manual/ru/html_node">русский</a></li><li><a class="navbar-menu-item" href="https://guix.gnu.org/manual/zh-cn/html_node">中文</a></li><li><a class="navbar-menu-item" href="https://translate.fedoraproject.org/projects/guix/documentation-manual/">⊕</a></li></ul></div></li></ul></nav><a class="navbar-menu-btn" href="https://guix.gnu.org/manual/"></a></header>
<span id="Invoking-guix-deploy"></span><div class="header">
<p>
Next: <a href="Running-Guix-in-a-VM.html" accesskey="n" rel="next">Running Guix in a VM</a>, Previous: <a href="Invoking-guix-system.html" accesskey="p" rel="prev">Invoking guix system</a>, Up: <a href="System-Configuration.html" accesskey="u" rel="up">System Configuration</a> &nbsp; [<a href="index.html#SEC_Contents" title="Table of contents" rel="contents">Contents</a>][<a href="Concept-Index.html" title="Index" rel="index">Index</a>]</p>
</div>
<hr />
<span id="Invoking-guix-deploy-1"></span><h3 class="section">12.16 Invoking <code>guix deploy</code></h3>

<span id="index-guix-deploy"></span>
<p>We&rsquo;ve already seen <code>operating-system</code> declarations used to manage a
machine&rsquo;s configuration locally.  Suppose you need to configure multiple
machines, though&mdash;perhaps you&rsquo;re managing a service on the web that&rsquo;s
comprised of several servers.  <code>guix deploy</code> enables you to use those
same <code>operating-system</code> declarations to manage multiple remote hosts at
once as a logical &ldquo;deployment&rdquo;.
</p>
<blockquote>
<p><b>Note:</b> The functionality described in this section is still under development
and is subject to change.  Get in touch with us on
<a href="mailto:guix-devel@gnu.org">guix-devel@gnu.org</a>!
</p></blockquote>

<div class="example">
<pre class="example">guix deploy <var>file</var>
</pre></div>

<p>Such an invocation will deploy the machines that the code within <var>file</var>
evaluates to.  As an example, <var>file</var> might contain a definition like this:
</p>
<div class="lisp">
<pre class="lisp"><span class="syntax-comment">;; This is a Guix deployment of a "bare bones" setup, with
</span><span class="syntax-comment">;; no X11 display server, to a machine with an SSH daemon
</span><span class="syntax-comment">;; listening on localhost:2222. A configuration such as this
</span><span class="syntax-comment">;; may be appropriate for virtual machine with ports
</span><span class="syntax-comment">;; forwarded to the host's loopback interface.
</span>
<span class="syntax-paren0">(<span class="syntax-symbol"><span class="syntax-symbol">use-service-modules</span> <span class="syntax-symbol">networking</span> <span class="syntax-symbol">ssh</span></span>)</span>
<span class="syntax-paren0">(<span class="syntax-symbol"><span class="syntax-symbol">use-package-modules</span> <span class="syntax-symbol">bootloaders</span></span>)</span>

<span class="syntax-paren0">(<span class="syntax-symbol"><span class="syntax-special">define</span> <span class="syntax-symbol">%system</span>
  <span class="syntax-paren1">(<span class="syntax-symbol"><a class="syntax-symbol" href="operating_002dsystem-Reference.html#index-operating_002dsystem-1">operating-system</a>
   <span class="syntax-paren2">(<span class="syntax-symbol"><span class="syntax-symbol">host-name</span> <span class="syntax-string">"gnu-deployed"</span></span>)</span>
   <span class="syntax-paren2">(<span class="syntax-symbol"><span class="syntax-symbol">timezone</span> <span class="syntax-string">"Etc/UTC"</span></span>)</span>
   <span class="syntax-paren2">(<span class="syntax-symbol"><span class="syntax-symbol">bootloader</span> <span class="syntax-paren3">(<span class="syntax-symbol"><a class="syntax-symbol" href="Bootloader-Configuration.html#index-bootloader_002dconfiguration">bootloader-configuration</a>
                <span class="syntax-paren4">(<span class="syntax-symbol"><span class="syntax-symbol">bootloader</span> <span class="syntax-symbol">grub-bootloader</span></span>)</span>
                <span class="syntax-paren4">(<span class="syntax-symbol"><span class="syntax-symbol">targets</span> <span class="syntax-symbol">'</span><span class="syntax-paren5">(<span class="syntax-symbol"><span class="syntax-string">"/dev/vda"</span></span>)</span></span>)</span>
                <span class="syntax-paren4">(<span class="syntax-symbol"><span class="syntax-symbol">terminal-outputs</span> <span class="syntax-symbol">'</span><span class="syntax-paren5">(<span class="syntax-symbol"><span class="syntax-symbol">console</span></span>)</span></span>)</span></span>)</span></span>)</span>
   <span class="syntax-paren2">(<span class="syntax-symbol"><span class="syntax-symbol">file-systems</span> <span class="syntax-paren3">(<span class="syntax-symbol"><a class="syntax-symbol" href="https://www.gnu.org/software/guile/manual/html_node/Pairs.html#index-cons">cons</a> <span class="syntax-paren4">(<span class="syntax-symbol"><a class="syntax-symbol" href="File-Systems.html#index-file_002dsystem">file-system</a>
                        <span class="syntax-paren5">(<span class="syntax-symbol"><span class="syntax-symbol">mount-point</span> <span class="syntax-string">"/"</span></span>)</span>
                        <span class="syntax-paren5">(<span class="syntax-symbol"><span class="syntax-symbol">device</span> <span class="syntax-string">"/dev/vda1"</span></span>)</span>
                        <span class="syntax-paren5">(<span class="syntax-symbol"><span class="syntax-symbol">type</span> <span class="syntax-string">"ext4"</span></span>)</span></span>)</span>
                       <a class="syntax-symbol" href="File-Systems.html#index-_0025base_002dfile_002dsystems">%base-file-systems</a></span>)</span></span>)</span>
   <span class="syntax-paren2">(<span class="syntax-symbol"><span class="syntax-symbol">services</span>
    <span class="syntax-paren3">(<span class="syntax-symbol"><a class="syntax-symbol" href="https://www.gnu.org/software/guile/manual/html_node/Append_002fReverse.html#index-append">append</a> <span class="syntax-paren4">(<span class="syntax-symbol"><a class="syntax-symbol" href="https://www.gnu.org/software/guile/manual/html_node/List-Constructors.html#index-list-1">list</a> <span class="syntax-paren5">(<span class="syntax-symbol"><a class="syntax-symbol" href="Service-Reference.html#index-service">service</a> <a class="syntax-symbol" href="Networking-Setup.html#index-dhcp_002dclient_002dservice_002dtype">dhcp-client-service-type</a></span>)</span>
                  <span class="syntax-paren5">(<span class="syntax-symbol"><a class="syntax-symbol" href="Service-Reference.html#index-service">service</a> <a class="syntax-symbol" href="Networking-Services.html#index-openssh_002dservice_002dtype">openssh-service-type</a>
                           <span class="syntax-paren6">(<span class="syntax-symbol"><a class="syntax-symbol" href="Networking-Services.html#index-openssh_002dconfiguration">openssh-configuration</a>
                            <span class="syntax-paren7">(<span class="syntax-symbol"><span class="syntax-symbol">permit-root-login</span> <span class="syntax-symbol">#t</span></span>)</span>
                            <span class="syntax-paren7">(<span class="syntax-symbol"><span class="syntax-symbol">allow-empty-passwords?</span> <span class="syntax-symbol">#t</span></span>)</span></span>)</span></span>)</span></span>)</span>
            <a class="syntax-symbol" href="Base-Services.html#index-_0025base_002dservices-1">%base-services</a></span>)</span></span>)</span></span>)</span></span>)</span>

<span class="syntax-paren0">(<span class="syntax-symbol"><a class="syntax-symbol" href="https://www.gnu.org/software/guile/manual/html_node/List-Constructors.html#index-list-1">list</a> <span class="syntax-paren1">(<span class="syntax-symbol"><a class="syntax-symbol" href="Invoking-guix-deploy.html#index-machine">machine</a>
       <span class="syntax-paren2">(<span class="syntax-symbol"><a class="syntax-symbol" href="operating_002dsystem-Reference.html#index-operating_002dsystem-1">operating-system</a> <span class="syntax-symbol">%system</span></span>)</span>
       <span class="syntax-paren2">(<span class="syntax-symbol"><a class="syntax-symbol" href="https://www.gnu.org/software/guile/manual/html_node/rnrs-eval.html#index-environment-3">environment</a> <span class="syntax-symbol">managed-host-environment-type</span></span>)</span>
       <span class="syntax-paren2">(<span class="syntax-symbol"><span class="syntax-symbol">configuration</span> <span class="syntax-paren3">(<span class="syntax-symbol"><a class="syntax-symbol" href="Invoking-guix-deploy.html#index-machine_002dssh_002dconfiguration">machine-ssh-configuration</a>
                       <span class="syntax-paren4">(<span class="syntax-symbol"><span class="syntax-symbol">host-name</span> <span class="syntax-string">"localhost"</span></span>)</span>
                       <span class="syntax-paren4">(<span class="syntax-symbol"><a class="syntax-symbol" href="https://www.gnu.org/software/guile/manual/html_node/Processes.html#index-system">system</a> <span class="syntax-string">"x86_64-linux"</span></span>)</span>
                       <span class="syntax-paren4">(<span class="syntax-symbol"><span class="syntax-symbol">user</span> <span class="syntax-string">"alice"</span></span>)</span>
                       <span class="syntax-paren4">(<span class="syntax-symbol"><a class="syntax-symbol" href="https://www.gnu.org/software/guile/manual/html_node/Higher_002dOrder-Functions.html#index-identity">identity</a> <span class="syntax-string">"./id_rsa"</span></span>)</span>
                       <span class="syntax-paren4">(<span class="syntax-symbol"><span class="syntax-symbol">port</span> <span class="syntax-symbol">2222</span></span>)</span></span>)</span></span>)</span></span>)</span></span>)</span>
</pre></div>

<p>The file should evaluate to a list of <var>machine</var> objects.  This example,
upon being deployed, will create a new generation on the remote system
realizing the <code>operating-system</code> declaration <code>%system</code>.
<code>environment</code> and <code>configuration</code> specify how the machine should be
provisioned&mdash;that is, how the computing resources should be created and
managed.  The above example does not create any resources, as a
<code>'managed-host</code> is a machine that is already running the Guix system and
available over the network.  This is a particularly simple case; a more
complex deployment may involve, for example, starting virtual machines through
a Virtual Private Server (VPS) provider.  In such a case, a different
<var>environment</var> type would be used.
</p>
<p>Do note that you first need to generate a key pair on the coordinator machine
to allow the daemon to export signed archives of files from the store
(see <a href="Invoking-guix-archive.html">Invoking guix archive</a>), though this step is automatic on Guix
System:
</p>
<div class="example">
<pre class="example"># guix archive --generate-key
</pre></div>

<p>Each target machine must authorize the key of the master machine so that it
accepts store items it receives from the coordinator:
</p>
<div class="example">
<pre class="example"># guix archive --authorize &lt; coordinator-public-key.txt
</pre></div>

<p><code>user</code>, in this example, specifies the name of the user account to log in
as to perform the deployment.  Its default value is <code>root</code>, but root
login over SSH may be forbidden in some cases.  To work around this,
<code>guix deploy</code> can log in as an unprivileged user and employ
<code>sudo</code> to escalate privileges.  This will only work if <code>sudo</code> is
currently installed on the remote and can be invoked non-interactively as
<code>user</code>.  That is, the line in <code>sudoers</code> granting <code>user</code> the
ability to use <code>sudo</code> must contain the <code>NOPASSWD</code> tag.  This can
be accomplished with the following operating system configuration snippet:
</p>
<div class="lisp">
<pre class="lisp"><span class="syntax-paren0">(<span class="syntax-symbol"><a class="syntax-symbol" href="https://www.gnu.org/software/guile/manual/html_node/Using-Guile-Modules.html#index-use_002dmodules">use-modules</a> <a class="syntax-symbol" href="https://www.gnu.org/software/guile/manual/html_node/Syntax-Rules.html#index-_002e_002e_002e">...</a>
             <span class="syntax-paren1">(<span class="syntax-symbol"><span class="syntax-symbol">gnu</span> <a class="syntax-symbol" href="https://www.gnu.org/software/guile/manual/html_node/Processes.html#index-system">system</a></span>)</span></span>)</span>               <span class="syntax-comment">;for %sudoers-specification
</span>
<span class="syntax-paren0">(<span class="syntax-symbol"><span class="syntax-special">define</span> <span class="syntax-symbol">%user</span> <span class="syntax-string">"username"</span></span>)</span>

<span class="syntax-paren0">(<span class="syntax-symbol"><a class="syntax-symbol" href="operating_002dsystem-Reference.html#index-operating_002dsystem-1">operating-system</a>
  <a class="syntax-symbol" href="https://www.gnu.org/software/guile/manual/html_node/Syntax-Rules.html#index-_002e_002e_002e">...</a>
  <span class="syntax-paren1">(<span class="syntax-symbol"><span class="syntax-symbol">sudoers-file</span>
     <span class="syntax-paren2">(<span class="syntax-symbol"><a class="syntax-symbol" href="G_002dExpressions.html#index-plain_002dfile">plain-file</a> <span class="syntax-string">"sudoers"</span>
                 <span class="syntax-paren3">(<span class="syntax-symbol"><a class="syntax-symbol" href="https://www.gnu.org/software/guile/manual/html_node/Reversing-and-Appending-Strings.html#index-string_002dappend">string-append</a> <span class="syntax-paren4">(<span class="syntax-symbol"><span class="syntax-symbol">plain-file-content</span> <span class="syntax-symbol">%sudoers-specification</span></span>)</span>
                                <span class="syntax-paren4">(<span class="syntax-symbol"><a class="syntax-symbol" href="https://www.gnu.org/software/guile/manual/html_node/Formatted-Output.html#index-format-1">format</a> <span class="syntax-symbol">#f</span> <span class="syntax-string">"~a ALL = NOPASSWD: ALL~%"</span>
                                        <span class="syntax-symbol">%user</span></span>)</span></span>)</span></span>)</span></span>)</span></span>)</span>

</pre></div>

<p>For more information regarding the format of the <samp>sudoers</samp> file,
consult <code>man sudoers</code>.
</p>
<p>Once you&rsquo;ve deployed a system on a set of machines, you may find it
useful to run a command on all of them.  The <samp>--execute</samp> or
<samp>-x</samp> option lets you do that; the example below runs
<code>uname -a</code> on all the machines listed in the deployment file:
</p>
<div class="example">
<pre class="example">guix deploy <var>file</var> -x -- uname -a
</pre></div>

<p>One thing you may often need to do after deployment is restart specific
services on all the machines, which you can do like so:
</p>
<div class="example">
<pre class="example">guix deploy <var>file</var> -x -- herd restart <var>service</var>
</pre></div>

<p>The <code>guix deploy -x</code> command returns zero if and only if the
command succeeded on all the machines.
</p>

<p>Below are the data types you need to know about when writing a
deployment file.
</p>
<dl>
<dt id="index-machine" class="symbol-definition"><span class="symbol-definition-category">Data Type: </span><span class="symbol-definition-prototype">machine </span></dt>
<dd><p>This is the data type representing a single machine in a heterogeneous Guix
deployment.
</p>
<dl compact="compact">
<dt><code>operating-system</code></dt>
<dd><p>The object of the operating system configuration to deploy.
</p>
</dd>
<dt><code>environment</code></dt>
<dd><p>An <code>environment-type</code> describing how the machine should be provisioned.
</p>
</dd>
<dt><code>configuration</code> (default: <code>#f</code>)</dt>
<dd><p>An object describing the configuration for the machine&rsquo;s <code>environment</code>.
If the <code>environment</code> has a default configuration, <code>#f</code> may be used.
If <code>#f</code> is used for an environment with no default configuration,
however, an error will be thrown.
</p></dd>
</dl>
</dd></dl>

<dl>
<dt id="index-machine_002dssh_002dconfiguration" class="symbol-definition"><span class="symbol-definition-category">Data Type: </span><span class="symbol-definition-prototype">machine-ssh-configuration </span></dt>
<dd><p>This is the data type representing the SSH client parameters for a machine
with an <code>environment</code> of <code>managed-host-environment-type</code>.
</p>
<dl compact="compact">
<dt><code>host-name</code></dt>
<dt><code>build-locally?</code> (default: <code>#t</code>)</dt>
<dd><p>If false, system derivations will be built on the machine being deployed to.
</p></dd>
<dt><code>system</code></dt>
<dd><p>The system type describing the architecture of the machine being deployed
to&mdash;e.g., <code>"x86_64-linux"</code>.
</p></dd>
<dt><code>authorize?</code> (default: <code>#t</code>)</dt>
<dd><p>If true, the coordinator&rsquo;s signing key will be added to the remote&rsquo;s ACL
keyring.
</p></dd>
<dt><code>port</code> (default: <code>22</code>)</dt>
<dt><code>user</code> (default: <code>"root"</code>)</dt>
<dt><code>identity</code> (default: <code>#f</code>)</dt>
<dd><p>If specified, the path to the SSH private key to use to authenticate with the
remote host.
</p>
</dd>
<dt><code>host-key</code> (default: <code>#f</code>)</dt>
<dd><p>This should be the SSH host key of the machine, which looks like this:
</p>
<div class="example">
<pre class="example">ssh-ed25519 AAAAC3Nz&hellip; root@example.org
</pre></div>

<p>When <code>host-key</code> is <code>#f</code>, the server is authenticated against
the <samp>~/.ssh/known_hosts</samp> file, just like the OpenSSH <code>ssh</code>
client does.
</p>
</dd>
<dt><code>allow-downgrades?</code> (default: <code>#f</code>)</dt>
<dd><p>Whether to allow potential downgrades.
</p>
<p>Like <code>guix system reconfigure</code>, <code>guix deploy</code> compares
the channel commits currently deployed on the remote host (as returned
by <code>guix system describe</code>) to those currently in use (as
returned by <code>guix describe</code>) to determine whether commits
currently in use are descendants of those deployed.  When this is not
the case and <code>allow-downgrades?</code> is false, it raises an error.
This ensures you do not accidentally downgrade remote machines.
</p>
</dd>
<dt><code>safety-checks?</code> (default: <code>#t</code>)</dt>
<dd><p>Whether to perform &ldquo;safety checks&rdquo; before deployment.  This includes
verifying that devices and file systems referred to in the operating
system configuration actually exist on the target machine, and making
sure that Linux modules required to access storage devices at boot time
are listed in the <code>initrd-modules</code> field of the operating system.
</p>
<p>These safety checks ensure that you do not inadvertently deploy a system
that would fail to boot.  Be careful before turning them off!
</p></dd>
</dl>
</dd></dl>

<dl>
<dt id="index-digital_002docean_002dconfiguration" class="symbol-definition"><span class="symbol-definition-category">Data Type: </span><span class="symbol-definition-prototype">digital-ocean-configuration </span></dt>
<dd><p>This is the data type describing the Droplet that should be created for a
machine with an <code>environment</code> of <code>digital-ocean-environment-type</code>.
</p>
<dl compact="compact">
<dt><code>ssh-key</code></dt>
<dd><p>The path to the SSH private key to use to authenticate with the remote
host.  In the future, this field may not exist.
</p></dd>
<dt><code>tags</code></dt>
<dd><p>A list of string &ldquo;tags&rdquo; that uniquely identify the machine.  Must be given
such that no two machines in the deployment have the same set of tags.
</p></dd>
<dt><code>region</code></dt>
<dd><p>A Digital Ocean region slug, such as <code>"nyc3"</code>.
</p></dd>
<dt><code>size</code></dt>
<dd><p>A Digital Ocean size slug, such as <code>"s-1vcpu-1gb"</code>
</p></dd>
<dt><code>enable-ipv6?</code></dt>
<dd><p>Whether or not the droplet should be created with IPv6 networking.
</p></dd>
</dl>
</dd></dl>

<hr />
<div class="header">
<p>
Next: <a href="Running-Guix-in-a-VM.html" accesskey="n" rel="next">Running Guix in a VM</a>, Previous: <a href="Invoking-guix-system.html" accesskey="p" rel="prev">Invoking guix system</a>, Up: <a href="System-Configuration.html" accesskey="u" rel="up">System Configuration</a> &nbsp; [<a href="index.html#SEC_Contents" title="Table of contents" rel="contents">Contents</a>][<a href="Concept-Index.html" title="Index" rel="index">Index</a>]</p>
</div>



</body>
</html>
