<!DOCTYPE html PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN" "http://www.w3.org/TR/html4/loose.dtd">
<html>
<!--   Copyright (C) 2012-2022 Ludovic Courtès

Copyright (C) 2013, 2014, 2016 Andreas Enge

Copyright (C) 2013 Nikita Karetnikov

Copyright (C) 2014, 2015, 2016 Alex Kost

Copyright (C) 2015, 2016 Mathieu Lirzin

Copyright (C) 2014 Pierre-Antoine Rault

Copyright (C) 2015 Taylan Ulrich Bayırlı/Kammer

Copyright (C) 2015, 2016, 2017, 2019, 2020, 2021 Leo Famulari

Copyright (C) 2015, 2016, 2017, 2018, 2019, 2020, 2021, 2022 Ricardo Wurmus

Copyright (C) 2016 Ben Woodcroft

Copyright (C) 2016, 2017, 2018, 2021 Chris Marusich

Copyright (C) 2016, 2017, 2018, 2019, 2020, 2021, 2022 Efraim Flashner

Copyright (C) 2016 John Darrington

Copyright (C) 2016, 2017 Nikita Gillmann

Copyright (C) 2016, 2017, 2018, 2019, 2020 Jan Nieuwenhuizen

Copyright (C) 2016, 2017, 2018, 2019, 2020, 2021 Julien Lepiller

Copyright (C) 2016 Alex ter Weele

Copyright (C) 2016, 2017, 2018, 2019, 2020, 2021 Christopher Baines

Copyright (C) 2017, 2018, 2019 Clément Lassieur

Copyright (C) 2017, 2018, 2020, 2021, 2022 Mathieu Othacehe

Copyright (C) 2017 Federico Beffa

Copyright (C) 2017, 2018 Carlo Zancanaro

Copyright (C) 2017 Thomas Danckaert

Copyright (C) 2017 humanitiesNerd

Copyright (C) 2017, 2021 Christine Lemmer-Webber

Copyright (C) 2017, 2018, 2019, 2020, 2021, 2022 Marius Bakke

Copyright (C) 2017, 2019, 2020, 2022 Hartmut Goebel

Copyright (C) 2017, 2019, 2020, 2021, 2022 Maxim Cournoyer

Copyright (C) 2017–2022 Tobias Geerinckx-Rice

Copyright (C) 2017 George Clemmer

Copyright (C) 2017 Andy Wingo

Copyright (C) 2017, 2018, 2019, 2020 Arun Isaac

Copyright (C) 2017 nee

Copyright (C) 2018 Rutger Helling

Copyright (C) 2018, 2021 Oleg Pykhalov

Copyright (C) 2018 Mike Gerwitz

Copyright (C) 2018 Pierre-Antoine Rouby

Copyright (C) 2018, 2019 Gábor Boskovits

Copyright (C) 2018, 2019, 2020, 2022 Florian Pelz

Copyright (C) 2018 Laura Lazzati

Copyright (C) 2018 Alex Vong

Copyright (C) 2019 Josh Holland

Copyright (C) 2019, 2020 Diego Nicola Barbato

Copyright (C) 2019 Ivan Petkov

Copyright (C) 2019 Jakob L. Kreuze

Copyright (C) 2019 Kyle Andrews

Copyright (C) 2019 Alex Griffin

Copyright (C) 2019, 2020, 2021, 2022 Guillaume Le Vaillant

Copyright (C) 2020 Liliana Marie Prikler

Copyright (C) 2019, 2020, 2021, 2022 Simon Tournier

Copyright (C) 2020 Wiktor Żelazny

Copyright (C) 2020 Damien Cassou

Copyright (C) 2020 Jakub Kądziołka

Copyright (C) 2020 Jack Hill

Copyright (C) 2020 Naga Malleswari

Copyright (C) 2020, 2021 Brice Waegeneire

Copyright (C) 2020 R Veera Kumar

Copyright (C) 2020, 2021 Pierre Langlois

Copyright (C) 2020 pinoaffe

Copyright (C) 2020 André Batista

Copyright (C) 2020, 2021 Alexandru-Sergiu Marton

Copyright (C) 2020 raingloom

Copyright (C) 2020 Daniel Brooks

Copyright (C) 2020 John Soo

Copyright (C) 2020 Jonathan Brielmaier

Copyright (C) 2020 Edgar Vincent

Copyright (C) 2021, 2022 Maxime Devos

Copyright (C) 2021 B. Wilson

Copyright (C) 2021 Xinglu Chen

Copyright (C) 2021 Raghav Gururajan

Copyright (C) 2021 Domagoj Stolfa

Copyright (C) 2021 Hui Lu

Copyright (C) 2021 pukkamustard

Copyright (C) 2021 Alice Brenon

Copyright (C) 2021, 2022 Josselin Poiret

Copyright (C) 2021 muradm

Copyright (C) 2021, 2022 Andrew Tropin

Copyright (C) 2021 Sarah Morgensen

Copyright (C) 2022 Remco van 't Veer

Copyright (C) 2022 Aleksandr Vityazev

Copyright (C) 2022 Philip McGrath

Copyright (C) 2022 Karl Hallsby

Copyright (C) 2022 Justin Veilleux

Copyright (C) 2022 Reily Siegel

Copyright (C) 2022 Simon Streit

Copyright (C) 2022 (

Copyright (C) 2022 John Kehayias


Permission is granted to copy, distribute and/or modify this document
under the terms of the GNU Free Documentation License, Version 1.3 or
any later version published by the Free Software Foundation; with no
Invariant Sections, no Front-Cover Texts, and no Back-Cover Texts.  A
copy of the license is included in the section entitled "GNU Free
Documentation License".   -->
<!--   Created by GNU Texinfo 6.7, http://www.gnu.org/software/texinfo/   -->
<head>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<title>Application Setup (GNU Guix Reference Manual)</title>

<meta name="description" content="Application Setup (GNU Guix Reference Manual)" />
<meta name="keywords" content="Application Setup (GNU Guix Reference Manual)" />
<meta name="resource-type" content="document" />
<meta name="distribution" content="global" />
<meta name="Generator" content="makeinfo" />
<link href="index.html" rel="start" title="Top" />
<link href="Concept-Index.html" rel="index" title="Concept Index" />
<link href="index.html#SEC_Contents" rel="contents" title="Table of Contents" />
<link href="Installation.html" rel="up" title="Installation" />
<link href="Upgrading-Guix.html" rel="next" title="Upgrading Guix" />
<link href="Invoking-guix_002ddaemon.html" rel="prev" title="Invoking guix-daemon" />
<style type="text/css">
&amp;lt;!--
a.summary-letter {text-decoration: none}
blockquote.indentedblock {margin-right: 0em}
div.display {margin-left: 3.2em}
div.example {margin-left: 3.2em}
div.lisp {margin-left: 3.2em}
kbd {font-style: oblique}
pre.display {font-family: inherit}
pre.format {font-family: inherit}
pre.menu-comment {font-family: serif}
pre.menu-preformatted {font-family: serif}
span.nolinebreak {white-space: nowrap}
span.roman {font-family: initial; font-weight: normal}
span.sansserif {font-family: sans-serif; font-weight: normal}
ul.no-bullet {list-style: none}
--&amp;gt;
</style>
<link rel="stylesheet" type="text/css" href="https://www.gnu.org/software/gnulib/manual.css" />

<meta name="viewport" content="width=device-width, initial-scale=1" />
<link rel="stylesheet" type="text/css" href="../../../static/base/css/manual.css" /><link rel="stylesheet" type="text/css" href="../../../static/base/css/code.css" /></head>

<body lang="en"><header class="navbar"><h1><a class="branding" href="https://guix.gnu.org/manual/en/"></a></h1><nav class="navbar-menu"><input class="navbar-menu-hidden-input" type="radio" name="dropdown" id="all-dropdowns-hidden" /><ul><li class="navbar-menu-item dropdown dropdown-btn"><input class="navbar-menu-hidden-input" type="radio" name="dropdown" id="visible-dropdown" /><label for="visible-dropdown"><img alt="Language" src="../../../static/base/img/language-picker.svg" /></label><label for="all-dropdowns-hidden"><img alt="Language" src="../../../static/base/img/language-picker.svg" /></label><div class="navbar-submenu" id="navbar-submenu"><div class="navbar-submenu-triangle"> </div><ul><li><a class="navbar-menu-item" href="https://guix.gnu.org/manual/de/html_node">Deutsch</a></li><li><a class="navbar-menu-item" href="https://guix.gnu.org/manual/en/html_node">English</a></li><li><a class="navbar-menu-item" href="https://guix.gnu.org/manual/es/html_node">Español</a></li><li><a class="navbar-menu-item" href="https://guix.gnu.org/manual/fr/html_node">français</a></li><li><a class="navbar-menu-item" href="https://guix.gnu.org/manual/pt-br/html_node">Português</a></li><li><a class="navbar-menu-item" href="https://guix.gnu.org/manual/ru/html_node">русский</a></li><li><a class="navbar-menu-item" href="https://guix.gnu.org/manual/zh-cn/html_node">中文</a></li><li><a class="navbar-menu-item" href="https://translate.fedoraproject.org/projects/guix/documentation-manual/">⊕</a></li></ul></div></li></ul></nav><a class="navbar-menu-btn" href="https://guix.gnu.org/manual/"></a></header>
<span id="Application-Setup"></span><div class="header">
<p>
Next: <a href="Upgrading-Guix.html" accesskey="n" rel="next">Upgrading Guix</a>, Previous: <a href="Invoking-guix_002ddaemon.html" accesskey="p" rel="prev">Invoking guix-daemon</a>, Up: <a href="Installation.html" accesskey="u" rel="up">Installation</a> &nbsp; [<a href="index.html#SEC_Contents" title="Table of contents" rel="contents">Contents</a>][<a href="Concept-Index.html" title="Index" rel="index">Index</a>]</p>
</div>
<hr />
<span id="Application-Setup-1"></span><h3 class="section">2.6 Application Setup</h3>

<span id="index-foreign-distro-1"></span>
<p>When using Guix on top of GNU/Linux distribution other than Guix System&mdash;a
so-called <em>foreign distro</em>&mdash;a few additional steps are needed to
get everything in place.  Here are some of them.
</p>
<span id="Locales-1"></span><h4 class="subsection">2.6.1 Locales</h4>

<span id="locales_002dand_002dlocpath"></span><span id="index-locales_002c-when-not-on-Guix-System"></span>
<span id="index-LOCPATH"></span>
<span id="index-GUIX_005fLOCPATH"></span>
<p>Packages installed <i>via</i> Guix will not use the locale data of the
host system.  Instead, you must first install one of the locale packages
available with Guix and then define the <code>GUIX_LOCPATH</code> environment
variable:
</p>
<div class="example">
<pre class="example">$ guix install glibc-locales
$ export GUIX_LOCPATH=$HOME/.guix-profile/lib/locale
</pre></div>

<p>Note that the <code>glibc-locales</code> package contains data for all the
locales supported by the GNU&nbsp;libc and weighs in at around
930&nbsp;MiB<a id="DOCF9" href="Application-Setup.html#FOOT9"><sup>9</sup></a>.  If you only need a few locales, you can define your custom
locales package via the <code>make-glibc-utf8-locales</code> procedure from
the <code>(gnu packages base)</code> module.  The following example defines a
package containing the various Canadian UTF-8 locales known to the
GNU&nbsp;libc, that weighs around 14&nbsp;MiB:
</p>
<div class="lisp">
<pre class="lisp"><span class="syntax-paren0">(<span class="syntax-symbol"><a class="syntax-symbol" href="https://www.gnu.org/software/guile/manual/html_node/Using-Guile-Modules.html#index-use_002dmodules">use-modules</a> <span class="syntax-paren1">(<span class="syntax-symbol"><span class="syntax-symbol">gnu</span> <span class="syntax-symbol">packages</span> <span class="syntax-symbol">base</span></span>)</span></span>)</span>

<span class="syntax-paren0">(<span class="syntax-symbol"><span class="syntax-special">define</span> <span class="syntax-symbol">my-glibc-locales</span>
  <span class="syntax-paren1">(<span class="syntax-symbol"><span class="syntax-symbol">make-glibc-utf8-locales</span>
   <span class="syntax-symbol">glibc</span>
   <span class="syntax-keyword">#:locales</span> <span class="syntax-paren2">(<span class="syntax-symbol"><a class="syntax-symbol" href="https://www.gnu.org/software/guile/manual/html_node/List-Constructors.html#index-list-1">list</a> <span class="syntax-string">"en_CA"</span> <span class="syntax-string">"fr_CA"</span> <span class="syntax-string">"ik_CA"</span> <span class="syntax-string">"iu_CA"</span> <span class="syntax-string">"shs_CA"</span></span>)</span>
   <span class="syntax-keyword">#:name</span> <span class="syntax-string">"glibc-canadian-utf8-locales"</span></span>)</span></span>)</span>
</pre></div>

<p>The <code>GUIX_LOCPATH</code> variable plays a role similar to <code>LOCPATH</code>
(see <a href="https://www.gnu.org/software/libc/manual/html_node/Locale-Names.html#Locale-Names"><code>LOCPATH</code></a> in <cite>The GNU C Library Reference
Manual</cite>).  There are two important differences though:
</p>
<ol>
<li> <code>GUIX_LOCPATH</code> is honored only by the libc in Guix, and not by the libc
provided by foreign distros.  Thus, using <code>GUIX_LOCPATH</code> allows you
to make sure the programs of the foreign distro will not end up loading
incompatible locale data.

</li><li> libc suffixes each entry of <code>GUIX_LOCPATH</code> with <code>/X.Y</code>, where
<code>X.Y</code> is the libc version&mdash;e.g., <code>2.22</code>.  This means that,
should your Guix profile contain a mixture of programs linked against
different libc version, each libc version will only try to load locale
data in the right format.
</li></ol>

<p>This is important because the locale data format used by different libc
versions may be incompatible.
</p>
<span id="Name-Service-Switch-1"></span><h4 class="subsection">2.6.2 Name Service Switch</h4>

<span id="index-name-service-switch_002c-glibc"></span>
<span id="index-NSS-_0028name-service-switch_0029_002c-glibc"></span>
<span id="index-nscd-_0028name-service-caching-daemon_0029"></span>
<span id="index-name-service-caching-daemon-_0028nscd_0029"></span>
<p>When using Guix on a foreign distro, we <em>strongly recommend</em> that
the system run the GNU C library&rsquo;s <em>name service cache daemon</em>,
<code>nscd</code>, which should be listening on the
<samp>/var/run/nscd/socket</samp> socket.  Failing to do that, applications
installed with Guix may fail to look up host names or user accounts, or
may even crash.  The next paragraphs explain why.
</p>
<span id="index-nsswitch_002econf"></span>
<p>The GNU C library implements a <em>name service switch</em> (NSS), which is
an extensible mechanism for &ldquo;name lookups&rdquo; in general: host name
resolution, user accounts, and more (see <a href="https://www.gnu.org/software/libc/manual/html_node/Name-Service-Switch.html#Name-Service-Switch">Name Service Switch</a> in <cite>The GNU C Library Reference Manual</cite>).
</p>
<span id="index-Network-information-service-_0028NIS_0029"></span>
<span id="index-NIS-_0028Network-information-service_0029"></span>
<p>Being extensible, the NSS supports <em>plugins</em>, which provide new name
lookup implementations: for example, the <code>nss-mdns</code> plugin allow
resolution of <code>.local</code> host names, the <code>nis</code> plugin allows
user account lookup using the Network information service (NIS), and so
on.  These extra &ldquo;lookup services&rdquo; are configured system-wide in
<samp>/etc/nsswitch.conf</samp>, and all the programs running on the system
honor those settings (see <a href="https://www.gnu.org/software/libc/manual/html_node/NSS-Configuration-File.html#NSS-Configuration-File">NSS Configuration File</a> in <cite>The GNU C
Reference Manual</cite>).
</p>
<p>When they perform a name lookup&mdash;for instance by calling the
<code>getaddrinfo</code> function in C&mdash;applications first try to connect to
the nscd; on success, nscd performs name lookups on their behalf.  If
the nscd is not running, then they perform the name lookup by
themselves, by loading the name lookup services into their own address
space and running it.  These name lookup services&mdash;the
<samp>libnss_*.so</samp> files&mdash;are <code>dlopen</code>&rsquo;d, but they may come from
the host system&rsquo;s C library, rather than from the C library the
application is linked against (the C library coming from Guix).
</p>
<p>And this is where the problem is: if your application is linked against
Guix&rsquo;s C library (say, glibc 2.24) and tries to load NSS plugins from
another C library (say, <code>libnss_mdns.so</code> for glibc 2.22), it will
likely crash or have its name lookups fail unexpectedly.
</p>
<p>Running <code>nscd</code> on the system, among other advantages, eliminates
this binary incompatibility problem because those <code>libnss_*.so</code>
files are loaded in the <code>nscd</code> process, not in applications
themselves.
</p>
<span id="X11-Fonts"></span><h4 class="subsection">2.6.3 X11 Fonts</h4>

<span id="index-fonts"></span>
<p>The majority of graphical applications use Fontconfig to locate and load
fonts and perform X11-client-side rendering.  The <code>fontconfig</code>
package in Guix looks for fonts in <samp>$HOME/.guix-profile</samp> by
default.  Thus, to allow graphical applications installed with Guix to
display fonts, you have to install fonts with Guix as well.  Essential
font packages include <code>font-ghostscript</code>, <code>font-dejavu</code>, and
<code>font-gnu-freefont</code>.
</p>
<span id="index-fc_002dcache"></span>
<span id="index-font-cache"></span>
<p>Once you have installed or removed fonts, or when you notice an
application that does not find fonts, you may need to install Fontconfig
and to force an update of its font cache by running:
</p>
<div class="example">
<pre class="example">guix install fontconfig
fc-cache -rv
</pre></div>

<p>To display text written in Chinese languages, Japanese, or Korean in
graphical applications, consider installing
<code>font-adobe-source-han-sans</code> or <code>font-wqy-zenhei</code>.  The former
has multiple outputs, one per language family (see <a href="Packages-with-Multiple-Outputs.html">Packages with Multiple Outputs</a>).  For instance, the following command installs fonts
for Chinese languages:
</p>
<div class="example">
<pre class="example">guix install font-adobe-source-han-sans:cn
</pre></div>

<span id="index-xterm"></span>
<p>Older programs such as <code>xterm</code> do not use Fontconfig and instead
rely on server-side font rendering.  Such programs require to specify a
full name of a font using XLFD (X Logical Font Description), like this:
</p>
<div class="example">
<pre class="example">-*-dejavu sans-medium-r-normal-*-*-100-*-*-*-*-*-1
</pre></div>

<p>To be able to use such full names for the TrueType fonts installed in
your Guix profile, you need to extend the font path of the X server:
</p>
<div class="example">
<pre class="example">xset +fp $(dirname $(readlink -f ~/.guix-profile/share/fonts/truetype/fonts.dir))
</pre></div>

<span id="index-xlsfonts"></span>
<p>After that, you can run <code>xlsfonts</code> (from <code>xlsfonts</code> package)
to make sure your TrueType fonts are listed there.
</p>

<span id="X_002e509-Certificates-1"></span><h4 class="subsection">2.6.4 X.509 Certificates</h4>

<span id="index-nss_002dcerts"></span>
<p>The <code>nss-certs</code> package provides X.509 certificates, which allow
programs to authenticate Web servers accessed over HTTPS.
</p>
<p>When using Guix on a foreign distro, you can install this package and
define the relevant environment variables so that packages know where to
look for certificates.  See <a href="X_002e509-Certificates.html">X.509 Certificates</a>, for detailed
information.
</p>
<span id="Emacs-Packages-1"></span><h4 class="subsection">2.6.5 Emacs Packages</h4>

<span id="index-emacs"></span>
<p>When you install Emacs packages with Guix, the Elisp files are placed
under the <samp>share/emacs/site-lisp/</samp> directory of the profile in
which they are installed.  The Elisp libraries are made available to
Emacs through the <code>EMACSLOADPATH</code> environment variable, which is
set when installing Emacs itself.
</p>
<p>Additionally, autoload definitions are automatically evaluated at the
initialization of Emacs, by the Guix-specific
<code>guix-emacs-autoload-packages</code> procedure.  If, for some reason, you
want to avoid auto-loading the Emacs packages installed with Guix, you
can do so by running Emacs with the <samp>--no-site-file</samp> option
(see <a href="https://www.gnu.org/software/emacs/manual/html_node/emacs/Init-File.html#Init-File">Init File</a> in <cite>The GNU Emacs Manual</cite>).
</p>
<blockquote>
<p><b>Note:</b> Emacs can now compile packages natively.  Under the default
configuration, this means that Emacs packages will now be
just-in-time (JIT) compiled as you use them, and the results
stored in a subdirectory of your <code>user-emacs-directory</code>.
</p>
<p>Furthermore, the build system for Emacs packages transparently
supports native compilation, but note, that
<code>emacs-minimal</code>&mdash;the default Emacs for building
packages&mdash;has been configured without native compilation.
To natively compile your emacs packages ahead of time, use a
transformation like <samp>--with-input=emacs-minimal=emacs</samp>.
</p></blockquote>

<div class="footnote">
<hr />
<h4 class="footnotes-heading">Footnotes</h4>

<h5><a id="FOOT9" href="Application-Setup.html#DOCF9">(9)</a>
<p>The size of the <code>glibc-locales</code> package is
reduced down to about 213&nbsp;MiB with store deduplication and further
down to about 67&nbsp;MiB when using a zstd-compressed Btrfs file
system.</p>
</h5></div>
<hr />
<div class="header">
<p>
Next: <a href="Upgrading-Guix.html" accesskey="n" rel="next">Upgrading Guix</a>, Previous: <a href="Invoking-guix_002ddaemon.html" accesskey="p" rel="prev">Invoking guix-daemon</a>, Up: <a href="Installation.html" accesskey="u" rel="up">Installation</a> &nbsp; [<a href="index.html#SEC_Contents" title="Table of contents" rel="contents">Contents</a>][<a href="Concept-Index.html" title="Index" rel="index">Index</a>]</p>
</div>



</body>
</html>
